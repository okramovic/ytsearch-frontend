{"title":"Reinforcement Learning for Stock Prediction","fromid":"05NqKJ0v7EE","words":[["When",0],["you",0],["use",0],["AI",0],["a",0],["crash",0],["is",0],["just",0],["an",0],["opportunity",0],["Hello",3],["world,",3],["it's",3],["Suraj",3],["and",3],["can",3],["we",3],["predict",3],["the",3],["price",3],["of",3],["Google",3],["stock",3],["based",3],["on",3],["a",3],["data",3],["set",3],["of",3],["price",3],["history?",3],["I'll",10],["answer",10],["that",10],["question",10],["by",10],["building",10],["a",10],["Python",10],["demo",10],["that",10],["uses",10],["an",10],["underutilized",10],["technique",10],["in",10],["financial",10],["market",10],["prediction",10],["Reinforcement",19],["learning,",19],["but",19],["before",19],["we",19],["look",19],["at",19],["this",19],["problem",19],["from",19],["a",19],["reinforcement",19],["learning",19],["perspective",19],["Let's",25],["talk",25],["about",25],["the",25],["more",25],["popular",25],["algorithmic",25],["trading",25],["approach",25],["involving",25],["supervised",25],["learning",25],["so",25],["we",25],["can",25],["compare",25],["the",25],["two",25],["If",33],["we",33],["can",33],["predict",33],["that",33],["the",33],["market",33],["will",33],["go",33],["up",33],["We",36],["can",36],["buy",36],["right",36],["now",36],["And",38],["sell",38],["once",38],["it's",38],["gone",38],["up",38],["or",38],["if",38],["we",38],["can",38],["predict",38],["if",38],["it'll",38],["go",38],["down",38],["we",38],["can",38],["short",38],["then",38],["buy",38],["once",38],["the",38],["market",38],["goes",38],["down",38],["But",45],["the",45],["problem",45],["is",45],["what",45],["price",45],["are",45],["we",45],["actually",45],["predicting?",45],["There's",45],["no",45],["single",45],["price",45],["We",51],["are",51],["buying",51],["at",51],["the",51],["final",51],["price",51],["We",54],["pay",54],["depends",54],["on",54],["the",54],["volume",54],["that's",54],["available",54],["at",54],["different",54],["levels",54],["of",54],["the",54],["order",54],["book",54],["including",58],["the",58],["fees",58],["will",58],["need",58],["to",58],["pay",58],["a",58],["Naive",60],["approach",60],["will",60],["be",60],["to",60],["predict",60],["the",60],["mid",60],["price",60],["which",60],["is",60],["the",60],["midpoint",60],["between",60],["the",60],["best",60],["ask",60],["and",60],["the",60],["best",60],["bid",60],["Most",68],["researchers",68],["do",68],["this",68],["but",68],["it's",68],["just",68],["a",68],["theoretical",68],["price",68],["not",68],["something",68],["we",68],["can",68],["execute",68],["trade",68],["orders",68],["at",68],["which",68],["means",68],["it",68],["could",68],["defer",68],["significantly",76],["from",76],["the",76],["real",76],["price",76],["we're",76],["paying",76],["we",76],["also",76],["have",76],["to",76],["pay",76],["a",76],["transaction",76],["fee",76],["for",76],["whatever",76],["platform",76],["we",76],["use",76],["and",76],["Because",83],["the",83],["market",83],["moves",83],["so",83],["fast,",83],["by",83],["the",83],["time",83],["the",83],["order",83],["is",83],["delivered",83],["over",83],["the",83],["network",83],["that",83],["price",83],["could",83],["have",83],["slipped",83],["away",83],["Supervised",91],["models",91],["don't",91],["take",91],["into",91],["account",91],["Network",93],["latency",93],["x'",93],["fees",93],["or",93],["the",93],["amount",93],["of",93],["liquidity",93],["in",93],["the",93],["best",93],["order",93],["book",93],["levels",93],["The",99],["takeaway",99],["here",99],["is",99],["that",99],["in",99],["order",99],["to",99],["make",99],["money",99],["from",99],["a",99],["simple",99],["price",99],["prediction",99],["strategy?",99],["we've",104],["got",104],["to",104],["predict",104],["large",104],["price",104],["movements",104],["over",104],["longer",104],["periods",104],["of",104],["time",104],["or",104],["Be",110],["smart",110],["about",110],["our",110],["fees",110],["and",110],["order",110],["management.",110],["That's",110],["a",110],["non-trivial",110],["problem",110],["There's",115],["also",115],["no",115],["policy",115],["involved",115],["in",115],["supervised",115],["learning",115],["We",118],["predicted",118],["the",118],["price",118],["would",118],["move",118],["up",118],["and",118],["then",118],["it",118],["did",118],["luckily,",118],["but",118],["what",118],["if",118],["the",118],["price",118],["went",118],["down?",118],["What",123],["would",123],["we",123],["have",123],["done?",123],["Then",123],["sold",123],["puddled",123],["like",123],["a",123],["beast?",123],["What",123],["if",123],["the",123],["price",123],["went",123],["up",123],["then",123],["down?",123],["How",129],["do",129],["choose",129],["the",129],["threshold",129],["of",129],["certainty",129],["to",129],["place",129],["an",129],["order?",129],["We",133],["need",133],["more",133],["than",133],["just",133],["on",133],["price",133],["prediction",133],["model.",133],["We",133],["also",133],["need",133],["a",133],["rule",133],["based",133],["policy",133],["this",139],["policy",139],["will",139],["take",139],["as",139],["input",139],["our",139],["price",139],["prediction",139],["then",139],["output",139],["a",139],["Decision",143],["as",143],["to",143],["what",143],["to",143],["do",143],["with",143],["it",143],["as",143],["in",143],["place",143],["an",143],["order",143],["do",143],["nothing",143],["dance,",143],["etc",143],["How",149],["are",149],["we",149],["supposed",149],["to",149],["come",149],["up",149],["with",149],["a",149],["policy",149],["and",149],["how",149],["do",149],["we",149],["optimize",149],["the",149],["policy",149],["parameters",149],["and",149],["decision",149],["thresholds?",149],["Heuristics",157],["and",157],["human",157],["intuition",157],["can",157],["only",157],["get",157],["us",157],["so",157],["far",157],["a",157],["solution",157],["to",157],["our",157],["problem",157],["is",157],["to",157],["use",157],["reinforcement",157],["learning",157],["We",164],["can",164],["formulate",164],["the",164],["reinforcement",164],["learning",164],["problem",164],["in",164],["the",164],["following",164],["way",164],["we",169],["have",169],["an",169],["AI",169],["or",169],["agent",169],["that",169],["takes",169],["actions",169],["inside",169],["of",169],["an",169],["environment",173],["at",173],["each",173],["time",173],["step",173],["The",176],["agent",176],["will",176],["receive",176],["the",176],["input",176],["of",176],["the",176],["current",176],["state",176],["and",176],["take",176],["an",176],["action",176],["then",176],["receive",176],["a",176],["reward",176],["as",176],["well",176],["as",176],["the",176],["next",176],["state",176],["The",183],["agent",183],["will",183],["choose",183],["which",183],["action",183],["to",183],["take",183],["based",183],["on",183],["some",183],["policy",183],["Our",187],["goal",187],["is",187],["to",187],["find",187],["a",187],["policy",187],["that",187],["maximizes",187],["the",187],["cumulative",187],["reward",187],["over",187],["some",187],["time",187],["horizon",193],["in",193],["the",193],["context",193],["of",193],["our",193],["problem",193],["The",195],["agent",195],["is",195],["the",195],["traitor",195],["it",195],["will",195],["decide",195],["how",195],["and",195],["when",195],["to",195],["make",195],["trades",195],["on",195],["the",195],["market",195],["the",201],["environment",201],["would",201],["be",201],["the",201],["exchange",201],["that",201],["we",201],["use",201],["and",201],["that",201],["includes",201],["the",201],["other",201],["agents",201],["both",201],["human-like",201],["like",201],["Jordan",201],["Belfort",201],["and",201],["Algorithms",209],["so",209],["making",209],["trades",209],["that",209],["are",209],["a",209],["part",209],["of",209],["that",209],["exchange",209],["in",209],["terms",209],["of",209],["the",209],["state",209],["of",209],["the",209],["environment",209],["We",214],["can't",214],["observe",214],["the",214],["complete",214],["state",214],["since",214],["we",214],["don't",214],["know",214],["the",214],["details",214],["of",214],["the",214],["other",214],["agents",214],["in",214],["the",214],["environment",214],["like",214],["their",214],["account",214],["Balances",221],["or",221],["what",221],["orders",221],["they're",221],["waiting",221],["on",221],["we",221],["what",221],["we",221],["observe",221],["is",221],["not",221],["the",221],["actual",221],["state",221],["of",221],["the",221],["environment",221],["but",227],["instead",227],["a",227],["derivation",227],["of",227],["it",227],["for",227],["us",227],["that",227],["observation",227],["at",227],["each",227],["time",227],["step",227],["is",227],["a",227],["Historical",233],["log",233],["of",233],["all",233],["exchange",233],["events",233],["received",233],["up",233],["until",233],["that",233],["time",233],["in",233],["order",233],["for",233],["our",233],["agent",233],["to",233],["make",233],["decisions",233],["We'll",239],["include",239],["a",239],["few",239],["other",239],["features",239],["like",239],["the",239],["current",239],["account",239],["balance",239],["The",243],["time",243],["scale",243],["with",243],["which",243],["we",243],["make",243],["trades",243],["will",243],["matter",243],["should",243],["we",243],["do",243],["this",243],["over",243],["a",243],["period",243],["of",243],["days?",243],["How",249],["about",249],["nanoseconds",249],["high-frequency",249],["trading",249],["BOTS",249],["make",249],["decisions",249],["at",249],["nanosecond",249],["Timescales",255],["neural",255],["networks",255],["are",255],["popular",255],["because",255],["they",255],["can",255],["learn",255],["complex",255],["functions",255],["if",255],["given",255],["lots",255],["of",255],["data",255],["and",255],["compute",255],["But",263],["they're",263],["all",263],["relatively",263],["slow",263],["They",265],["can't",265],["make",265],["predictions",265],["on",265],["nanosecond",265],["timescales",265],["so",265],["they",265],["can't",265],["compete",265],["with",265],["hft",265],["algorithms",265],["So",272],["we",272],["want",272],["to",272],["act",272],["on",272],["a",272],["time",272],["scale",272],["where",272],["we",272],["can",272],["analyze",272],["data",272],["faster",272],["than",272],["any",272],["human",272],["Possibly",277],["could",277],["but",277],["we're",277],["being",277],["smarter",277],["allows",277],["us",277],["to",277],["beat",277],["the",277],["fast",277],["but",277],["simple",277],["Hft",283],["algorithms",283],["it's",283],["a",283],["trade-off",283],["Reinforcement",286],["learning",286],["trading",286],["strategies",286],["in",286],["general",286],["are",286],["simpler",286],["than",286],["the",286],["supervised",286],["approach",286],["instead",292],["of",292],["hand",292],["coding",292],["a",292],["rule-based",292],["policy",292],["or",292],["L",292],["will",292],["learn",292],["a",292],["policy",292],["no",292],["need",292],["for",292],["us",292],["to",292],["Specify",297],["rules",297],["and",297],["thresholds",297],["like",297],["SEL",297],["when",297],["you",297],["are",297],["80%",297],["sure",297],["the",297],["market",297],["will",297],["move",297],["down",297],["then",297],["initiate",297],["Skynet",297],["It's",305],["all",305],["a",305],["part",305],["of",305],["the",305],["policy",305],["It",307],["learns",307],["to",307],["optimize",307],["for",307],["the",307],["metric",307],["we",307],["care",307],["about",307],["and",307],["this",307],["policy",307],["can",307],["be",307],["Parameterised",312],["by",312],["a",312],["deep",312],["neural",312],["network",312],["making",312],["it",312],["more",312],["powerful",312],["than",312],["any",312],["rules",312],["a",312],["human",312],["trader",312],["could",312],["come",312],["up",312],["with",312],["Because",318],["our",318],["L",318],["agents",318],["are",318],["trained",318],["in",318],["a",318],["simulation",318],["we",318],["can",318],["take",318],["into",318],["account",318],["Environmental",324],["factors",324],["by",324],["simulating",324],["them",324],["as",324],["well",324],["We",327],["can",327],["simulate",327],["latency",327],["and",327],["give",327],["the",327],["agent",327],["a",327],["negative",327],["reward",327],["if",327],["it",327],["causes",327],["it",327],["to",327],["make",327],["a",327],["mistake",327],["So",333],["let's",333],["get",333],["to",333],["the",333],["problem",333],["at",333],["hand",333],["We",336],["want",336],["to",336],["develop",336],["an",336],["AI",336],["That",337],["will",337],["predict",337],["the",337],["price",337],["of",337],["Google",337],["stock",337],["so",337],["it",337],["can",337],["buy",337],["at",337],["a",337],["low",337],["price",337],["and",337],["sell",337],["at",337],["a",337],["high",337],["price",337],["But",343],["this",343],["type",343],["of",343],["prediction",343],["isn't",343],["easy",343],["It",346],["depends",346],["on",346],["several",346],["parameters",346],["like",346],["the",346],["available",346],["stocks",346],["recent",346],["prices",346],["and",346],["the",346],["available",346],["budget",346],["The",352],["states",352],["in",352],["our",352],["situation",352],["would",352],["be",352],["a",352],["vector",352],["that",352],["has",352],["information",352],["about",352],["those",352],["features",352],["Let's",358],["say",358],["we",358],["want",358],["the",358],["200",358],["last",358],["stock",360],["prices",360],["our",360],["state",360],["would",360],["then",360],["be",360],["a",360],["two",360],["hundred",360],["and",360],["two",360],["dimensional",360],["vector",360],["and",360],["in",360],["terms",360],["of",360],["actions",360],["our",360],["agent",360],["can",360],["either",360],["buy",360],["sell",368],["or",368],["hold",368],["We've",369],["got",369],["our",369],["state's",369],["and",369],["action",369],["but",369],["we",369],["also",369],["need",369],["a",369],["policy",369],["a",369],["policy",369],["for",369],["our",369],["AI",369],["could",369],["consist",369],["of",369],["three",369],["rules",369],["buying",376],["a",376],["stock",376],["at",376],["the",376],["current",376],["price",376],["decreases",376],["the",376],["budget",376],["selling",376],["the",376],["stock",376],["trades",376],["it",376],["in",376],["for",376],["money",376],["at",376],["the",376],["current",376],["price",376],["and",376],["Holding",383],["does",383],["neither",383],["of",383],["these",383],["things",383],["it",383],["yields",383],["no",383],["reward",383],["The",387],["goal",387],["for",387],["our",387],["AI",387],["is",387],["to",387],["learn",387],["a",387],["policy",387],["that",387],["gains",387],["the",387],["maximum",387],["net",387],["worth",387],["from",387],["trading",387],["in",387],["the",387],["stock",387],["market",387],["Let's",394],["try",394],["a",394],["technique",394],["called",394],["learning",396],["so",396],["Rai",396],["will",396],["need",396],["to",396],["select",396],["an",396],["action",396],["and",396],["Improve",400],["its",400],["utility",400],["function",400],["q-learning",400],["is",400],["a",400],["table",400],["of",400],["values",400],["for",400],["every",400],["state",400],["the",400],["rows",400],["and",400],["action",400],["the",400],["columns",400],["possible",407],["in",407],["the",407],["environment",407],["inside",407],["of",407],["each",407],["cell",407],["of",407],["the",407],["table",407],["We",411],["learn",411],["a",411],["value",411],["for",411],["how",411],["beneficial",411],["it",411],["is",411],["to",411],["take",411],["a",411],["given",411],["action",411],["within",411],["a",411],["given",411],["State",411],["These",417],["are",417],["Q",417],["or",417],["Quagmire",417],["values",417],["just",417],["kidding",417],["Q",417],["stands",417],["for",417],["quality",417],["We'll",422],["start",422],["by",422],["initializing",422],["the",422],["table",422],["to",422],["be",422],["all",422],["zeros",422],["then",422],["as",422],["we",422],["observe",422],["the",422],["rewards",422],["we",422],["obtain",422],["for",422],["various",422],["actions",422],["We",428],["can",428],["update",428],["it",428],["accordingly",428],["the",428],["way",428],["we",428],["make",428],["updates",428],["to",428],["the",428],["q",428],["table",428],["is",428],["by",428],["using",428],["the",428],["bellman",428],["equation",428],["the",435],["states",435],["that",435],["the",435],["expected",435],["long-term",437],["reward",437],["for",437],["a",437],["given",437],["action",437],["is",437],["equal",437],["to",437],["the",437],["immediate",437],["reward",437],["from",437],["the",437],["current",437],["action",437],["combined",437],["with",437],["the",437],["Expected",444],["reward",444],["from",444],["the",444],["best",444],["future",444],["action",444],["taken",444],["at",444],["the",444],["following",444],["state",444],["So",448],["we're",448],["reusing",448],["our",448],["own",448],["Q",448],["table",448],["when",448],["estimating",448],["how",448],["to",448],["update",448],["our",448],["table",448],["for",448],["future",448],["actions",448],["more",455],["formally",455],["the",455],["equation",455],["states",455],["that",455],["the",455],["q",455],["value",455],["for",455],["a",455],["given",455],["state",455],["and",455],["Action",460],["should",460],["represent",460],["the",460],["current",460],["reward",460],["plus",460],["the",460],["maximum",460],["discounted",464],["future",464],["reward",464],["expected",466],["according",466],["to",466],["our",466],["own",466],["table",466],["for",468],["the",468],["next",468],["state",468],["we",468],["could",468],["end",468],["up",468],["in",468],["so",468],["given",468],["a",468],["state",468],["the",468],["decision",468],["policy",468],["will",468],["calculate",468],["the",468],["next",468],["action",468],["to",468],["take",468],["and",468],["Improve",475],["the",475],["q",475],["function",475],["from",475],["the",475],["new",475],["experience",475],["of",475],["taking",475],["an",475],["action",475],["Let's",480],["start",480],["implementing",480],["the",480],["decision",480],["Policy",482],["based",482],["on",482],["which",482],["action",482],["the",482],["AI",482],["will",482],["take",482],["for",482],["buying",482],["selling",482],["or",482],["holding",482],["a",482],["stock",482],["To",487],["start",487],["with",487],["we'll",487],["create",487],["a",487],["random",487],["decision",487],["policy",487],["and",487],["evaluate",487],["its",487],["performance",487],["We",492],["can",492],["do",492],["this",492],["in",492],["the",492],["general",492],["decision",492],["policy",492],["abstract",492],["class",492],["We",497],["can",497],["then",497],["inherit",497],["from",497],["the",497],["superclass",497],["to",497],["implement",497],["a",497],["random",497],["decision",497],["policy",497],["All",502],["it",502],["does",502],["is",502],["pick",502],["an",502],["action",502],["randomly",502],["without",502],["even",502],["looking",502],["at",502],["the",502],["state",502],["We",506],["can",506],["definitely",506],["do",506],["better",506],["than",506],["this",506],["neural",506],["network",506],["based",506],["Q",506],["learning",506],["Has",510],["proven",510],["to",510],["be",510],["a",510],["good",510],["strategy",510],["for",510],["learning",510],["a",510],["decision",510],["policy",510],["We",515],["can",515],["set",515],["the",515],["hyper",515],["parameters",515],["from",515],["the",515],["Q",515],["function",515],["in",515],["the",515],["constructor",515],["as",515],["well",515],["as",515],["the",515],["number",515],["of",515],["hidden",515],["nodes",515],["in",515],["the",515],["neural",515],["networks",515],["This",522],["helps",522],["define",522],["the",522],["input",522],["and",522],["output",522],["tensors",522],["and",522],["the",522],["structure",522],["of",522],["the",522],["network",522],["It",528],["will",528],["also",528],["define",528],["the",528],["opera",528],["to",528],["compute",528],["the",528],["utility",528],["Of",531],["course,",531],["our",531],["optimizer",531],["will",531],["be",531],["great",531],["in",531],["descent",531],["Which",534],["is",534],["the",534],["most",534],["popular",534],["in",534],["the",534],["space?",534],["the",537],["results",537],["don't",537],["look",537],["too",537],["bad",537],["and",537],["there's",537],["a",537],["lot",537],["of",537],["potential",537],["to",537],["improve",537],["this",537],["model",537],["using",537],["reinforcement",537],["learning",537],["techniques",537],["like",537],["sarsa,",544],["or",544],["policy",544],["gradients",544],["Applying",547],["RL",547],["to",547],["financial",547],["predictions",547],["is",547],["an",547],["exciting",547],["and",547],["largely",547],["Untapped",551],["area",551],["of",551],["research",551],["and",551],["I've",551],["got",551],["a",551],["link",551],["to",551],["all",551],["the",551],["code",551],["for",551],["you",551],["in",551],["the",551],["video",551],["description",551],["So",556],["check",556],["it",556],["out",556],["you",556],["made",556],["it",556],["to",556],["the",556],["end,",556],["but",556],["it's",556],["really",556],["just",556],["the",556],["beginning",556],["It's",560],["subscribe",560],["and",560],["let",560],["me",560],["help",560],["you",560],["on",560],["your",560],["journey",560],["to",560],["be",560],["the",560],["best",560],["for",560],["now.",560],["I've",560],["got",560],["to",560],["learn",560],["a",560],["q",560],["function",560],["So",566],["thanks",566],["for",566],["watching",566]]}