{"title":"Build an AI Writer - Machine Learning for Hackers #8","fromid":"x24VEUEph0Q","words":[["My",0],["Dear",0],["Megan",0],["Tang,",0],["this",0],["is",0],["our",0],["love",0],["story.",0],["human",2],["or",2],["machine?",2],["Human.",2],["Why.I",2],["found",2],["some",2],["drops",2],["of",2],["soylent",2],["on",2],["it",2],["Hello",10],["World,",10],["welcome",10],["to",10],["Sirajology!",10],["In",10],["today’s\nepisode",10],["we’re",10],["going",10],["to",10],["build",10],["an",10],["AI",10],["Writer.",10],["That",14],["is",14],["an",14],["app",14],["that",14],["can",14],["write",14],["a",14],["short",14],["story\nabout",14],["an",14],["image",14],["just",14],["by",14],["looking",14],["at",14],["it.",14],["I",14],["swear",14],["i’m",18],["being",18],["serious,",18],["this",18],["is",18],["actually",18],["possible.\nSorry",18],["Stephen",18],["King,",18],["you’re",18],["out",18],["of",18],["the",18],["game.",18],["Humans",20],["have",20],["been",20],["writing",20],["stories",20],["since",20],["day\n1.",20],["When",20],["we",20],["tell",20],["stories",20],["we",20],["synthesize",20],["our",20],["past",20],["experiences",20],["in",20],["life",20],["with",20],["our",20],["command\nof",20],["language",20],["to",20],["produce",20],["a",20],["narrative",20],["that",20],["we",20],["can",20],["share",20],["with",20],["others",20],["to",20],["give",20],["them",20],["similar\nneural",20],["thought",20],["patterns.",20],["Isn’t",20],["it",20],["weird",20],["how",20],["just",20],["by",20],["stringing",20],["together",20],["an",20],["exact",20],["combination\nof",20],["words",20],["to",20],["form",20],["sentences",20],["we",20],["can",20],["produce",20],["something",24],["of",24],["profound",24],["beauty?",24],["We",24],["have",24],["a",24],["bunch\nof",24],["thoughts",24],["in",24],["our",24],["head,",24],["abstractions",24],["we’ve",24],["built",25],["from",25],["just",25],["living",25],["life,",25],["representations\nof",25],["our",25],["experiences.",25],["When",25],["we",25],["read",25],["these",25],["stories,",25],["our",26],["brains",26],["are",26],["somehow",26],["encoding",26],["them",26],["into\nthoughts.",26],["When",26],["we",26],["‘encode’",26],["a",26],["sentence",26],["to",30],["a",30],["thought,",30],["the",30],["more",30],["semantically",30],["similar\nit",30],["is",30],["to",30],["an",30],["existing",30],["thought,",30],["the",30],["more",30],["we’ll",30],["be",33],["able",33],["to",33],["relate",33],["to",33],["it.",33],["Our",33],["brains",33],["can",33],["detect\nsymantic",33],["similarity",33],["to",33],["existing",33],["thoughts,",33],["the",35],["essence",35],["of",35],["a",35],["piece",35],["of",35],["prose",35],["is",35],["already\nin",35],["us,",35],["its",35],["similarity",35],["can",35],["unlock",35],["that",35],["essence",35],["and",35],["potentially",35],["produce",35],["a",35],["flood",35],["of",35],["emotion\nin",35],["any",35],["direction.",35],["This",35],["is",35],["likely",35],["why",35],["relatability",35],["is",35],["such",35],["a",35],["valued",35],["concept",35],["in",35],["marketing.",35],["So",35],["how",35],["do",35],["we",35],["get",35],["an",35],["AI",35],["to",35],["write",35],["a",35],["story",35],["if\nit",35],["doesn’t",35],["have",35],["any",35],["experience",35],["living",35],["life",35],["in",39],["the",39],["real",39],["world?",39],["We’ll",39],["We’re",39],["going",39],["to\nbuild",39],["an",39],["AI",39],["Writer",39],["in",39],["python",39],["using",39],["the",39],["deep",39],["learning",43],["library",43],["lasagne",43],["and",43],["we’ve",43],["got",43],["a\nlot",43],["of",43],["code",43],["to",43],["go",43],["over",43],["so",43],["I’ll",43],["explain",43],["as",43],["we",46],["go.",46],["Let’s",46],["get",46],["pythonicCCCCC.",46],["At",46],["the",46],["highest\nlevel",46],["we",46],["could",46],["code",46],["this",46],["app",46],["in",46],["just",46],["3",46],["lines",46],["of",51],["code,",51],["it’s",51],["a",51],["little",51],["ridiculous.",51],["We",51],["import\nthe",51],["generate",51],["class,",51],["then",51],["call",51],["the",51],["load_all",51],["function",55],["which",55],["will",55],["initialize",55],["all",55],["of",55],["our\nmachine",55],["learning",55],["models.",55],["then",55],["call",55],["the",55],["story",55],["function",59],["with",59],["the",59],["generated",59],["models",59],["and",59],["image\nlocation",59],["as",59],["the",59],["parameter.",59],["That’s",59],["it,",59],["it’ll",59],["output",63],["a",63],["story.",63],["But",63],["let’s",63],["dive",63],["a",63],["little\ndeeper.",63],["The",63],["load_all",63],["function",63],["is",63],["just",63],["boilerplate",63],["initialization",66],["so",66],["let’s",66],["take",66],["a",66],["closer",66],["look\nat",66],["the",66],["story",66],["function,",66],["where",66],["the",66],["real",66],["magic",66],["happens",70],["and",70],["see",70],["how",70],["that",70],["works.We’ll",70],["start\noff",70],["by",70],["loading",70],["an",70],["image",70],["into",70],["memory.",70],["This",70],["will",73],["be",73],["the",73],["image",73],["that",73],["we",73],["want",73],["to",73],["tell",73],["a",73],["story\nabout.",73],["We’ll",73],["use",73],["the",73],["load",73],["image",73],["function",73],["to",76],["load",76],["it,",76],["and",76],["have",76],["the",76],["parameter",76],["set",76],["to\nthe",76],["location",76],["of",76],["the",76],["image",76],["on",76],["our",76],["machine.",76],["The",80],["load",80],["image",80],["function",80],["uses",80],["the",80],["scientifiic\ncomputing",80],["library",80],["numpy",80],["to",80],["get",80],["the",80],["byte",80],["reprersenation",80],["of",85],["the",85],["image",85],["and",85],["then",85],["resize",85],["it",85],["so",85],["it’s\nsmaller",85],["while",85],["preserving",85],["it’s",85],["aspect",85],["ratio.",85],["Then",88],["it’ll",88],["crop",88],["it",88],["and",88],["format",88],["it",88],["for",88],["later\ninput.",88],["Once",89],["we’ve",89],["loaded",89],["our",89],["image,",89],["it’s",89],["time\nto",89],["input",89],["the",89],["image",89],["into",89],["a",89],["deep",89],["convolutional",89],["neural",93],["network",93],["to",93],["retrieve",93],["it’s",93],["features.\nIn",93],["a",93],["previous",93],["episode",93],["we",93],["talked",93],["about",93],["how",93],["convolutional",97],["neural",97],["nets",97],["were",97],["great",97],["for",97],["image\nrecognition,",97],["since",97],["they",97],["roughly",97],["mimic",97],["the",97],["human",101],["visual",101],["cortex.",101],["This",101],["CNN",101],["is",101],["pre-trained.\nWe",101],["initialize",101],["it",101],["in",101],["the",101],["build_convnet",101],["function",101],["which",106],["is",106],["called",106],["in",106],["the",106],["boilerplate",106],["load_all\nmethod.",106],["Once",106],["we’ve",106],["specified",106],["all",106],["the",106],["layers,",106],["we",110],["load",110],["up",110],["our",110],["pre-trained",110],["synapse",110],["weight\nfile",110],["called",110],["Vgg",110],["19.",110],["This",110],["file",110],["was",110],["trained",110],["on",114],["a",114],["huge",114],["dataset",114],["of",114],["labeled",114],["images,",114],["so",114],["it\nwill",114],["be",114],["able",114],["to",114],["recognize",114],["the",114],["objects",114],["in",114],["a",114],["novel",118],["image.",118],["Once",118],["we",118],["input",118],["our",118],["image",118],["in",118],["our\nCNN,",118],["it’ll",118],["return",118],["an",118],["array",118],["of",118],["features",118],["for",118],["us.",122],["These",122],["features",122],["are",122],["the",122],["highest",122],["level",122],["features\nin",122],["our",122],["neural",122],["net,",122],["the",122],["layer",122],["right",122],["before",122],["the",125],["output",125],["layer.",125],["The",125],["most",125],["abstract",125],["representation\nof",125],["the",125],["image,",125],["it’s",125],["content.",125],["Once",129],["we",129],["have",129],["our",129],["features",129],["we’ll",129],["want",129],["to\nencode",129],["the",129],["image",129],["features",129],["into",129],["a",129],["mulit-modal",129],["neural",133],["language",133],["model.",133],["So",133],["what",133],["is",133],["this?",133],["Well\nit’s",133],["based",133],["off",133],["the",133],["paper",133],["called",133],["‘unifying",133],["visual",137],["semantic",137],["embeddings’.",137],["In",137],["our",137],["code\nwe’re",137],["using",137],["a",137],["pre-trained",137],["model",137],["that’ll",137],["input",141],["a",141],["joint",141],["image",141],["sentence",141],["embedding",141],["into\na",141],["multimodal",141],["vector",141],["space.",141],["It",141],["used",141],["an",141],["LSTM",141],["to",145],["encode",145],["the",145],["sentence",145],["and",145],["a",145],["CNN",145],["to",145],["encode\nthe",145],["image.",145],["Then",145],["a",145],["decoder",145],["neural",145],["language",145],["model",149],["generates",149],["a",149],["novel",149],["description",149],["from",149],["the\nimage.",149],["Since",149],["our",149],["model",149],["is",149],["pre-trained,",149],["when",149],["we",153],["embed",153],["our",153],["image",153],["into",153],["this",153],["multimodal",153],["space,\nour",153],["features",153],["are",153],["updated",153],["to",153],["include",153],["the",153],["weight",153],["of",157],["the",157],["joint",157],["space.",157],["then",157],["we",157],["compute",157],["the",157],["nearest\nneighbors,",157],["to",157],["do",157],["this",157],["first",157],["we",157],["retrieve",157],["the",157],["array",161],["of",161],["scores,",161],["that",161],["is",161],["a",161],["list",161],["of",161],["all",161],["novel\nsentences",161],["generated",161],["from",161],["the",161],["novel",161],["image,",161],["which",166],["we",166],["then",166],["sort",166],["in",166],["order",166],["of",166],["closeness.\nSuper",166],["close….",166],["Then",168],["we’ll",168],["want",168],["to",168],["print",168],["out",168],["the",168],["nearest\ncaptions.",168],["Now",168],["that",168],["we",168],["have",168],["a",168],["set",168],["of",168],["caption",168],["sentences",171],["we’ll",171],["want",171],["to",171],["compute",171],["a",171],["set",171],["of\nskip-thought",171],["vectors",171],["for",171],["each",171],["sentence.",171],["Skip",171],["thought",175],["vectors",175],["are",175],["a",175],["vector",175],["representation\nof",175],["a",175],["sentence.",175],["This",175],["is",175],["another",175],["implementation",175],["of",180],["the",180],["encoder-decoder",180],["model,",180],["the",180],["encoder\nand",180],["decoder",180],["are",180],["both",180],["recurrent",180],["neural",180],["networks.",180],["We",185],["take",185],["an",185],["input",185],["sentence",185],["and",185],["‘encode’\nit",185],["into",185],["a",185],["skip",185],["thought",185],["vector",185],["by",185],["inputting",185],["it",189],["into",189],["the",189],["encoding",189],["recurrent",189],["neural",189],["net.\nSince",189],["we",189],["are",189],["modeling",189],["a",189],["sequence",189],["of",189],["words,",189],["we’ll",193],["use",193],["Gated",193],["Recurrent",193],["Units",193],["or",193],["GRUs\nat",193],["each",193],["neuron.",193],["GRUs",193],["consist",193],["of",193],["2",193],["‘gates’",193],["an",198],["update",198],["gate",198],["and",198],["a",198],["reset",198],["gate.",198],["The",198],["gating\nunits",198],["modulate",198],["the",198],["flow",198],["of",198],["data",198],["inside",198],["the",198],["unit,",202],["and",202],["unlike",202],["LSTM",202],["cells",202],["there",202],["are",202],["no",202],["seperate\nmemory",202],["cells.",202],["LSTM",202],["cells",202],["control",202],["the",202],["amount",202],["of",206],["memory",206],["content",206],["that",206],["is",206],["seen",206],["or",206],["used",206],["by\nother",206],["units",206],["in",206],["the",206],["network.",206],["GRUs",206],["cells",206],["don’t,",206],["they",210],["expose",210],["its",210],["full",210],["content",210],["without",210],["any",210],["control.\nSo",210],["GRUs",210],["have",210],["a",210],["less",210],["complex",210],["structure",210],["and",210],["are",215],["thus",215],["more",215],["computationally",215],["efficient.",215],["We’re\nstarting",215],["to",215],["see",215],["these",215],["be",215],["used",215],["more",215],["and",215],["more,",215],["they’re",218],["relatively",218],["new.",218],["So",218],["when",218],["we",218],["feed\nthe",218],["sentences",218],["into",218],["the",218],["RNN",218],["and",218],["it’ll",218],["create",218],["an",222],["abstraction,",222],["the",222],["vector",222],["representation\nor",222],["skip",222],["though",222],["vector.",222],["Sentences",222],["that",222],["share",222],["semantic",226],["and",226],["syntactic",226],["properties",226],["will",226],["be\nmapped",226],["to",226],["either",226],["the",226],["same",226],["or",226],["similar",226],["skip-thought",226],["vectors.",230],["The",230],["function",230],["returns",230],["these",230],["vectors",230],["as",230],["a",230],["numpy\narray,",230],["which",230],["we",230],["can",230],["then",230],["modify",230],["via",230],["the",230],["style",230],["shift",234],["function.",234],["we’ll",234],["take",234],["our",234],["thought",234],["vectors\nand",234],["modify",234],["them",234],["to",234],["match",234],["the",234],["style",234],["of",234],["stories",234],["using",238],["a",238],["pre-trained",238],["recurrent",238],["neural",238],["network.\nThe",238],["RNN",238],["was",238],["trained",238],["on",238],["a",238],["dataset",238],["of",238],["romance",238],["novels,",242],["where",242],["each",242],["passage",242],["was",242],["mapped",242],["to",242],["a\nthought",242],["vector.",242],["So",242],["we’re",242],["essentially",242],["computing",242],["a",246],["function",246],["that",246],["looks",246],["like",246],["this",246],["for",246],["a",246],["style\nshift.",246],["F(x)",246],["is",246],["a",246],["book",246],["passage",246],["thought",246],["vector,",246],["x",250],["is",250],["an",250],["image",250],["caption,",250],["c",250],["is",250],["caption",250],["style\nvector",250],["and",250],["b",250],["is",250],["a",250],["book",250],["style",250],["vector.",250],["We",250],["remove",250],["the",255],["caption",255],["style",255],["from",255],["the",255],["caption",255],["and",255],["replace\nit",255],["with",255],["a",255],["book",255],["style",255],["to",255],["create",255],["a",255],["book",255],["passage",255],["vector.",258],["Once",258],["we",258],["have",258],["our",258],["book",258],["passage",258],["styled\nvector,",258],["we",258],["can",258],["generate",258],["the",258],["story",258],["by",258],["running",258],["the",263],["decoder",263],["function",263],["on",263],["it.",263],["The",263],["decoder",263],["is\nanother",263],["recurrent",263],["neural",263],["network",263],["that,",263],["given",263],["a",266],["vector",266],["representation",266],["of",266],["a",266],["sentence,",266],["can\npredict",266],["the",266],["previous",266],["sentence",266],["and",266],["the",266],["next",266],["sentence.",270],["We’ll",270],["run",270],["the",270],["decoder",270],["on",270],["our",270],["passage\nvector",270],["and",270],["that",270],["will",270],["generate",270],["our",270],["story",270],["based",270],["on",274],["the",274],["image",274],["for",274],["us.",274],["Let’s",274],["take",274],["a",274],["look",274],["at\nwhat",274],["it",274],["says",274],["about",274],["this",274],["picture.",274],["Let’s",274],["read",274],["the",277],["first",277],["few",277],["sentences-",277],["She",277],["was",277],["taking",277],["the\nman",277],["out",277],["of",277],["her",277],["mouth",277],["and",277],["she",277],["gave",277],["him",277],["a",277],["gentle",277],["shake",281],["of",281],["her",281],["head.",281],["oh",281],["my",281],["god,",281],["i",281],["cant",281],["wait\nto",281],["see",281],["what",281],["happened",281],["in",281],["the",281],["past",281],["twenty",281],["for",281],["hours,",285],["i",285],["had",285],["never",285],["met",285],["a",285],["woman",285],["before.",285],["This\nthing",285],["is",285],["a",285],["pro.",285],["For",288],["a",288],["small",288],["chunk",288],["of",288],["code,",288],["there’s",288],["a",288],["lot\nof",288],["machine",288],["learning",288],["going",288],["on",288],["here.",288],["We",288],["used",288],["a",291],["convolutional",291],["neural",291],["net",291],["to",291],["compute",291],["image\nfeatures,",291],["an",291],["LSTM",291],["reccurent",291],["neural",291],["net",291],["to",291],["encode",295],["our",295],["image",295],["into",295],["joint",295],["space",295],["and",295],["retrieve\nthe",295],["sentence",295],["captions,",295],["a",295],["GRU",295],["recurrent",295],["neural",295],["net",299],["to",299],["calculate",299],["the",299],["skip-thought",299],["vectors\nof",299],["those",299],["sentences,",299],["and",299],["after",299],["stye",299],["shifting,",299],["an",303],["RNN",303],["to",303],["decode",303],["our",303],["pasage",303],["vector",303],["to",303],["a",303],["story.\nThat’s",303],["4",303],["neural",303],["nets.",303],["That’s",303],["what",303],["it",303],["takes",303],["to",307],["be",307],["cool",307],["these",307],["days",307],[":)",307],["You",307],["can",307],["run",307],["this\non",307],["your",307],["local",307],["machine",307],["since",307],["the",307],["necessary",307],["models",309],["are",309],["pretrained,",309],["you",309],["can",309],["also",309],["test",309],["this\nout",309],["at",309],["somatic.io.",309],["That",309],["site",309],["has",309],["a",309],["bunch",309],["of",309],["pre-trained",310],["deep",310],["learning",310],["models",310],["that",310],["you\ncan",310],["test",310],["out,",310],["it’s",310],["super",310],["useful.",310],["For",310],["more",310],["info,",311],["check",311],["out",311],["the",311],["links",311],["below",311],["and",311],["I",311],["just\nsigned",311],["up",311],["for",311],["Patreon",311],["so",311],["if",311],["you",311],["guys",311],["find",311],["my",315],["videos",315],["useful",315],["i’d",315],["really",315],["appreciate",315],["your\nsupport",315],["to",315],["help",315],["me",315],["continue",315],["doing",315],["this",315],["full-time.",315],["Please",319],["subscribe",319],["for",319],["ML",319],["videos",319],["and",319],["for",319],["now\nI’ve",319],["gotta",319],["go",319],["fix",319],["a",319],["null",319],["pointer",319],["exception",319],["so",323],["thanks",323],["for",323],["watching",323],[":)",323]]}