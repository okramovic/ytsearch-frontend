{"title":"How to Generate Music - Intro to Deep Learning #9","fromid":"4DMm5Lhey1U","words":[["In",0],["the",0],["sixth",0],["century\nBC,",0],["Pythagoras--",0],["yes,",0],["that",3],["Pythagoras--",3],["proposed\na",3],["concept",3],["called",3],["the",3],["music",3],["of",6],["the",6],["spheres",6],["to",6],["describe\nthe",6],["proportional",6],["movements",6],["of",9],["celestial",9],["bodies",9],["like\nthe",9],["sun,",9],["moon,",9],["and",9],["planets.",9],["This",13],["music",13],["is",13],["not\nthought",13],["of",13],["as",13],["being",13],["literally",15],["audible",15],["but",15],["instead\na",15],["mathematical",15],["concept.",15],["Math",18],["and",18],["music",18],["are\nintrinsically",18],["connected.",18],["The",21],["field",21],["of\nalgorithmic",21],["composition",21],["dates",23],["back",23],["to",23],["the",23],["early\ndays",23],["of",23],["computer",23],["science.",23],["Translation",26],["models",26],["take",26],["an\nexisting",26],["non-musical",26],["medium,",26],["like",29],["a",29],["picture,",29],["and\ntranslate",29],["it",29],["into",29],["a",29],["sound.",29],["These",32],["are",32],["usually",32],["rule-based.",32],["So",34],["a",34],["rule",34],["may",34],["be",34],["that",34],["if",34],["it",34],["sees\na",34],["horizontal",34],["line",34],["in",34],["an",34],["image,",34],["it",38],["will",38],["interpret",38],["that\nas",38],["a",38],["constant",38],["pitch,",38],["whereas",41],["a",41],["vertical",41],["line\nrepresents",41],["an",41],["ascending",41],["scale.",41],["Evolutionary",44],["models",44],["are",44],["based\noff",44],["of",44],["genetic",44],["algorithms.",44],["Through",47],["mutation",47],["and\nnatural",47],["selection,",47],["different",50],["solutions",50],["evolve\ntowards",50],["a",50],["suitable",50],["composition.",50],["Then",53],["there's",53],["the",53],["learning",53],["model.",53],["By",55],["providing",55],["it",55],["musical\ndata,",55],["instead",55],["of",55],["rules,",55],["we",58],["can",58],["let",58],["it",58],["learn",58],["for\nitself",58],["how",58],["to",58],["create",58],["music.",58],["We're",61],["fast",61],["approaching",61],["the\npoint",61],["where",61],["we'll",61],["no",61],["longer",61],["have",61],["to",63],["wonder",63],["how",63],["Mozart",63],["or",63],["Jimi\nHendrix",63],["would",63],["have",63],["composed",63],["a",66],["piece",66],["on",66],["a",66],["certain",66],["topic.",66],["We'll",68],["just",68],["be",68],["able",68],["to",68],["ask\ntheir",68],["algorithmic",68],["counterparts",68],["ourselves.",70],["Hello,",71],["world!",71],["It's",72],["Siraj,",72],["and\ntoday",72],["we're",72],["going",72],["to",74],["use",74],["deep",74],["learning",74],["to\ngenerate",74],["some",74],["jazz",74],["music.",74],["The",77],["first",77],["attempt",77],["by",77],["anyone",77],["to\nuse",77],["a",77],["computer",77],["to",77],["compose",77],["music",77],["was",81],["by",81],["two",81],["American",81],["professors\nat",81],["the",81],["University",81],["of",81],["Illinois",81],["Urbana-Champaign,\nHiller",85],["and",85],["Issacson.",85],["They",88],["programmed",88],["the\nuniversity's",88],["Iliac",88],["computer",88],["to",91],["compose",91],["music.",91],["And",92],["it",92],["generated",92],["pitches\nusing",92],["random",92],["numbers",92],["before",95],["testing",95],["them\naccording",95],["to",95],["the",95],["rules",95],["of",98],["classical",98],["counterpoint.",98],["So",99],["if",99],["a",99],["pitch\ndidn't",99],["fit",99],["a",99],["piece,",99],["another",102],["note",102],["was",102],["generated.",102],["It",104],["also",104],["relied",104],["on",104],["probabilities\nvia",104],["a",104],["Markov",104],["chain.",104],["It",108],["used",108],["the",108],["past",108],["to\ndetermine",108],["the",108],["probabilities",108],["of",111],["the",111],["future.",111],["The",112],["first",112],["piece",112],["was\ncompleted",112],["in",112],["1957",112],["and",115],["was",115],["called",115],["the",115],["Iliac\nSuite",115],["for",115],["String",115],["Quartet.",115],["Although",123],["it",123],["made",123],["headlines\nin",123],["Scientific",123],["American,",123],["the",125],["musical",125],["establishment\nwas",125],["pretty",125],["hostile",125],["to",125],["them.",125],["They",128],["thought",128],["it",128],["undermined\nhuman",128],["creativity",128],["and",130],["didn't",130],["include\nthem",130],["in",130],["their",130],["journals",130],["until",133],["after",133],["Hiller's",133],["death.",133],["Nowadays,",135],["there",135],["are",135],["a",135],["ton",135],["of\namazing",135],["generative",135],["programs",135],["for",138],["composers",138],["to",138],["aid",138],["them\nwhen",138],["they",138],["compose",138],["music.",138],["Like",141],["iTunes?",141],["Let's",143],["understand",143],["this",143],["process\nby",143],["building",143],["a",143],["model",143],["to",143],["generate",143],["jazz",146],["pieces",146],["using",146],["Keras.",146],["We'll",148],["first",148],["examine\nthe",148],["music",148],["we're",148],["going",150],["to",150],["train",150],["our",150],["model",150],["on.",150],["Our",151],["input",151],["data",151],["is",151],["going",151],["to",151],["be\na",151],["collection",151],["of",151],["piano",151],["pieces",151],["by",154],["American",154],["jazz",154],["musician,\nPat",154],["Metheny,",154],["in",154],["MIDI",154],["format.",154],["MIDI,",158],["or",158],["musical",158],["instrument\ndigital",158],["interface,",158],["is",161],["like",161],["the",161],["digital\nalphabet",161],["for",161],["music.",161],["It",163],["contains",163],["a",163],["list\nof",163],["messages",163],["that",163],["tell",165],["an",165],["electronic\ndevice,",165],["like",165],["a",165],["sound",165],["card,",165],["how",167],["to",167],["generate",167],["a",167],["certain",167],["sound.",167],["So",169],["it",169],["doesn't",169],["store\nactual",169],["sound",169],["itself,",169],["which",169],["lends",172],["to",172],["a",172],["much",172],["smaller",172],["file.",172],["Since",174],["these",174],["messages\nare",174],["a",174],["sequence,",174],["we'll",175],["use",175],["a",175],["recurrent",175],["network\nas",175],["our",175],["sequence",175],["learning",175],["model.",175],["For",179],["each",179],["MIDI\nfile,",179],["we'll",179],["extract",179],["the",180],["stream",180],["of",180],["nodes",180],["for",180],["both\nthe",180],["melody",180],["and",180],["the",180],["harmony.",180],["The",183],["harmony's",183],["chords",183],["accompany\nthe",183],["melody's",183],["single",183],["notes.",183],["Then",187],["we'll",187],["group",187],["them",187],["all\ntogether",187],["by",187],["measure",187],["number.",187],["So",190],["each",190],["measure",190],["has",190],["its\nown",190],["grouping",190],["of",190],["chords",190],["and",193],["this",193],["measure",193],["chord\npair",193],["is",193],["what",193],["we'll",193],["call",195],["our",195],["abstract",195],["grammars.",195],["We'll",197],["vectorize",197],["these\ninputs",197],["by",197],["converting",197],["them",197],["into",199],["binary",199],["matrices",199],["so",199],["we\ncan",199],["feed",199],["them",199],["into",199],["our",199],["model.",199],["Now",203],["we",203],["can",203],["build",203],["our",203],["model.",203],["This",205],["is",205],["going",205],["to",205],["be",205],["a\ndouble",205],["stacked",205],["LSTM",205],["network.",205],["So",208],["our",208],["computation",208],["graph\nwill",208],["look",208],["like",208],["this.",208],["The",211],["vectorize",211],["sequence\nof",211],["notes",211],["will",211],["be",211],["input",211],["into",213],["the",213],["first",213],["LSTM",213],["cell.",213],["Then",215],["we'll",215],["apply\na",215],["dropout",215],["to",215],["help",215],["ensure",217],["that",217],["the",217],["model\ngeneralized",217],["well.",217],["And",219],["we'll",219],["do",219],["that\nprocess",219],["one",219],["more",219],["time.",219],["Then",221],["we'll",221],["feed",221],["the",221],["data",221],["to\nour",221],["last",221],["fully",221],["connected",221],["layer,",221],["labeled",224],["Dense.",224],["Since",225],["every",225],["neuron\nin",225],["the",225],["previous",225],["layer",225],["is",227],["connecting",227],["to",227],["every\nneuron",227],["in",227],["this",227],["layer,",227],["it",230],["will",230],["mix",230],["all",230],["the\nlearned",230],["signals",230],["together",230],["so",232],["our",232],["prediction",232],["is",232],["truly",232],["based\non",232],["the",232],["whole",232],["input",232],["sequence.",232],["We'll",236],["lastly",236],["transform\nthe",236],["result",236],["with",236],["a",236],["softmax",236],["activation",238],["function",238],["into\nan",238],["output",238],["probability",238],["for",241],["what",241],["is",241],["likely",241],["the\nnext",241],["note",241],["in",241],["the",241],["sequence.",241],["When",244],["we",244],["build",244],["our",244],["first\nLSTM",244],["layer,",244],["by",244],["default",244],["it",247],["will",247],["only",247],["return",247],["the\nlast",247],["vector,",247],["rather",247],["than",247],["the",249],["entire",249],["sequence.",249],["So",250],["we",250],["set",250],["return\nsequences",250],["to",250],["True",250],["so",253],["that",253],["it",253],["returns",253],["the\nentire",253],["sequence,",253],["which",253],["is",255],["necessary",255],["to",255],["be",255],["able",255],["to\nstack",255],["another",255],["LSTM",255],["later",255],["on.",255],["Using",259],["two",259],["LSTM\nlayers",259],["instead",259],["of",259],["one",259],["allows",261],["for",261],["a",261],["more",261],["complex\nfeature",261],["representation",261],["of",264],["the",264],["input,",264],["which",264],["means\nmore",264],["generalization",264],["ability.",264],["And",266],["thus,",266],["a",266],["better",266],["prediction.",266],["Recall",268],["that",268],["recurrent\nnetworks",268],["are",268],["essentially",268],["like",270],["a",270],["series",270],["of\nfeedforward",270],["networks",270],["that",272],["are",272],["connected\nto",272],["each",272],["other.",272],["The",274],["output",274],["of",274],["each\nand",274],["its",274],["hidden",274],["layer",274],["is",275],["fed",275],["into",275],["the",275],["next",275],["one.",275],["And",277],["when",277],["we",277],["back\npropagate,",277],["with",277],["each",277],["layer,",277],["the",280],["magnitude",280],["of",280],["the",280],["gradient\ngets",280],["exponentially",280],["smaller,",280],["which",283],["makes",283],["the",283],["steps\nalso",283],["very",283],["small,",283],["which",285],["results",285],["in",285],["a\nvery",285],["slow",285],["learning",285],["rate",287],["of",287],["the",287],["weights",287],["in",287],["the\nlower",287],["layers",287],["of",287],["a",287],["deep",287],["network.",287],["This",290],["is",290],["the",290],["vanishing\ngradient",290],["problem",290],["and",291],["LSTM",291],["recurrent\nnodes",291],["help",291],["solve",291],["that",291],["by",294],["preserving",294],["the",294],["error\nthat",294],["can",294],["be",294],["back",294],["propagated",294],["through",296],["time",296],["and",296],["layers.",296],["Let's",298],["look",298],["a",298],["little\ncloser",298],["at",298],["this",298],["process,",298],["but",300],["first",300],["I",300],["got",300],["to",300],["say,",300],["[SINGING]",301],["L-S-T-M.",301],["Say",301],["it",301],["again.",301],["L-S-T-M.",304],["Say",304],["it",304],["again.",304],["When",307],["data",307],["goes",307],["in\nit",307],["forgets",307],["the",307],["BS.",307],["Remembers",309],["the",309],["good",309],["stuff\nthen",309],["outputs",309],["the",309],["rest.",309],["L-S-T-M.",312],["Say",312],["it",312],["again.",312],["An",315],["LSTM",315],["cell",315],["consists\nof",315],["three",315],["gates--",315],["the",318],["input,",318],["forget,",318],["and",318],["output,\nas",318],["well",318],["as",318],["a",318],["cell",318],["state.",318],["The",321],["cell",321],["state",321],["is\nlike",321],["a",321],["conveyor",321],["belt.",321],["It",323],["just",323],["lets",323],["memory\nflow",323],["across",323],["unchanged,",323],["except",326],["for",326],["a",326],["few",326],["minor\nlinear",326],["interactions.",326],["These",328],["interactions\nare",328],["the",328],["gates.",328],["We",330],["can",330],["add",330],["or",330],["remove\nmemory",330],["from",330],["the",330],["cell",330],["state",332],["regulated",332],["by",332],["them.",332],["They",334],["optionally\nlet",334],["memory",334],["through.",334],["Each",336],["is",336],["a",336],["sigmoid",336],["neural",336],["net\nlayer",336],["and",336],["a",336],["multiplication",336],["operation.",339],["The",340],["sigmoid",340],["outputs",340],["a\nvalue",340],["between",340],["0",340],["and",340],["1,",340],["which",343],["describes",343],["how\nmuch",343],["of",343],["each",343],["component",343],["should",344],["be",344],["let",344],["through.",344],["We'll",345],["represent\neach",345],["of",345],["the",345],["gates",345],["with",347],["the",347],["following\nequations,",347],["where",347],["w",349],["is",349],["the",349],["set",349],["of\nweights",349],["at",349],["each",349],["gate.",349],["The",352],["way",352],["its",352],["internal\nmemory",352],["changes",352],["is",354],["similar",354],["to",354],["piping\nwater",354],["through",354],["a",354],["pipe.",354],["So",357],["think",357],["of",357],["memory",357],["as",357],["water.",357],["It",358],["flows",358],["into",358],["a",358],["pipe.",358],["If",360],["we",360],["want",360],["to",360],["change\nthe",360],["memory",360],["flow,",360],["this",362],["change",362],["is\ncontrolled",362],["by",362],["two",362],["valves.",362],["The",364],["forget",364],["valve",364],["first.",364],["If",366],["we",366],["shut",366],["it,",366],["no",366],["old\nmemory",366],["will",366],["be",366],["kept.",366],["If",368],["we",368],["keep",368],["it",368],["open,",368],["all",368],["old\nmemory",368],["will",368],["pass",368],["through.",368],["The",371],["other",371],["is",371],["the\nnew",371],["memory",371],["valve.",371],["New",373],["memory",373],["comes",373],["in",373],["through\na",373],["t-shaped",373],["joint",373],["and",373],["merges",373],["with",377],["the",377],["old",377],["memory.",377],["And",378],["the",378],["amount",378],["of",378],["new\nmemory",378],["that",378],["comes",378],["in",378],["is",380],["controlled",380],["by",380],["this",380],["valve.",380],["The",382],["input",382],["is",382],["in\nold",382],["memory",382],["and",382],["it",382],["passes",384],["through",384],["the",384],["forget\nvalve,",384],["which",384],["is",384],["actually",384],["a",386],["multiplication",386],["operation.",386],["The",388],["old",388],["memory",388],["hits",388],["the\nt-shaped",388],["joint",388],["pipe,",388],["which",390],["represents",390],["a\nsummation",390],["operation.",390],["New",392],["and",392],["old",392],["memory",392],["merge\nthrough",392],["this",392],["operation.",392],["In",395],["total,",395],["this",395],["updates",395],["the\nold",395],["memory",395],["to",395],["the",395],["new",395],["memory.",395],["We'll",398],["define",398],["our",398],["loss",398],["function\nas",398],["categorical",398],["crossentropy.",398],["The",401],["crossentropy",401],["between",401],["two\nprobability",401],["distributions",401],["measure",405],["the",405],["average\nnumber",405],["of",405],["bits",405],["needed",406],["to",406],["identify",406],["an",406],["event\nfrom",406],["a",406],["set",406],["of",406],["possibilities.",406],["Since",409],["our",409],["data",409],["is\nfed",409],["in",409],["sequences,",409],["this",411],["measures",411],["the",411],["difference\nbetween",411],["the",411],["real",411],["next",411],["note",411],["and",414],["our",414],["predicted",414],["next",414],["note.",414],["We'll",416],["minimize\nthis",416],["loss",416],["function",416],["using",417],["rmsprop,",417],["which\nis",417],["an",417],["implementation",417],["of",420],["stochastic",420],["gradient",420],["descent.",420],["So",422],["we'll",422],["predict",422],["the\nnext",422],["note",422],["in",422],["the",422],["sequence",422],["over",425],["and",425],["over\nagain",425],["until",425],["we",425],["have",425],["a",427],["sequence",427],["of",427],["generated",427],["notes.",427],["We'll",429],["translate",429],["this",429],["into",429],["MIDI\nformat",429],["and",429],["write",429],["it",429],["to",429],["a",429],["file",429],["so",432],["we",432],["can",432],["listen",432],["to",432],["it.",432],["Let's",434],["hear",434],["what\nthis",434],["sounds",434],["like.",434],["[MUSIC",435],["PLAYING]",435],["At",445],["least",445],["it's",445],["better",445],["than\nKenny",445],["G.",445],["So",445],["we're",445],["all",445],["good.",445],["So",448],["to",448],["break",448],["it",448],["down,\nwe",448],["can",448],["generate",448],["music",448],["using",450],["LSTM",450],["networks",450],["to\npredict",450],["sequences",450],["of",450],["notes.",450],["LSTMs",454],["consist",454],["of",454],["three",454],["gates--",454],["the",456],["input,",456],["forget,\nand",456],["output",456],["gate.",456],["And",459],["we",459],["can",459],["think",459],["of",459],["these\ngates",459],["as",459],["valves",459],["controlling",459],["how",461],["memory",461],["is",461],["stored",461],["in",461],["our\nnetwork",461],["to",461],["eliminate",461],["vanishing",461],["gradients.",464],["The",465],["winner",465],["of",465],["the",465],["coding\nchallenge",465],["from",465],["the",465],["last",465],["video",465],["is",468],["the",468],["Vishal",468],["Batchu.",468],["Not",469],["only",469],["did",469],["he",469],["perform\nmultiple",469],["style",469],["transfer,",469],["but",472],["he",472],["took",472],["it",472],["a",472],["step",472],["further",472],["by\napplying",472],["it",472],["to",472],["video,",472],["as",472],["well.",472],["Wizard",475],["of",475],["the",475],["Week.",475],["And",477],["the",477],["runner",477],["up\nis",477],["Michael",477],["Pelka.",477],["He",479],["successfully",479],["performed\nmulti-style",479],["transfer",479],["through",481],["a",481],["clever\nmatrix",481],["operation.",481],["The",483],["coding",483],["challenge\nfor",483],["this",483],["video",483],["is",485],["to",485],["generate",485],["a",485],["music",485],["clip\nfor",485],["a",485],["genre",485],["that",485],["you",485],["choose.",485],["Remember,",488],["it's",488],["just",488],["a\nsequence",488],["of",488],["MIDI",488],["messages.",488],["Post",491],["your",491],["github\nlink",491],["in",491],["the",491],["comments,",491],["and",493],["I'll",493],["announce",493],["the\nwinner",493],["next",493],["video.",493],["Please",494],["subscribe",494],["for\nmore",494],["programming",494],["videos.",494],["Check",496],["out",496],["this",496],["related",496],["video.",496],["And",498],["for",498],["now,",498],["I've",498],["got",498],["to\nmemorize",498],["memory",498],["cells.",498],["So,",500],["thanks",500],["for",500],["watching.",500]]}