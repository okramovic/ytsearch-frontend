{"title":"Generate Music in TensorFlow","fromid":"ZE7qWXX05T0","words":[["SIRAJ:",0],["-Hey,",0],["are",0],["you",0],["OK?",0],["WOMAN:",1],["-I",1],["want",1],["to",1],["make",1],["music",1],["but",1],["I",1],["don't",1],["know",1],["how!",1],["SIRAJ:",9],["-Hello",9],["World,",9],["it's",9],["Siraj!",9],["In",11],["this",11],["episode,",11],["we're",11],["going",11],["to",11],["talk",11],["about",11],["the",11],["bleeding",11],["edge",11],["in",13],["machine-generated",13],["music,",13],["then",15],["write",15],["our",15],["own",15],["music",15],["generation",15],["script",15],["in",15],["TensorFlow",15],["in",17],["just",17],["under",17],["90",17],["lines",17],["of",17],["Python.",17],["I'm",19],["a",19],["big",19],["fan",19],["of",19],["Hans",19],["Zimmer.",19],["-Don't",21],["leave",21],["Matthew",21],["McConaughey.",21],["No...",21],["-But",24],["I",24],["don't",24],["have",24],["the",24],["time",24],["to",24],["put",24],["in",24],["10,000",24],["hours",24],["to",24],["be",24],["like",24],["Hans.",24],["But",27],["just",27],["imagine",27],["a",27],["program",27],["where",27],["I",27],["can",27],["say",27],["\"I",29],["want",29],["a",29],["song",29],["that",29],["conveys",29],["the",29],["feelings",29],["of",29],["hope",29],["and",29],["wonder",29],["while",32],["sailing",32],["the",32],["Seven",32],["Seas",32],["but",33],["also",33],["the",33],["gaseous",33],["feeling",33],["of",33],["eating",33],["too",33],["many",33],["beans.\"",33],["The",36],["program",36],["would",36],["convert",36],["that",36],["speech",36],["to",36],["text",36],["and,",38],["for",38],["each",38],["word,",38],["it",38],["would",38],["find",38],["the",38],["associated",38],["vector.",38],["It",40],["would",40],["then",40],["compare",40],["those",40],["vectors",40],["to",40],["vectors",40],["created",40],["by",43],["a",43],["model",43],["trained",43],["on",43],["a",43],["labeled",43],["music",43],["data",43],["set",43],["for",45],["a",45],["range",45],["of",45],["human",45],["emotions.",45],["The",46],["output",46],["of",46],["the",46],["machine",46],["would",46],["then",46],["be",46],["a",46],["set",46],["of",46],["chords",46],["that",49],["it",49],["thought",49],["best",49],["represented",49],["those",49],["emotions.",49],["It",51],["would",51],["lower",51],["the",51],["barrier",51],["to",51],["entry",51],["for",51],["me",51],["to",51],["compose",51],["music.",51],["Machine",54],["learning",54],["is",54],["a",54],["layer",54],["of",54],["intelligence",54],["that",56],["is",56],["meant",56],["to",56],["extend",56],["our",56],["own.",56],["-I'm",58],["still",58],["really",58],["bad",58],["at",58],["folding",58],["shirts.",58],["A",60],["laundry-folding",60],["robot",60],["would",60],["be",60],["so",60],["dope!",60],["DeepMind",62],["released",62],["a",62],["paper",62],["a",62],["few",62],["days",62],["ago",62],["called",62],["\"WaveNet,\"",62],["which",65],["is",65],["now",65],["the",65],["state",65],["of",65],["the",65],["art",65],["in",65],["both",65],["music",67],["generation",67],["and",67],["text-to-speech.",67],["Traditionally,",69],["audio",69],["generation",69],["models",69],["are",69],["concatenative.",69],["That",72],["means",72],["in",72],["order",72],["to",72],["generate",72],["speech",72],["from",72],["some",72],["text",72],["sample,",72],["it",75],["utilizes",75],["a",75],["huge",75],["database",75],["of",75],["speech",75],["fragments",75],["by",78],["picking",78],["a",78],["few",78],["and",78],["combining",78],["them",78],["to",80],["create",80],["a",80],["full",80],["sentence.",80],["Same",80],["for",80],["music.",80],["This",82],["works,",82],["but",82],["it's",82],["hard",82],["to",82],["incorporate",82],["things",82],["like",82],["emotion",84],["and",84],["natural",84],["sound",84],["when",84],["the",84],["output",84],["is",84],["created",84],["by",87],["putting",87],["a",87],["bunch",87],["of",87],["static",87],["fragments",87],["together.",87],["Ideally,",89],["we",89],["could",89],["have",89],["audio",89],["generation",89],["that",91],["is",91],["parametric,",91],["where",91],["all",91],["the",91],["info",91],["required",91],["to",93],["generate",93],["audio",93],["is",93],["stored",93],["in",93],["the",93],["parameters",93],["of",95],["the",95],["model",95],["that",95],["we",95],["give",95],["it.",95],["That's",96],["what",96],["WaveNet",96],["is",96],["capable",96],["of.",96],["Instead",98],["of",98],["generating",98],["an",98],["audio",98],["signal",98],["by",98],["passing",98],["its",100],["output",100],["through",100],["signal",100],["processing",100],["algorithms,",100],["it",103],["directly",103],["models",103],["the",103],["raw",103],["waveform",103],["of",103],["the",103],["audio",103],["signal.",103],["Researchers",106],["don't",106],["really",106],["do",106],["that,",106],["but",106],["WaveNet",106],["did.",106],["The",109],["model",109],["they",109],["used",109],["was",109],["a",109],["convolutional",110],["neural",110],["network",110],["where",110],["each",110],["layer",110],["had",113],["dilation",113],["factors",113],["that",113],["let",113],["its",113],["interconnectedness",113],["grow",116],["exponentially",116],["the",116],["deeper",116],["the",116],["data",116],["flowed",118],["through",118],["the",118],["model,",118],["and",118],["each",118],["generated",118],["sample",118],["at",120],["each",120],["step",120],["was",120],["fed",120],["back",120],["into",120],["the",120],["network",120],["to",123],["generate",123],["the",123],["next",123],["step.",123],["Let's",124],["take",124],["a",124],["look",124],["at",124],["the",124],["computation",124],["graph",124],["for",124],["the",124],["model.",124],["The",126],["input",126],["data,",126],["a",126],["single",126],["node,",126],["starts",126],["as",126],["a",126],["raw",126],["audio",126],["wave.",126],["We",129],["first",129],["formate",129],["the",129],["wave",129],["so",129],["that",129],["it's",129],["better",129],["suited",129],["for",131],["processing,",131],["then",131],["you",131],["encode",131],["it",131],["to",131],["produce",131],["a",131],["tensor",131],["with",134],["a",134],["number",134],["of",134],["samples",134],["and",134],["a",134],["number",134],["of",134],["channels.",134],["We",136],["feed",136],["that",136],["into",136],["the",136],["first",136],["layer",136],["of",136],["the",136],["convolutional",136],["network,",136],["which",139],["reduces",139],["the",139],["number",139],["of",139],["channels",139],["for",139],["easier",139],["processing,",139],["then",141],["through",141],["a",141],["stack",141],["of",141],["layers",141],["with",141],["dilated",141],["convolution.",141],["We",144],["combine",144],["the",144],["outputs",144],["of",144],["all",144],["the",144],["layers",144],["and",146],["increase",146],["the",146],["dimensionality",146],["to",146],["the",146],["original",147],["number",147],["of",147],["channels.",147],["Feed",148],["it",148],["all",148],["to",148],["a",148],["loss",148],["function,",148],["which",150],["measures",150],["how",150],["well",150],["our",150],["training",150],["is",150],["going,",150],["and,",152],["finally,",152],["the",152],["output",152],["is",152],["fed",152],["back",152],["into",152],["the",152],["network",152],["to",154],["generate",154],["the",154],["wave",154],["of",154],["the",154],["next",154],["time",154],["step.",154],["This",156],["process",156],["keeps",156],["repeating",156],["to",156],["generate",156],["more",157],["and",157],["more",157],["audio.",157],["This",158],["neural",158],["net",158],["was",158],["huge.",158],["It",159],["took",159],["90",159],["minutes",159],["on",159],["their",159],["GPU",159],["cluster",159],["to",162],["generate",162],["a",162],["single",162],["second",162],["of",162],["audio.",162],["Instead,",163],["we're",163],["going",163],["to",163],["build",163],["a",163],["more",163],["simple",163],["music",165],["generation",165],["script",165],["in",165],["TensorFlow.",165],["We",167],["want",167],["to",167],["first",167],["import",167],["numpy",167],["as",167],["a",167],["scientific",167],["computing",169],["library",169],["in",169],["Python,",169],["then",170],["pandas",170],["as",170],["our",170],["data",170],["analytics",170],["library,",170],["then,",172],["of",172],["course,",172],["tensorflow,",172],["our",172],["machine",172],["learning",172],["library.",172],["tqdm",175],["will",175],["help",175],["us",175],["show",175],["a",175],["progress",175],["bar",175],["during",175],["training,",175],["and",177],["finally",177],["midi_manipulation",177],["which",177],["is",177],["our",177],["helper",177],["library.",177],["Let's",179],["start",179],["off",179],["with",179],["the",179],["first",179],["step:",179],["our",181],["hyperparameters,",181],["or",181],["tuning",181],["knobs,",181],["for",181],["our",181],["model.",181],["We're",183],["going",183],["to",183],["use",183],["a",183],["type",183],["of",183],["neural",183],["network",183],["called",185],["a",185],["\"restricted",185],["Boltzmann",185],["machine\"",185],["as",187],["our",187],["generative",187],["model.",187],["An",189],["RBM",189],["is",189],["a",189],["two-layer",189],["neural",189],["net.",189],["The",191],["first",191],["layer",191],["is",191],["visible",191],["and",191],["the",191],["next",191],["layer",191],["is",191],["hidden.",191],["Nodes",193],["within",193],["layers",193],["are",193],["connected",193],["to",193],["nodes",193],["in",195],["the",195],["next",195],["layer,",195],["but",195],["no",195],["two",195],["nodes",195],["of",195],["the",195],["same",195],["layer",195],["are",197],["linked.",197],["That's",197],["the",197],["restriction",197],["part.",197],["Each",199],["node",199],["decides",199],["whether",199],["to",199],["transmit",199],["any",199],["data",199],["it",199],["receives",199],["to",202],["the",202],["next",202],["layer",202],["or",202],["not",202],["by",202],["making",202],["a",202],["random",202],["decision.",202],["We",205],["want",205],["to",205],["first",205],["create",205],["a",205],["range",205],["of",205],["notes",205],["that",206],["our",206],["model",206],["will",206],["generate,",206],["so",206],["we'll",206],["write",206],["variables",206],["for",208],["our",208],["lowest",208],["note",208],["and",208],["our",208],["highest",208],["note,",208],["as",210],["well",210],["as",210],["a",210],["note",210],["range",210],["which",210],["is",210],["the",210],["difference",210],["between",211],["the",211],["two.",211],["Then",212],["we'll",212],["write",212],["variables",212],["for",212],["the",212],["number",212],["of",212],["times,",212],["the",214],["size",214],["of",214],["the",214],["visible",214],["layer,",214],["the",214],["number",214],["of",214],["hidden",214],["layers,",214],["the",217],["number",217],["of",217],["training",217],["epochs,",217],["batch",217],["size,",217],["and",218],["finally",218],["our",218],["learning",218],["rate",218],["which",218],["is",218],["a",218],["TensorFlow",220],["constant",220],["since",220],["it",220],["always",220],["stays",220],["the",220],["same.",220],["Next,",223],["we",223],["can",223],["write",223],["out",223],["variables.",223],["We'll",224],["start",224],["off",224],["by",224],["creating",224],["a",224],["placeholder",224],["which",226],["will",226],["serve",226],["as",226],["our",226],["gateway",226],["for",226],["inputting",228],["data",228],["into",228],["our",228],["model.",228],["Then",229],["a",229],["variable",229],["that",229],["will",229],["store",229],["the",229],["weight",229],["matrix,",229],["or",231],["the",231],["connections",231],["between",231],["our",231],["two",231],["layers.",231],["We",232],["also",232],["need",232],["two",232],["variables",232],["for",232],["biases:",232],["one",234],["for",234],["the",234],["hidden",234],["layer",234],["and",234],["one",234],["for",234],["the",234],["visible",234],["layer.",234],["We",237],["now",237],["want",237],["to",237],["create",237],["sample",237],["from",237],["our",237],["input",237],["named",237],["\"x\"",237],["using",239],["our",239],["gibbs_sample()",239],["helper",239],["method.",239],["Gibbs",241],["sampling",241],["is",241],["an",241],["algorithm",241],["that",241],["creates",241],["a",241],["sample",241],["from",243],["a",243],["multivariate",243],["probability",243],["distribution.",243],["It",245],["constructs",245],["a",245],["statistical",245],["model",245],["where",245],["each",245],["state",245],["depends",248],["on",248],["the",248],["previous",248],["state,",248],["and",248],["uses",248],["randomness",248],["to",250],["obtain",250],["a",250],["sample",250],["across",250],["the",250],["distribution",250],["it",250],["creates.",250],["We'll",253],["get",253],["a",253],["sample",253],["of",253],["the",253],["hidden",253],["nodes",253],["as",253],["well,",253],["starting",255],["from",255],["our",255],["original",255],["input,",255],["and",257],["a",257],["sample",257],["of",257],["the",257],["hidden",257],["nodes",257],["starting",257],["from",258],["our",258],["generated",258],["sample.",258],["Then",259],["we'll",259],["update",259],["our",259],["weight",259],["value",259],["based",259],["on",259],["the",261],["differences",261],["between",261],["the",261],["samples",261],["that",261],["we",261],["drew",261],["and",263],["the",263],["original",263],["values.",263],["We",264],["will",264],["run",264],["these",264],["three",264],["update",264],["steps",264],["for",264],["our",264],["weights,",264],["hidden",267],["biases,",267],["and",267],["visible",267],["biases",267],["when",267],["we",267],["later",267],["run",267],["our",267],["Session,",267],["and",270],["we",270],["can",270],["store",270],["all",270],["of",270],["these",270],["in",270],["our",270],["update",270],["variable.",270],["Alright,",272],["it's",272],["time",272],["to",272],["start",272],["Session",272],["so",272],["we",272],["can",272],["run",272],["our",272],["graph.",272],["We'll",275],["initialize",275],["our",275],["variables",275],["first.",275],["We're",277],["going",277],["to",277],["reshape",277],["each",277],["song",277],["so",277],["they",277],["are",277],["vectorized",277],["in",279],["a",279],["good",279],["training",279],["format,",279],["then",279],["we're",279],["going",279],["to",279],["train",280],["our",280],["RBM",280],["on",280],["these",280],["samples",280],["one",280],["at",280],["a",280],["time.",280],["Once",283],["the",283],["model",283],["is",283],["fully",283],["trained,",283],["we",283],["will",283],["make",283],["some",283],["music.",283],["We",285],["run",285],["our",285],["Gibbs",285],["chain",285],["where",285],["the",285],["visible",285],["nodes",285],["are",285],["initialized",287],["to",287],["0",287],["to",287],["generate",287],["sample,",287],["and",289],["reshape",289],["the",289],["vector",289],["to",289],["be",289],["the",289],["proper",289],["format",289],["for",289],["playback.",289],["Finally,",291],["we'll",291],["print",291],["out",291],["the",291],["generated",291],["chords.",291],["♫♫",293],["Dope!",297],["The",297],["state",297],["of",297],["the",297],["art",297],["in",297],["music",297],["generation",297],["uses",299],["a",299],["CNN",299],["to",299],["generate",299],["raw",299],["waveforms",299],["parametrically",299],["instead",302],["of",302],["concatenatively.",302],["That",304],["algorithm",304],["requires",304],["a",304],["lot",304],["to",304],["compute",304],["right",304],["now,",304],["so",306],["we",306],["can",306],["use",306],["an",306],["RBM",306],["to",306],["generate",306],["audio",306],["samples",306],["based",309],["on",309],["training",309],["data",309],["easily,",309],["and",310],["Gibbs",310],["sampling",310],["helps",310],["us",310],["create",310],["audio",310],["samples",310],["during",313],["training",313],["by",313],["randomly",313],["obtaining",313],["them",313],["from",315],["a",315],["generated",315],["probability",315],["distribution",315],["based",317],["on",317],["the",317],["input",317],["data.",317],["And",318],["so,",318],["the",318],["winner",318],["of",318],["the",318],["last",318],["coding",318],["challenge",318],["is",320],["Rohan",320],["Verma!",320],["He",320],["created",320],["an",320],["image",320],["classifier",320],["for",323],["astronomers",323],["to",323],["classify",323],["galaxies",323],["as",323],["either",323],["elliptical",323],["or",326],["spiral.",326],["Badass",326],["of",326],["the",326],["week.",326],["And",328],["the",328],["runner-up",328],["is",328],["Chih-Cheng",328],["Liang",328],["for",330],["creating",330],["a",330],["bird",330],["classifier",330],["for",330],["biologists.",330],["I",332],["bow",332],["to",332],["both",332],["of",332],["you.",332],["The",333],["challenge",333],["for",333],["this",333],["video",333],["is",333],["to",333],["use",333],["the",333],["RBM",333],["script",333],["to",336],["generate",336],["an",336],["audio",336],["sample",336],["with",336],["a",336],["happy,",336],["upbeat",336],["sound.",336],["Post",339],["your",339],["code",339],["in",339],["the",339],["comments.",339],["I'll",341],["judge",341],["them",341],["and",341],["announce",341],["them",341],["in",341],["my",341],["video",341],["one",343],["week",343],["from",343],["now.",343],["For",343],["now,",343],["I'm",343],["going",343],["to",343],["get",343],["more",343],["silver",343],["hair",343],["dye,",343],["so",345],["thanks",345],["for",345],["watching.",345]]}