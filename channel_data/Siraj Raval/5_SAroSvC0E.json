{"title":"Build a Chatbot - ML for Hackers #6","fromid":"5_SAroSvC0E","words":[["Open",0],["the",0],["podbay",0],["doors",0],["HAL\nI’m",0],["afraid",0],["i",0],["can't",0],["do",0],["that",0],["Siraj.",0],["Why",5],["not",5],["HAL?\nBecause",5],["I’ve",5],["overfitted",5],["on",5],["a",5],["small",5],["dataset",5],["What",7],["the",7],["f--",7],["Hello",10],["World,",10],["welcome",10],["to",10],["Sirajology!",10],["In",10],["today’s\nepisode,",10],["we’re",10],["going",10],["to",10],["learn",10],["how",10],["to",10],["build",10],["a",13],["chatbot.",13],["Chatbots",13],["have",13],["come",13],["a",13],["long",13],["way",13],["the\npast",13],["few",13],["years.",13],["Remember",13],["the",13],["Smarterchild",13],["bot",17],["on",17],["AIM?",17],["That",17],["thing",17],["was",17],["pretty",17],["fun",17],["at",17],["the\ntime",17],["but",17],["now",17],["its",17],["like",17],["‘do",17],["you",17],["even",17],["AI",17],["bro?’",17],["The",21],["future",21],["of",21],["software",21],["is",21],["one",21],["where",21],["bots",21],["will\nslowly",21],["replace",21],["our",21],["need",21],["to",21],["fiddle",21],["with",21],["clunky",21],["UIs.",25],["We’ll",25],["be",25],["able",25],["to",25],["just",25],["ask",25],["our",25],["AI",25],["assistant\nto",25],["book",25],["an",25],["uber",25],["or",25],["find",25],["the",25],["best",25],["taco",25],["place",25],["on",29],["Yelp",29],["for",29],["us.",29],["Service",29],["layers",29],["will",29],["be",29],["hidden\nunder",29],["a",29],["plain-english,",29],["conversational",29],["layer.",29],["When",33],["I",33],["think",33],["of",33],["real",33],["AI,",33],["i",33],["think",33],["of",33],["a",33],["human-level\nchatbot.",33],["The",33],["OG",33],["Computer",33],["Scientist",33],["Alan",33],["Turing",33],["proposed",38],["a",38],["test",38],["to",38],["judge",38],["whether",38],["or",38],["not",38],["a\nmachine",38],["exhibited",38],["human-level",38],["intelligence",38],["by",41],["having",41],["a",41],["human",41],["observe",41],["a",41],["conversation",41],["between\na",41],["human",41],["and",41],["a",41],["machine.",41],["If",41],["it",41],["couldn’t",41],["tell",41],["if",45],["the",45],["machine",45],["was",45],["a",45],["human",45],["or",45],["not,",45],["it",45],["passed\nthe",45],["test.",45],["So",45],["far,",45],["no",45],["chatbot",45],["has",45],["passed",45],["the",45],["Turing",49],["test",49],["but",49],["we’ll",49],["get",49],["there.",49],["Traditionally,",51],["chatbots",51],["have",51],["used",51],["a",51],["retrieval\nbased",51],["model",51],["to",51],["communicate.",51],["In",51],["a",51],["retrieval",51],["based",54],["model,",54],["programmers",54],["code",54],["in",54],["a",54],["set",54],["of\npredefined",54],["responses",54],["and",54],["some",54],["kind",54],["of",54],["heuristic",54],["to",59],["pick",59],["the",59],["appropriate",59],["response",59],["based",59],["on\nthe",59],["input",59],["and",59],["context.",59],["The",59],["first",59],["chatbots",59],["were",63],["just",63],["rule-based",63],["expression",63],["matching.\nLike",63],["if",63],["I",63],["ask",63],["the",63],["exact",63],["phrase",63],["‘Will",63],["I",63],["ever",63],["get",66],["laid’,",66],["it",66],["responds",66],["’No’.",66],["Everytime.\nBut",66],["more",66],["recently",66],["companies",66],["have",66],["started",66],["using",66],["more",70],["complex",70],["heuristics,",70],["like",70],["using",70],["a",70],["machine\nlearning",70],["classifier.",70],["Facebook",70],["Messenger’s",70],["chatbot",74],["API",74],["is",74],["an",74],["example",74],["of",74],["this.",74],["You",74],["can\nhardcode",74],["responses",74],["to",74],["potential",74],["questions,",74],["and",78],["the",78],["system",78],["classifies",78],["words",78],["to",78],["understand\nintent.",78],["So",78],["you",78],["could",78],["either",78],["ask",78],["‘what",78],["day",78],["is",82],["it",82],["today’",82],["or",82],["‘today",82],["is",82],["what",82],["day?’\nand",82],["it",82],["would",82],["understand",82],["that",82],["both",82],["questions",82],["although",85],["worded",85],["differently",85],["have",85],["the",85],["same\nintent.",85],["The",88],["harder",88],["chatbot",88],["model",88],["is",88],["generative.",88],["These\ndon’t",88],["rely",88],["on",88],["any",88],["pre-defined",88],["responses,",88],["they",92],["generate",92],["them",92],["from",92],["scratch.",92],["2",92],["Google\nResearchers",92],["released",92],["a",92],["paper",92],["called",92],["A",92],["Neural",92],["Conversational",96],["Model,",96],["where",96],["they",96],["trained",96],["a\nneural",96],["network",96],["on",96],["2",96],["datasets",96],["to",96],["do",96],["this.",96],["First,",96],["on",100],["a",100],["movie",100],["dialogue",100],["dataset",100],["so",100],["that",100],["it",100],["would\nbe",100],["able",100],["to",100],["speak",100],["conversational",100],["english,",100],["and",100],["then",103],["on",103],["an",103],["IT",103],["support",103],["chatlog",103],["dataset",103],["so",103],["that\nit",103],["had",103],["domain",103],["knowledge.",103],["When",103],["they",103],["tested",103],["it",106],["on",106],["a",106],["real",106],["human",106],["asking",106],["for",106],["support",106],["help,\nit",106],["was",106],["remarkably",106],["efficient",106],["at",106],["helping",106],["them",106],["solve",110],["their",110],["problem.",110],["Without",110],["any",110],["hardcoded\nresponses.",110],["Just",110],["by",110],["giving",110],["it",110],["data",110],["and",110],["training",110],["it.",114],["Ok",114],["so",114],["what",114],["kind",114],["do",114],["we",114],["want",114],["to",114],["build?",114],["Well,\nwhen",114],["building",114],["a",114],["chatbot",114],["we",114],["have",114],["to",114],["think",114],["about",114],["possible",117],["constraints.",117],["Are",117],["we",117],["operating",117],["on\na",117],["closed",117],["domain",117],["or",117],["open",117],["domain?",117],["In",117],["an",117],["open",117],["domain,",121],["the",121],["conversation",121],["can",121],["go",121],["anywhere,\nthere",121],["are",121],["an",121],["infinite",121],["number",121],["of",121],["things",121],["of",121],["talk",125],["about.",125],["In",125],["a",125],["closed",125],["domain",125],["the",125],["conversation\nfocuses",125],["on",125],["a",125],["single",125],["subject.",125],["If",125],["we",125],["want",125],["to",125],["operate",129],["on",129],["an",129],["open",129],["domain",129],["using",129],["a",129],["generative\nmodel,",129],["that’s",129],["pretty",129],["much",129],["AGI",129],["so",129],["we’re",129],["not",133],["quite",133],["there",133],["yet.",133],["If",133],["we",133],["use",133],["an",133],["open",133],["domain\nwith",133],["a",133],["retrieval",133],["model,",133],["we’d",133],["have",133],["to",133],["hardcode",133],["literally",137],["everything",137],["so",137],["also",137],["impossible.",137],["So\nright",137],["now",137],["we",137],["can",137],["build",137],["a",137],["chatbot",137],["in",137],["a",137],["closed",137],["domain",141],["using",141],["either",141],["retrieval",141],["or",141],["generative\nmodels.",141],["Ok,",143],["let’s",143],["add",143],["in",143],["another",143],["constraint;",143],["do\nwe",143],["want",143],["it",143],["to",143],["have",143],["long",143],["or",143],["short",143],["conversations?",143],["Short",147],["conversations",147],["are",147],["easy,",147],["you",147],["just",147],["output\na",147],["single",147],["response",147],["to",147],["a",147],["single",147],["question.",147],["Long",147],["conversation",151],["are",151],["a",151],["bit",151],["harder,",151],["the",151],["AI",151],["has\nto",151],["keep",151],["track",151],["of",151],["what’s",151],["being",151],["said,",151],["that",151],["is",155],["the",155],["context,",155],["over",155],["a",155],["series",155],["of",155],["questions\nfrom",155],["the",155],["user.",155],["Support",155],["topics",155],["would",155],["be",155],["a",155],["good",155],["example",158],["of",158],["this.",158],["We",158],["could",158],["go",158],["the",158],["easy",158],["route\nand",158],["use",158],["a",158],["retrieval",158],["model",158],["if",158],["all",158],["we",158],["want",158],["is",158],["a",162],["bot",162],["to",162],["give",162],["us",162],["the",162],["local",162],["weather.",162],["But",162],["if\nwe",162],["want",162],["our",162],["bot",162],["to",162],["have",162],["a",162],["long",162],["conversation",162],["with",165],["us",165],["about",165],["the",165],["weather.",165],["like",165],["‘whats",165],["the\nweather",165],["in",165],["SF’",165],["‘is",165],["my",165],["family",165],["safe",165],["then’",165],["‘where",168],["can",168],["i",168],["find",168],["a",168],["new",168],["family’",168],["then",168],["we\nshould",168],["go",168],["for",168],["a",168],["generative",168],["model.",168],["We",168],["need",168],["lots",171],["of",171],["data",171],["to",171],["train",171],["our",171],["bot",171],["on",171],["a",171],["generative\nmodel",171],["like",171],["a",171],["big",171],["chatlog",171],["or",171],["a",171],["knowledge",171],["base.",171],["And",176],["when",176],["done",176],["well,",176],["that’s",176],["pretty",176],["much",176],["the\nbleeding",176],["edge.",176],["Which",178],["means",178],["that’s",178],["what",178],["we",178],["have",178],["to",178],["build.\nSo",178],["we’re",178],["going",178],["to",178],["re-create",178],["the",178],["results",178],["from",181],["the",181],["Neural",181],["Conversational",181],["Model",181],["paper\nusing",181],["the",181],["deep",181],["learning",181],["library",181],["Torch",181],["in",181],["the",181],["Lua",185],["programming",185],["language.",185],["Lua",185],["is",185],["super",185],["similar\nto",185],["Python",185],["except",185],["that",185],["it",185],["sounds",185],["super",185],["hawaiian.",185],["Ayyy",187],["lets",187],["use",187],["Lua.",187],["Let’s",187],["collect",187],["our",187],["data\nfirst.",187],["We’ll",187],["be",187],["using",187],["the",187],["the",187],["cornell",187],["movie",187],["dialogue",189],["dataset",189],["and",189],["we’ll",189],["set",189],["our",189],["variables\nfrom",189],["the",189],["command",189],["line",189],["to",189],["how",189],["much",189],["of",189],["the",189],["dataset",189],["we",193],["want",193],["to",193],["use",193],["and",193],["the",193],["minimum",193],["frequency",193],["of\nwords",193],["that",193],["we",193],["keep",193],["in",193],["the",193],["vocabulary.",193],["Our",193],["next",197],["step",197],["is",197],["to",197],["build",197],["the",197],["model.",197],["We’ll",197],["use\nour",197],["command",197],["line",197],["arguments",197],["to",197],["help",197],["determine",197],["the",201],["size",201],["of",201],["our",201],["model;",201],["the",201],["2",201],["variables",201],["being\nthe",201],["number",201],["of",201],["hidden",201],["layers",201],["and",201],["the",201],["word",201],["count",201],["of",204],["our",204],["dataset.",204],["In",204],["our",204],["case",204],["this",204],["will",204],["be",204],["a\nsequence",204],["to",204],["sequence",204],["model.",204],["A",204],["sequence",204],["to",204],["sequence",208],["model",208],["consists",208],["of",208],["2",208],["long",208],["short",208],["term\nmemory",208],["recurrent",208],["neural",208],["networks.",208],["The",208],["first",208],["neural",213],["net",213],["is",213],["an",213],["encoder.",213],["It",213],["processes",213],["the\ninput.",213],["The",213],["Second",213],["neural",213],["net",213],["is",213],["the",213],["decoder",213],["and",217],["it",217],["generates",217],["the",217],["output.",217],["So",219],["why",219],["the",219],["Sequence",219],["to",219],["Sequence",219],["model?",219],["Yes\nDeep",219],["Neural",219],["nets",219],["are",219],["awesome",219],["but",219],["they",219],["require",219],["the",223],["dimensionality",223],["of",223],["the",223],["inputs",223],["and",223],["outputs\nto",223],["be",223],["a",223],["fixed",223],["size.",223],["We’re",223],["accepting",223],["a",223],["sequence",223],["of",227],["words",227],["in",227],["a",227],["sentence",227],["and",227],["outputting",227],["a",227],["new\nsequence",227],["of",227],["words.",227],["So",227],["we",227],["need",227],["a",227],["sequence",227],["learning",227],["model",231],["that",231],["can",231],["learn",231],["on",231],["data",231],["with",231],["long",231],["range\nmemory",231],["dependencies.",231],["LSTM",231],["architecture",231],["is",231],["the",235],["natural",235],["choice.",235],["The",235],["encoder",235],["LSTM",235],["turns\nthe",235],["input",235],["sentence",235],["of",235],["variable",235],["length",235],["into",235],["a",239],["fixed",239],["dimensional",239],["vector",239],["representation.\nWe",239],["can",239],["think",239],["of",239],["this",239],["as",239],["a",239],["‘thought",239],["vector’.",239],["So,",243],["given",243],["a",243],["large",243],["enough",243],["dataset",243],["of",243],["questions\nand",243],["responses,",243],["it",243],["will",243],["recognize",243],["the",243],["‘closeness’",243],["of",247],["a",247],["set",247],["of",247],["questions",247],["and",247],["represent",247],["them",247],["as\na",247],["single",247],["thought",247],["vector.",247],["What",247],["time",247],["is",247],["it,",247],["whats",251],["the",251],["time,",251],["yo",251],["yo",251],["whats",251],["the",251],["time-izzle\nmy",251],["nizzle",251],["will",251],["all",251],["fall",251],["into",251],["a",251],["single",251],["thought",251],["vector.",254],["So",254],["after",254],["training,",254],["we’ll",254],["have",254],["a\nhuge",254],["set",254],["of",254],["not",254],["just",254],["synapse",254],["weights,",254],["but",254],["thought",258],["vectors",258],["as",258],["well.",258],["When",258],["we",258],["give",258],["it",258],["a\nnovel",258],["question,",258],["it’ll",258],["encode",258],["the",258],["sentence",258],["into",259],["the",259],["appropriate",259],["thought",259],["vector,",259],["then\nthe",259],["decoder",259],["will",259],["probabilistically",259],["generate",259],["the",259],["output",259],["sentence.",259],["Next",259],["well",259],["add",259],["in",259],["some",259],["hyperparameters.",259],["We\nwant",259],["to",259],["use",259],["the",259],["ClassNLLCriterion",259],["for",259],["our",259],["model.",263],["NLL",263],["stands",263],["for",263],["Negative",263],["Log",263],["Likelihood,\nthis",263],["will",263],["help",263],["us",263],["obtain",263],["log",263],["probabilities",263],["from",267],["our",267],["input",267],["data,",267],["which",267],["will",267],["help",267],["us",267],["improve\nour",267],["sentence",267],["predictions.",267],["The",267],["learning",267],["rate",267],["and",270],["momentum",270],["helps",270],["pace",270],["our",270],["timesteps,",270],["and\ndecayFactor",270],["and",270],["minMeanError",270],["help",270],["improve",270],["our",275],["learning",275],["rate",275],["while",275],["training.",275],["Then",275],["we’ll\nmake",275],["sure",275],["cuda",275],["is",275],["enabled",275],["and",275],["start",275],["training",275],["our",278],["model",278],["using",278],["backpropagation.",278],["In",278],["each",278],["epoch\nor",278],["run,",278],["we’ll",278],["declare",278],["our",278],["error",278],["and",278],["timer",278],["variables,",283],["then",283],["loop",283],["through",283],["each",283],["example\nin",283],["each",283],["batch.",283],["The",283],["default",283],["batch",283],["size",283],["is",283],["1000",283],["examples.",287],["For",287],["each",287],["of",287],["those",287],["examples,",287],["we’ll\nget",287],["the",287],["input",287],["sentence",287],["and",287],["the",287],["target",287],["sentence.",287],["We’ll",291],["use",291],["the",291],["input",291],["and",291],["the",291],["target",291],["as",291],["parameters\nto",291],["train",291],["our",291],["model.",291],["Then",291],["we’ll",291],["want",291],["to",291],["error",291],["check",295],["and",295],["make",295],["sure",295],["we",295],["record",295],["our",295],["progress.\nAt",295],["the",295],["end",295],["of",295],["each",295],["iteration,",295],["we",295],["save",295],["our",295],["model",298],["if",298],["it",298],["improved",298],["and",298],["update",298],["the",298],["learning\nrate.",298],["Boom!",301],["That’s",301],["it.",301],["After",301],["training",301],["this",301],["baby\non",301],["AWS",301],["we",301],["can",301],["have",301],["a",301],["conversation",301],["with",301],["it.",301],["The",305],["more",305],["you",305],["give",305],["it",305],["the",305],["better",305],["it",305],["will",305],["get.\nAlso",305],["if",305],["you’re",305],["gonna",305],["do",305],["this,",305],["add",305],["a",305],["filter",305],["for",308],["curse",308],["words.",308],["I’m",308],["looking",308],["at",308],["you",308],["Microsoft.\nThis",308],["will",308],["eventually",308],["automate",308],["a",308],["lot",308],["of",308],["support",308],["jobs",312],["away",312],["completely",312],["so",312],["if",312],["there",312],["are",312],["any",312],["government\npeople",312],["watching",312],["this",312],["—",312],["let’s",312],["get",312],["on",312],["that",312],["basic",317],["income",317],["jam",317],["ASAP.",317],["Unless",317],["you",317],["want",317],["a",317],["revolution.\nFor",317],["more",317],["info",317],["check",317],["out",317],["the",317],["links",317],["below",317],["and",317],["please",322],["subscribe",322],["for",322],["more",322],["ML",322],["videos.",322],["For",322],["now\ni’ve",322],["gotta",322],["go",322],["fix",322],["a",322],["memory",322],["leak,",322],["so",322],["thanks",322],["for",326],["watching",326],[":)",326]]}