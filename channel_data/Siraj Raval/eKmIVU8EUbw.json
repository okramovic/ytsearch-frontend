{"title":"Build a Movie Recommender - Machine Learning for Hackers #4","fromid":"eKmIVU8EUbw","words":[["hey",0],["Siri",0],["Any",0],["songs",0],["you",0],["recommend?\nThe",0],["Blacker",0],["the",0],["berry",0],["by",0],["Kendrick",0],["Lamar",0],["Good",4],["pick.",4],["Why",4],["that",4],["one?\nBecause",4],["f*ck",4],["the",4],["police",4],["Hello",6],["World",6],["welcome",6],["to",6],["Sirajology!",6],["In",6],["this\nepisode,",6],["we’re",6],["going",6],["to",6],["build",6],["a",6],["movie",6],["recommender",6],["system.",10],["Recommender",10],["systems",10],["are",10],["all",10],["around\nus,",10],["almost",10],["every",10],["single",10],["major",10],["service",10],["on",10],["the",10],["internet",14],["uses",14],["them",14],["to",14],["show",14],["you",14],["things",14],["that\nyou’d",14],["like",14],["based",14],["on",14],["your",14],["interests.",14],["",16],["",16],["Sometimes\nits",16],["so",16],["subtle",16],["you",16],["don’t",16],["even",16],["notice.",16],["They",18],["help",18],["personalize\ncontent",18],["on",18],["the",18],["Web,",18],["which",18],["makes",18],["users",18],["happy,",18],["which",21],["makes",21],["companies",21],["money.",21],["The",23],["two",23],["most",23],["ubiquitous",23],["types",23],["of",23],["recommender\nsystems",23],["are",23],["content",23],["based",23],["and",23],["collaborative.",23],["Content",28],["based",28],["systems",28],["focus",28],["on",28],["each",28],["user",28],["individually.\nIt",28],["looks",28],["at",28],["the",28],["items",28],["you’ve",28],["already",28],["expressed",28],["interest",32],["in",32],["(via",32],["‘likes’",32],["and",32],["‘ratings’)\nand",32],["records",32],["their",32],["keywords,",32],["attributes,",32],["and",32],["tags.",35],["Then",35],["your",35],["profile",35],["is",35],["gradually",35],["built\nwith",35],["these",35],["attributes.",35],["Once",35],["your",35],["profile",35],["is",35],["built,",38],["the",38],["system",38],["will",38],["start",38],["recommending\nitems",38],["you’d",38],["like",38],["with",38],["similar",38],["attributes",38],["to",41],["the",41],["ones",41],["you’ve",41],["already",41],["expressed",41],["interest\nin.",41],["So",41],["if",41],["you’re",41],["on",41],["an",41],["e-commerce",41],["site",41],["and",41],["you",44],["buy",44],["a",44],["bunch",44],["of",44],["Nickelback",44],["t-shirts,",44],["those\nitems",44],["will",44],["have",44],["tags",44],["like",44],["‘#worstbandever’",44],["and",47],["’stupid’.",47],["Based",47],["on",47],["that",47],["content,",47],["the\nsystem",47],["will",47],["suggest",47],["similarly",47],["tagged",47],["items",47],["for",51],["you,",51],["like",51],["‘creed",51],["t",51],["shirts’",51],["and",51],["‘wal-mart\nbrand",51],["guitars’.",51],["Then",53],["there",53],["are",53],["collaborative",53],["systems.",53],["These\nare",53],["the",53],["most",53],["ubiquitous",53],["type",53],["of",53],["recommender",53],["system.",56],["A",56],["collaborative",56],["system",56],["recommends\nyou",56],["items",56],["based",56],["on",56],["what",56],["other",56],["similar",56],["users",56],["have",59],["expressed",59],["interest",59],["in.",59],["It",59],["collaborates\nwith",59],["many",59],["users",59],["preferences",59],["to",59],["generate",59],["you",59],["a",61],["recommendation.",61],["So",61],["if",61],["you",61],["really",61],["like",61],["base\njumping",61],["and",61],["constantly",61],["buy",61],["base",61],["jumping",61],["gear",61],["online,",63],["the",63],["system",63],["will",63],["find",63],["users",63],["who",63],["have\nsimilar",63],["purchase",63],["history",63],["and",63],["ratings",63],["for",63],["those",63],["same",66],["products.",66],["Once",66],["its",66],["found",66],["those",66],["similar\nusers,",66],["it",66],["can",66],["recommend",66],["other",66],["items",66],["that",66],["they’ve",66],["bought",67],["that",67],["you",67],["haven’t.",67],["It’s",67],["likely",67],["that\nyou’ll",67],["be",67],["into",67],["those",67],["products",67],["as",67],["well.",67],["So",70],["we’re",70],["going",70],["to",70],["build",70],["an",70],["app",70],["that",70],["can\nrecommend",70],["movies",70],["you’d",70],["like",70],["in",70],["10",70],["lines",70],["of",74],["C++",74],["using",74],["Amazon’s",74],["newly",74],["released",74],["machine\nlearning",74],["library",74],["called",74],["Deep",74],["Scalable",74],["Sparse",74],["Tensor",77],["Network",77],["Engine,",77],["or",77],["Destiny.",77],["Sigh.",77],["We’ve\ngot",77],["to",77],["think",77],["of",77],["a",77],["better",77],["name",77],["guys.",77],["Our",77],["model",77],["will",81],["be",81],["a",81],["neural",81],["network",81],["because",81],["lets",81],["be",81],["real.\nThe",81],["more",81],["i",81],["learn",81],["about",81],["machine",81],["learning",81],["the",81],["more",83],["i",83],["realize",83],["just",83],["how",83],["much",83],["they",83],["outperform\nevery",83],["other",83],["model",83],["almost",83],["every",83],["time.",83],["Then",83],["we’re",86],["going",86],["to",86],["train",86],["it",86],["in",86],["the",86],["cloud",86],["using\nAWS",86],["because",86],["i",86],["aint",86],["got",86],["time",86],["to",86],["train",86],["this",86],["on",90],["my",90],["macbook.",90],["DSSTNE",90],["is",90],["what",90],["Amazon",90],["built\nfor",90],["production-use",90],["specifically",90],["to",90],["recommend",90],["products",93],["to",93],["customers",93],["that",93],["they",93],["might",93],["like.\nIt’s",93],["optimized",93],["for",93],["sparse",93],["data",93],["and",93],["multi-GPU",93],["computation.",97],["Data",97],["is",97],["sparse",97],["if",97],["it",97],["contains\na",97],["lot",97],["of",97],["zeroes,",97],["as",97],["in",97],["not",97],["a",97],["whole",97],["lot",97],["of",97],["valuable",100],["information.",100],["Recommendations",100],["usually\noperate",100],["on",100],["sparse",100],["data,",100],["not",100],["everything",100],["is",100],["connected,",104],["but",104],["you",104],["can",104],["manage",104],["to",104],["find",104],["some\nvaluable",104],["links",104],["between",104],["people",104],["and",104],["items.",104],["Most",104],["ML",107],["libraries",107],["implement",107],["data-parallel",107],["training,\nas",107],["in",107],["it",107],["splits",107],["the",107],["training",107],["data",107],["across",107],["multiple",107],["GPUs.",111],["This",111],["works,",111],["but",111],["there’s",111],["definitely\na",111],["tradeoff",111],["between",111],["speed",111],["and",111],["accuracy.",111],["DSSTNE",111],["uses",114],["model-parallel",114],["training,",114],["so",114],["instead",114],["of\nsplitting",114],["the",114],["data",114],["across",114],["multiple",114],["GPUs",114],["it",114],["splits",118],["the",118],["model",118],["across",118],["multiple",118],["GPUs.",118],["So\nall",118],["the",118],["layers",118],["are",118],["spread",118],["out",118],["across",118],["multiple",118],["GPUs",122],["on",122],["the",122],["same",122],["server",122],["automatically",122],["for\nyou.",122],["Amazon",122],["had",122],["to",122],["do",122],["this",122],["because",122],["the",122],["weight",122],["matrices",125],["it",125],["had",125],["for",125],["recommendations,",125],["that\nis",125],["all",125],["the",125],["mappings",125],["of",125],["users",125],["and",125],["attributes,",125],["just",129],["didn’t",129],["fit",129],["in",129],["the",129],["memory",129],["of",129],["a",129],["single\nGPU.",129],["When",129],["it",129],["comes",129],["to",129],["ML",129],["libraries,",129],["DSSTNE",129],["isn’t",132],["as",132],["general",132],["purpose",132],["as",132],["TensorFlow",132],["(no\nrecurrent",132],["net",132],["or",132],["LSTM",132],["capabilities",132],["yet)",132],["but",132],["it",134],["is",134],["twice",134],["as",134],["fast",134],["when",134],["it",134],["comes",134],["to",134],["dealing\nwith",134],["sparse",134],["data.",134],["So",137],["we’ll",137],["follow",137],["our",137],["methodology",137],["and",137],["collect\nour",137],["dataset,",137],["build",137],["the",137],["model,",137],["train",137],["the",137],["model,",137],["and",140],["test",140],["the",140],["model.",140],["Lets",140],["start",140],["off",140],["by",140],["collecting\nour",140],["dataset.",140],["We’ll",140],["initialize",140],["our",140],["helper",140],["class",141],["object",141],["and",141],["then",141],["call",141],["the",141],["retrieveDataset\nmethod",141],["with",141],["the",141],["parameter",141],["as",141],["the",141],["URL",141],["to",141],["our",141],["downloadable",143],["model.",143],["In",143],["our",143],["case,",143],["we’re",143],["going\nto",143],["use",143],["a",143],["sample",143],["MovieLens",143],["dataset",143],["which",143],["contains",143],["user",146],["ratings",146],["for",146],["a",146],["lot",146],["of",146],["different",146],["movies\nand",146],["their",146],["associated",146],["tags.",146],["Once",146],["we",146],["have",146],["that,",146],["we’ll",149],["want",149],["to",149],["convert",149],["it",149],["to",149],["a",149],["format",149],["our\nML",149],["library",149],["can",149],["read.",149],["In",149],["this",149],["case,",149],["its",149],["the",149],["NetCDF",153],["format.",153],["NetCDF",153],["is",153],["designed",153],["for",153],["efficient\nserialization",153],["of",153],["a",153],["large",153],["array",153],["of",153],["numbers",153],["and",156],["its",156],["what",156],["DSSTNE",156],["expects.",156],["We’ll",156],["generate\nit",156],["for",156],["both",156],["the",156],["input",156],["and",156],["output",156],["layer",156],["of",156],["our",159],["neural",159],["network",159],["and",159],["we’ll",159],["use",159],["the",159],["name\nof",159],["the",159],["downloaded",159],["dataset",159],["as",159],["our",159],["parameter.",159],["Both",162],["of",162],["these",162],["functions",162],["generate",162],["a",162],["NetCDF\nfile",162],[",",162],["an",162],["index",162],["file",162],["for",162],["neurons,",162],["and",162],["an",162],["index",162],["file",166],["for",166],["features.",166],["Once",166],["we’ve",166],["generated",166],["our",166],["model,",166],["it’s",166],["time\nto",166],["train",166],["our",166],["neural",166],["network.",166],["In",166],["DSSTNE,",166],["you",166],["build",170],["your",170],["model",170],["in",170],["a",170],["JSON",170],["file",170],["instead",170],["of\nprogrammatically.",170],["We",170],["can",170],["see",170],["in",170],["the",170],["config.json",170],["file",173],["the",173],["structure",173],["of",173],["the",173],["neural",173],["network.\nThis",173],["is",173],["where",173],["we",173],["set",173],["our",173],["hyper-parameters.",173],["The",176],["most",176],["important",176],["takeaway",176],["here",176],["is",176],["that",176],["we\nare",176],["creating",176],["a",176],["3",176],["layer",176],["feedforward",176],["neural",176],["network,",180],["(that",180],["means",180],["data",180],["just",180],["flows",180],["one",180],["way)\nwith",180],["one",180],["128",180],["node",180],["hidden",180],["layer",180],["and",180],["our",180],["activation",180],["function",184],["at",184],["each",184],["node",184],["is",184],["the",184],["classic",184],["sigmoid\n(which",184],["turns",184],["values",184],["into",184],["probabilities).",184],["We",184],["can",187],["go",187],["ahead",187],["and",187],["run",187],["our",187],["train",187],["function",187],["with\nthe",187],["batch",187],["size",187],["and",187],["number",187],["of",187],["epochs",187],["as",187],["the",187],["parameters.",191],["We’ll",191],["set",191],["the",191],["batch",191],["size",191],["or\nnumber",191],["of",191],["examples",191],["to",191],["256",191],["and",191],["the",191],["number",191],["of",191],["epochs",195],["or",195],["runs",195],["to",195],["10.",195],["Once",195],["we",195],["run",195],["this,",195],["it’ll\ncreate",195],["a",195],["newly",195],["trained",195],["model",195],["file",195],["called",195],["gl.nc",195],["which",198],["we",198],["can",198],["then",198],["use",198],["to",198],["predict",198],["recommendations.\nOur",198],["last",198],["step",198],["is",198],["to",198],["predict",198],["recommendations",198],["so",201],["we",201],["can",201],["just",201],["call",201],["the",201],["predict",201],["method",201],["and\nset",201],["the",201],["number",201],["of",201],["recommendations",201],["parameter",201],["to",204],["10.",204],["This",204],["will",204],["place",204],["the",204],["newly",204],["created",204],["predictions\nin",204],["the",204],["‘recs’",204],["file.",204],["That’s",207],["pretty",207],["much",207],["it",207],["for",207],["the",207],["code!",207],["Now\nthat",207],["we",207],["have",207],["our",207],["code",207],["ready",207],["to",207],["be",207],["compiled",207],["and",208],["run,",208],["we’ll",208],["want",208],["to",208],["upload",208],["it",208],["to",208],["AWS.\nAWS",208],["is",208],["Amazon’s",208],["cloud",208],["computing",208],["service",208],["and",210],["I’m",210],["just",210],["going",210],["to",210],["assume",210],["you’ve",210],["already\nsigned",210],["up",210],["for",210],["an",210],["AWS",210],["account.",210],["To",210],["start",210],["off",210],["we’ll",211],["click",211],["on",211],["the",211],["EC2",211],["button",211],["which",211],["will\ntake",211],["us",211],["to",211],["Amazon’s",211],["cloud",211],["computing",211],["service.",211],["Then",214],["we’ll",214],["want",214],["to",214],["make",214],["sure",214],["we’re",214],["in\nthe",214],["US",214],["East",214],["(North",214],["Virginia)",214],["region,",214],["since",214],["Amazon",217],["created",217],["a",217],["preconfigured",217],["image",217],["with\ndependencies",217],["like",217],["CUDA",217],["and",217],["OpenMPI",217],["already",217],["setup",220],["for",220],["us",220],["in",220],["that",220],["region.",220],["We’ll",220],["click\non",220],["AMIs",220],["under",220],["the",220],["images",220],["directory",220],["of",220],["the",220],["left",223],["sidebar",223],["and",223],["search",223],["for",223],["the",223],["instance",223],["called\n(ami-d6f2e6bc).",223],["It",223],["should",223],["pop",223],["up,",223],["and",223],["then",223],["we’ll",229],["click",229],["the",229],["blue",229],["launch",229],["button",229],["to",229],["spin\nup",229],["an",229],["instance",229],["using",229],["that",229],["image.",229],["Then",229],["it’ll",229],["show",232],["us",232],["a",232],["list",232],["of",232],["instance",232],["types.",232],["Since",232],["we\nwant",232],["to",232],["speed",232],["up",232],["training",232],["time,",232],["let’s",232],["go",232],["ahead",235],["and",235],["choose",235],["the",235],["GPU",235],["option",235],["here.",235],["Then\nwe’ll",235],["click",235],["'review",235],["and",235],["launch'",235],["and",235],["see",235],["the",238],["final",238],["page",238],["before",238],["we",238],["can",238],["launch",238],["our",238],["instance.\nEverything",238],["looks",238],["good",238],["to",238],["go,",238],["so",238],["let’s",238],["click",238],["launch.",241],["It’ll",241],["prompt",241],["you",241],["to",241],["create",241],["a",241],["new\nkey",241],["pair,",241],["go",241],["ahead",241],["and",241],["download",241],["it",241],["so",241],["you",241],["have",245],["it",245],["locally.",245],["This",245],["will",245],["help",245],["authorize\nyour",245],["machine",245],["to",245],["connect",245],["to",245],["AWS",245],["Now",248],["that",248],["we’ve",248],["successfully",248],["launched",248],["a",248],["GPU\ninstance",248],["on",248],["AWS.",248],["Now",248],["we",248],["need",248],["to",248],["upload",248],["our",248],["code",250],["to",250],["it",250],["and",250],["train",250],["it.",250],["I’m",250],["a",250],["fan",250],["of",250],["using\nFileZilla",250],["to",250],["upload",250],["files",250],["so",250],["let’s",250],["use",250],["that.",250],["I’ll",254],["click",254],["the",254],["site",254],["manager",254],["icon,",254],["then",254],["paste\nin",254],["my",254],["host",254],["name.",254],["I",254],["gotta",254],["sure",254],["I",254],["set",254],["my",254],["protocol",254],["to",258],["SFTP,",258],["then",258],["set",258],["my",258],["login",258],["type",258],["to",258],["normal\nand",258],["the",258],["user",258],["is",258],["called",258],["ubuntu.",258],["Once",258],["we’ve",258],["set",262],["the",262],["fields",262],["we",262],["can",262],["click",262],["connect",262],["and",262],["it’lll\nshow",262],["us",262],["all",262],["the",262],["current",262],["files",262],["in",262],["our",262],["instance.",262],["Let’s",265],["go",265],["ahead",265],["and",265],["drag",265],["and",265],["drop",265],["our",265],["project\ninto",265],["the",265],["root",265],["folder.",265],["Now",265],["that",265],["our",265],["code",265],["is",265],["in",268],["our",268],["EC2",268],["instance,",268],["we",268],["can",268],["open",268],["up",268],["terminal\nand",268],["SSH",268],["into",268],["it.",268],["We",268],["can",268],["find",268],["the",268],["ssh",268],["snippet",268],["for",272],["terminal",272],["under",272],["the",272],["instances",272],["section",272],["once\nwe",272],["click",272],["the",272],["connect",272],["button.",272],["Perfect,",272],["let’s",272],["just",275],["paste",275],["this",275],["baby",275],["right",275],["into",275],["terminal.\nBoom,",275],["we’re",275],["in.",275],["Let’s",275],["cd",275],["into",275],["our",275],["directory.",275],["Before",279],["we",279],["run",279],["our",279],["code",279],["we’ll",279],["need",279],["to",279],["do\n2",279],["things",279],["—",279],["add",279],["the",279],["MPICC",279],["and",279],["NVCC",279],["compilers",279],["to",283],["our",283],["PATH",283],["and",283],["make",283],["the",283],["library.",283],["We",283],["can",283],["export\nMPICC",283],["and",283],["then",283],["run",283],["make.",283],["Then",283],["we’ll",283],["export",283],["NVCC.",287],["Now",287],["we",287],["can",287],["run",287],["our",287],["script",287],["and",287],["once",287],["that’s\ndone,",287],["we’ll",287],["have",287],["recommendations",287],["in",287],["our",287],["recs",290],["folder.",290],["Let’s",290],["make",290],["sure",290],["they’re",290],["there.\nAwesome!",290],["These",290],["values",290],["map",290],["to",290],["movie",290],["IDs.",290],["That’s",291],["pretty",291],["much",291],["it!",291],["You",291],["can",291],["scale",291],["your\nneural",291],["net",291],["accordingly",291],["depending",291],["on",291],["the",291],["size",291],["of",294],["your",294],["data.",294],["Recommendation",294],["engines",294],["personalize\nthe",294],["experience",294],["for",294],["your",294],["users",294],["which",294],["has",294],["proven",294],["to",295],["enhance",295],["their",295],["experience",295],["and",295],["increases\ntheir",295],["satisfaction.",295],["In",295],["this",295],["age",295],["of",295],["AI,",295],["you",295],["can’t",295],["do",295],["without",295],["it.",295],["For",295],["more",295],["info",295],["check\nout",295],["the",295],["links",295],["down",295],["below",295],["and",295],["please",295],["subscribe",295],["for",297],["more",297],["machine",297],["learning",297],["videos,",297],["for",297],["now\nI’ve",297],["gotta",297],["go",297],["fix",297],["a",297],["runtime",297],["error",297],["so",297],["thanks",297],["for",299],["watching",299]]}