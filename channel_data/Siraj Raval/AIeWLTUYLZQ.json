{"title":"How to Win Slot Machines - Intro to Deep Learning #13","fromid":"AIeWLTUYLZQ","words":[["Hello,",0],["world,",0],["it's\n[?",0],["Siraj,",0],["?]",0],["and",0],["today",0],["we're",2],["going",2],["to",2],["implement",2],["a\npopular",2],["reinforcement",2],["learning",2],["technique",4],["called\nPolicy",4],["Gradients",4],["to",7],["help",7],["us",7],["choose",7],["which",7],["slot\nmachine",7],["to",7],["play",7],["that",7],["will",7],["give",10],["us",10],["the",10],["highest",10],["winnings.",10],["We've",14],["talked",14],["a",14],["good",14],["bit\nabout",14],["supervised",14],["learning.",14],["It's",17],["where",17],["we",17],["build",17],["an\nalgorithm,",17],["based",17],["on",17],["both",17],["input",17],["and",21],["output",21],["data,",21],["which",21],["is\ngreat",21],["for",21],["classification",21],["tasks.",21],["Unsupervised",25],["learning\nis",25],["when",25],["we",25],["don't",25],["have",27],["a",27],["history",27],["of",27],["outputs.",27],["We",29],["have",29],["to",29],["build",29],["an",29],["algorithm\nbased",29],["on",29],["input",29],["data",29],["alone.",29],["Reinforcement",32],["learning",32],["is\nsimilar",32],["in",32],["that",32],["it",32],["is",32],["also",32],["building",35],["an",35],["algorithm\nbased",35],["on",35],["input",35],["data",35],["alone,",35],["but",38],["we",38],["framed",38],["the",38],["problem\nin",38],["a",38],["different",38],["way.",38],["The",40],["algorithm",40],["presents",40],["a",40],["state\nthat",40],["depends",40],["on",40],["the",40],["input",40],["data",40],["and",44],["is",44],["either",44],["rewarded\nor",44],["punished",44],["via",44],["an",44],["action",44],["that",46],["it",46],["takes,",46],["and",46],["this\ncontinues",46],["over",46],["time.",46],["It",49],["learns",49],["from",49],["the\nreward",49],["or",49],["punishment",49],["and",51],["continually",51],["updates\nitself",51],["over",51],["the",51],["long",51],["term",51],["to",54],["maximize",54],["the",54],["reward.",54],["Reinforcement",56],["learning\ndoesn't",56],["get",56],["as",56],["much",56],["love",56],["these",58],["days,",58],["from",58],["the",58],["AI\ncommunity,",58],["as",58],["the",58],["other",58],["two",58],["do.",58],["Because",61],["some",61],["of",61],["the",61],["most\ninteresting",61],["problems",61],["right",63],["now,",63],["like",63],["those\nin",63],["speech",63],["recognition,",63],["NLP,",65],["and",65],["computer\nvision",65],["are",65],["areas",65],["where",67],["it's",67],["hard",67],["to",67],["define",67],["the\nnotion",67],["of",67],["a",67],["long-term",67],["reward.",67],["Don't",71],["hate--",71],["reinforce.",71],["Currently,",75],["the",75],["problems\nthat",75],["are",75],["best",75],["solved",75],["by",77],["reinforcement",77],["learning",77],["are\neither",77],["[INAUDIBLE]",77],["problems,",77],["like",80],["getting",80],["an",80],["NPC\nto",80],["get",80],["through",80],["a",80],["level",80],["without",82],["dying,",82],["or\nreally",82],["complex",82],["problems,",82],["like",85],["self-driving",85],["cars\nor",85],["folding",85],["laundry",85],["or",88],["understanding\nmy",88],["ex-girlfriend.",88],["Things",90],["that",90],["you",90],["could",90],["do",90],["in",90],["a\nsimulation,",90],["human",90],["level",90],["tasks.",90],["So",94],["a",94],["lot",94],["of",94],["the",94],["work",94],["in\nreinforcement",94],["learning",94],["is",96],["theoretical",96],["instead\nof",96],["application-based,",96],["which",99],["is",99],["just",99],["as",99],["important,\ndon't",99],["get",99],["me",99],["wrong.",99],["However,",102],["there",102],["are",102],["some\nreal",102],["world",102],["use",102],["cases",102],["today.",102],["Finnair,",105],["the",105],["flight-booking\ncompany,",105],["for",105],["example,",105],["uses",108],["RL",108],["to",108],["decide\nwhat",108],["action",108],["to",108],["take",108],["for",110],["what",110],["customers",110],["to\nincrease",110],["their",110],["lifetime",110],["value.",110],["And",113],["DeepMind",113],["reduced",113],["Google's\ncooling",113],["center",113],["bill",113],["by",113],["40%",113],["by",117],["using",117],["RL",117],["to",117],["decide",117],["the\nmost",117],["efficient",117],["energy",117],["routing",117],["strategy",120],["for",120],["the",120],["lowest",120],["costs.",120],["So",122],["let's",122],["take",122],["a",122],["look\nat",122],["our",122],["problem,",122],["which",122],["comes",124],["from",124],["probability",124],["theory.",124],["The",126],["problem",126],["is",126],["that",126],["a",126],["gambler,\nwhich",126],["we'll",126],["call",126],["our",126],["agent,",126],["has",129],["to",129],["decide",129],["which\nslot",129],["machine",129],["to",129],["play,",129],["how",132],["many",132],["times",132],["to\nplay",132],["each",132],["machine,",132],["and",134],["in",134],["which",134],["order",134],["to",134],["play",134],["them.",134],["Every",136],["time",136],["that",136],["a\nmachine",136],["is",136],["played,",136],["it",138],["outputs",138],["a",138],["reward\nvalue,",138],["which",138],["is",138],["randomly",138],["generated",141],["from",141],["a",141],["probability\ndistribution",141],["specific",141],["to",144],["that",144],["machine.",144],["The",145],["goal",145],["of",145],["the\ngambler",145],["is",145],["to",145],["maximize",145],["the",147],["sum",147],["total",147],["of",147],["rewards",147],["earned\nthrough",147],["a",147],["sequence",147],["of",147],["lever",147],["pulls.",151],["He",151],["iteratively",151],["plays\none",151],["lever",151],["per",151],["round",151],["and",154],["observes",154],["the",154],["associated\nreward",154],["to",154],["do",154],["this.",154],["This",157],["is",157],["called",157],["the\nMulti-armed",157],["Bandit",157],["Problem.",157],["The",159],["Bandit",159],["being",159],["the\nname",159],["of",159],["an",159],["old",159],["style",159],["slot",159],["machine",162],["with",162],["an",162],["arm,",162],["or",162],["several,\non",162],["the",162],["side",162],["that",162],["you",162],["pull",162],["down.",162],["The",166],["agent",166],["has",166],["to",166],["make",166],["a",166],["choice\nbetween",166],["using",166],["machines",166],["that",166],["are",169],["known",169],["to",169],["produce",169],["good\nresults,",169],["exploitation,",169],["and",172],["trying",172],["out",172],["new",172],["machines\nthat",172],["have",172],["unknown",172],["results",172],["but",174],["could",174],["give",174],["better",174],["results\nthan",174],["the",174],["others,",174],["exploration.",174],["Exploitation",178],["is\noptimizing",178],["decisions",178],["based",180],["on",180],["existing",180],["knowledge,\nand",180],["exploration",180],["is",180],["attempting",180],["to",183],["acquire",183],["new",183],["knowledge.",183],["It's",185],["a",185],["trade",185],["off",185],["that",185],["all\nreinforcement",185],["learning",185],["agents",185],["make",188],["when",188],["optimizing\nfor",188],["a",188],["reward",188],["value,",188],["and",191],["it's",191],["particularly\nrelevant",191],["in",191],["this",191],["problem.",191],["So",194],["let's",194],["start\ninitializing",194],["some",194],["values.",194],["After",196],["importing",196],["TensorFlow\nand",196],["Numpy,",196],["the",196],["only",196],["two",196],["libraries",199],["we'll",199],["need",199],["to",199],["use,\nwe",199],["can",199],["define",199],["our",199],["bandits.",199],["We'll",202],["be",202],["using",202],["a\nfour-armed",202],["bandit.",202],["That",204],["is",204],["one",204],["slot",204],["machine\nwith",204],["four",204],["levers,",204],["and",207],["we",207],["can",207],["refer",207],["to\neach",207],["arm",207],["as",207],["a",207],["bandit.",207],["So",209],["we'll",209],["define",209],["our",209],["bandits",209],["as\na",209],["list,",209],["and",209],["each",209],["of",209],["these",209],["values",209],["will",213],["help",213],["decide",213],["if",213],["a\nreward",213],["is",213],["given",213],["when",213],["pulled.",213],["The",215],["lower",215],["the",215],["bandit\nnumber,",215],["the",215],["more",215],["likely",215],["we'll",217],["get",217],["a",217],["positive",217],["reward.",217],["The",218],["higher",218],["the",218],["bandit\nnumber,",218],["the",218],["more",218],["likely",220],["we'll",220],["get\na",220],["negative",220],["reward.",220],["We",222],["want",222],["our",222],["agent",222],["to\nchoose",222],["the",222],["bandit",222],["that",222],["will",224],["give",224],["that",224],["reward,",224],["and\nwill",224],["initialize",224],["a",224],["variable",224],["for",227],["storing",227],["the",227],["total",227],["number.",227],["Well,",229],["next",229],["it",229],["find",229],["a",229],["pull\nbandit",229],["function,",229],["which",229],["given",232],["a",232],["bandit",232],["value,",232],["will\nfirst",232],["generate",232],["a",232],["random",232],["number",232],["from",234],["a",234],["normal",234],["distribution\nwith",234],["a",234],["mean",234],["of",234],["zero.",234],["Then",237],["compare",237],["the",237],["parameter\nvalue",237],["to",237],["the",237],["generated",237],["number.",237],["Depending",240],["on",240],["the\nresult,",240],["it",240],["will",240],["either",240],["return",242],["a",242],["positive\nor",242],["negative",242],["reward.",242],["In",245],["practice,",245],["this\nmodel",245],["is",245],["used",245],["any",245],["time",245],["you",247],["have",247],["a",247],["project\nwith",247],["a",247],["fixed",247],["budget.",247],["It",249],["can",249],["be",249],["used",249],["to",249],["help",249],["best\nallocate",249],["resources",249],["to",249],["maximize",249],["success,",253],["since",253],["it's\nspecifically",253],["designed",253],["to",255],["deal",255],["with",255],["the",255],["uncertainty\nabout",255],["the",255],["difficulty",255],["and",257],["payoff",257],["of",257],["each",257],["possibility.",257],["I",259],["wish",259],["I",259],["had",259],["this\nthing",259],["in",259],["college.",259],["Our",261],["agent",261],["needs",261],["to",261],["learn\nwhich",261],["kind",261],["of",261],["reward",261],["it",263],["gets",263],["for",263],["each\npossible",263],["action,",263],["so",265],["that",265],["it",265],["can",265],["choose\nthe",265],["optimal",265],["ones.",265],["It's",267],["learning",267],["a",267],["policy.",267],["So",269],["we're",269],["going",269],["to",269],["use\na",269],["popular",269],["method",269],["called",269],["Policy",271],["Gradients",271],["to",271],["solve",271],["this.",271],["We'll",273],["use",273],["a",273],["simple\nneural",273],["net",273],["that",273],["learns",275],["a",275],["policy",275],["for\npicking",275],["the",275],["best",275],["actions",275],["and",277],["adjusting",277],["its",277],["weights\nthrough",277],["gradient",277],["descent,",277],["using",279],["real",279],["time",279],["feedback\nfrom",279],["the",279],["environment.",279],["Since",282],["we're",282],["only\nusing",282],["a",282],["single",282],["bandit,",282],["our",284],["agent",284],["ignores",284],["the\nstate",284],["of",284],["the",284],["environment,",284],["just",287],["like",287],["the",287],["US",287],["government.",287],["There's",288],["only",288],["ever",288],["a\nsingle",288],["unchanging",288],["state.",288],["If",291],["we",291],["were",291],["introducing\nmultiple",291],["bandits,",291],["then",293],["our",293],["agent",293],["would",293],["need\nto",293],["take",293],["state",293],["into",293],["account",293],["when",296],["deciding",296],["an",296],["action.",296],["We",298],["would",298],["learn",298],["a",298],["value\nfunction",298],["instead,",298],["but",300],["let's",300],["keep",300],["it",300],["simple\nwith",300],["a",300],["single",300],["state.",300],["Reinforce!",303],["Learn",305],["the",305],["policy.",305],["So",307],["actions",307],["are",307],["quality.",307],["Our",309],["policy",309],["gradient",309],["network\nconsists",309],["of",309],["a",309],["set",309],["of",309],["weights,",309],["and",312],["each",312],["weight",312],["corresponds\nto",312],["each",312],["of",312],["the",312],["possible",312],["arms",312],["to",316],["pull,",316],["and",316],["represents",316],["how\nbeneficial",316],["our",316],["agent",316],["thinks",316],["it",319],["is",319],["to",319],["pull",319],["each",319],["arm.",319],["We'll",320],["initialize\nthe",320],["weights",320],["to",320],["one,",320],["which",322],["means",322],["our",322],["agent",322],["will\nbe",322],["optimistic",322],["about",322],["each",322],["arms",322],["potential",325],["reward.",325],["When",326],["we",326],["update\nour",326],["network,",326],["we'll",326],["use",328],["what's",328],["called",328],["an\nEpsilon",328],["Greedy",328],["Policy.",328],["This",330],["is",330],["a",330],["way",330],["of\nselecting",330],["random",330],["actions",330],["with",332],["uniform",332],["distributions",332],["from\na",332],["set",332],["of",332],["available",332],["actions.",332],["Using",336],["this",336],["policy,",336],["either\nwe",336],["can",336],["select",336],["random",336],["actions",336],["with",339],["epsilon",339],["probability,\nor",339],["we",339],["can",339],["select",339],["an",339],["action",339],["with",342],["one",342],["minus",342],["epsilon\nprobability",342],["that",342],["gives",342],["maximum",342],["reward",344],["in",344],["a",344],["given",344],["state.",344],["We'll",346],["define",346],["epsilon",346],["as",346],["0.1.",346],["It's",347],["the",347],["chance",347],["of\ntaking",347],["a",347],["random",347],["action.",347],["Basically,",349],["most",349],["of\nthe",349],["time,",349],["our",349],["agent",349],["will",351],["choose",351],["the",351],["action",351],["that\ncorresponds",351],["to",351],["the",351],["largest",351],["expected",354],["value,",354],["but",354],["sometimes,\nwith",354],["e-probability,",354],["it",354],["will",357],["choose",357],["randomly.",357],["So",359],["this",359],["way,",359],["it",359],["can\ntry",359],["out",359],["different",359],["arms",359],["to",361],["continue",361],["learning",361],["about",361],["them.",361],["Our",363],["agent",363],["is",363],["the",363],["neural",363],["network.",363],["It's",364],["feed",364],["forward",364],["and",364],["only\nhas",364],["one",364],["set",364],["of",364],["weights.",364],["We'll",368],["initialize\nthem",368],["as",368],["a",368],["tensor,",368],["where",369],["each",369],["is",369],["a",369],["set",369],["of",369],["one\nfor",369],["the",369],["number",369],["of",369],["bandits.",369],["Then,",372],["we'll",372],["use\nthe",372],["argmax",372],["function",372],["to",374],["choose",374],["the",374],["weight\nwith",374],["the",374],["highest",374],["value",374],["and",376],["store",376],["that",376],["as\nour",376],["chosen",376],["action.",376],["We",378],["now",378],["need",378],["to",378],["establish",378],["what\nthis",378],["training",378],["process",378],["looks",378],["like.",381],["Since",382],["we",382],["want",382],["to",382],["feed",382],["the\nreward",382],["and",382],["chosen",382],["action",382],["into",384],["the",384],["network",384],["to\ncompute",384],["the",384],["loss,",384],["and",386],["then",386],["use",386],["that",386],["to\nupdate",386],["the",386],["network,",386],["we'll",388],["initialize\ntensorflow",388],["placeholders",388],["for",390],["both",390],["the",390],["reward\nand",390],["the",390],["action",390],["values.",390],["Next,",393],["we'll",393],["define",393],["the\nresponsible",393],["weights.",393],["It",395],["corresponds",395],["to",395],["the\nunits",395],["in",395],["the",395],["output",395],["layer,",397],["which",397],["corresponded\nto",397],["the",397],["chosen",397],["action.",397],["When",400],["updating",400],["the\npolicy,",400],["we",400],["want",400],["to",402],["update",402],["the",402],["likelihood\nof",402],["the",402],["actions",402],["we",404],["actually",404],["took,",404],["as",404],["opposed\nto",404],["all",404],["possible",404],["actions.",404],["So",407],["this",407],["will",407],["be",407],["a\nslice",407],["of",407],["our",407],["weights,",407],["and",410],["we",410],["can",410],["define",410],["the\nsize",410],["of",410],["it",410],["as",410],["well.",410],["So",412],["this",412],["is",412],["what",412],["our",412],["policy\nloss",412],["equation",412],["looks",412],["like.",412],["This",415],["is",415],["what",415],["we\nwant",415],["to",415],["minimize.",415],["This",417],["character",417],["is",417],["the",417],["policy,\nwhich",417],["we",417],["take",417],["a",417],["log",417],["of,",417],["and",420],["A",420],["is",420],["the",420],["advantage.",420],["This",422],["is",422],["a",422],["critical",422],["part",422],["of",422],["RL.",422],["It's",424],["a",424],["measure",424],["of",424],["how\nmuch",424],["better",424],["an",424],["action",424],["was",424],["than",427],["some",427],["baseline.",427],["There",428],["are",428],["different",428],["ways",428],["of\ndeciding",428],["what",428],["that",428],["baseline",428],["is,",428],["and",432],["it",432],["can",432],["get\npretty",432],["interesting.",432],["But",435],["right",435],["now,",435],["we'll\njust",435],["set",435],["it",435],["to",435],["zero,",435],["so",437],["we",437],["can",437],["just",437],["think",437],["of\nit",437],["as",437],["just",437],["the",437],["reward",437],["we",439],["receive",439],["for",439],["each",439],["action.",439],["This",441],["loss",441],["function",441],["lets\nus",441],["increase",441],["the",441],["weight",441],["for",443],["actions",443],["that",443],["give",443],["a\npositive",443],["reward",443],["value,",443],["and",446],["decrease",446],["them\nfor",446],["actions",446],["that",446],["give",447],["a",447],["negative",447],["reward",447],["value.",447],["When",449],["we",449],["define",449],["our",449],["loss\nfunction",449],["programmatically,",449],["we",451],["can",451],["see",451],["that",451],["it\ncorresponds",451],["to",451],["the",451],["equation",451],["where",454],["reward",454],["holder\nis",454],["the",454],["advantage.",454],["We",456],["can",456],["then",456],["optimize",456],["it",456],["with\ngradient",456],["descent",456],["and",456],["a",456],["given",456],["learning",459],["rate.",459],["When",460],["we",460],["minimize",460],["our",460],["loss,",460],["it\nwill",460],["return",460],["a",460],["gradient",460],["update.",460],["So",463],["for",463],["our",463],["training",463],["step,\nwe'll",463],["initialize",463],["a",463],["tf",463],["graph,",463],["and",466],["then",466],["for",466],["a",466],["given\nnumber",466],["of",466],["episodes,",466],["we'll",468],["either",468],["try",468],["a",468],["random\naction",468],["or",468],["choose",468],["one",468],["from",471],["our",471],["network,",471],["exploitation\nversus",471],["exploration.",471],["We'll",474],["receive",474],["a",474],["reward\nfrom",474],["our",474],["action",474],["of",474],["picking",474],["one",476],["of",476],["their",476],["bandits.",476],["Then,",477],["we'll",477],["update",477],["the\nnetwork",477],["using",477],["our",477],["gradients,",477],["weight",480],["values",480],["relevant",480],["to",480],["the\naction,",480],["and",480],["all",480],["weight",480],["values.",480],["We",483],["can",483],["use",483],["a",483],["feed",483],["dict",483],["to",483],["fit",483],["in\nboth",483],["the",483],["action",483],["and",483],["the",483],["reward.",483],["We'll",487],["want",487],["to",487],["see\nwhich",487],["reward",487],["and",487],["which",487],["bandit",489],["we",489],["are",489],["on\nduring",489],["each",489],["iteration,",489],["so",491],["we'll",491],["print",491],["them",491],["out.",491],["When",492],["we",492],["compile",492],["this,",492],["we",492],["can\nsee",492],["that",492],["bandit",492],["four's",492],["values",492],["increase",496],["way",496],["faster\nthan",496],["the",496],["other",496],["ones.",496],["It",498],["decides",498],["one",498],["is",498],["best,\nand",498],["then",498],["goes",498],["all",498],["in",498],["on",498],["it.",498],["We",501],["can",501],["extend",501],["this\ncode",501],["later",501],["on,",501],["so",503],["that",503],["both",503],["state\nand",503],["action",503],["effect",503],["reward,",505],["which\nwould",505],["be",505],["considered",505],["the",506],["contextual",506],["bandit",506],["problem.",506],["So",508],["let's",508],["go",508],["over\nwhat",508],["we've",508],["learned.",508],["Reinforcement\nlearning",510],["is",510],["usually",510],["applied",512],["to",512],["toy",512],["problems",512],["or\nreally",512],["complex",512],["problems.",512],["Policy",515],["Gradient",515],["methods\nare",515],["a",515],["type",515],["of",515],["RL",515],["technique",515],["that",519],["optimizes",519],["a\npolicy",519],["with",519],["respect",519],["to",521],["the",521],["expected",521],["long-term\nreturn",521],["using",521],["gradient",521],["descent.",521],["And",525],["we",525],["can",525],["apply",525],["this",525],["strategy\nto",525],["the",525],["popular",525],["Multi-arm",525],["Bandit",525],["Problem,",528],["which",528],["asks\nhow",528],["to",528],["best",528],["allocate",528],["resources",530],["to",530],["maximize",530],["success.",530],["The",533],["coding",533],["challenge",533],["winner",533],["for\nthis",533],["video",533],["is",533],["Mike",533],["McDermott.",533],["Mike",536],["improved",536],["the",536],["bleeding\nedge",536],["memory",536],["network",536],["model",536],["from",539],["my",539],["last",539],["video",539],["to\ncreate",539],["a",539],["Q&A",539],["chatbot",539],["by",542],["adding",542],["a",542],["bi-directional\nLSTM",542],["and",542],["time",542],["distributed",542],["dense",545],["layer",545],["to",545],["it.",545],["This",546],["is",546],["seriously",546],["amazing",546],["stuff.",546],["He",548],["could",548],["publish",548],["his",548],["results",548],["to\na",548],["journal,",548],["Wizard",548],["of",548],["the",548],["Week.",548],["And",551],["the",551],["runner",551],["up\nis",551],["Vishal",551],["Batchu,",551],["who",553],["also",553],["had\npublishable",553],["results,",553],["and",554],["you",554],["can",554],["run",554],["his",554],["code\nright",554],["from",554],["the",554],["command",554],["line.",554],["You",557],["guys",557],["blew",557],["my",557],["mind,\nand",557],["I",557],["bow",557],["to",557],["you.",557],["The",560],["coding",560],["challenge\nfor",560],["this",560],["week",560],["is",561],["to",561],["use",561],["policy",561],["gradients",561],["to\nsolve",561],["the",561],["contextual",561],["bandit",561],["problem.",564],["So",565],["state",565],["is",565],["taken",565],["into",565],["account.",565],["Details",567],["are",567],["in",567],["the\nread",567],["me,",567],["github",567],["links",567],["go",569],["in",569],["the",569],["comments,\nand",569],["winners",569],["are",569],["going",569],["to",571],["be",571],["announced",571],["next",571],["week.",571],["Please",572],["subscribe,\nand",572],["for",572],["now,",572],["I've",572],["got",574],["to",574],["maximize",574],["my",574],["arm",574],["size,\nso",574],["thanks",574],["for",574],["watching.",574]]}