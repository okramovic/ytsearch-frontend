{"title":"How to Generate Images - Intro to Deep Learning #14","fromid":"3-UDwk1U77s","words":[["(siraj",0],["raval)",0],["Hello,",0],["world.\n",0],["It's",1],["Siraj.\n",1],["And",1],["what",1],["happens",1],["when",1],["we\nencounter",1],["data",1],["with",1],["no",1],["labels?",1],["Can",5],["we",5],["still",5],["learn",5],["from",5],["it?\n",5],["We're",7],["going",7],["to",7],["use",7],["a\nreally",7],["cool",7],["model",7],["called",7],["a",9],["variational\nautoencoder",9],["to",9],["generate",9],["unique",12],["images",12],["after",12],["training\non",12],["a",12],["collection",12],["of",12],["images",12],["with",15],["no",15],["labels.\n",15],["Most",16],["of",16],["the",16],["recent\nsuccesses",16],["in",16],["deep",16],["learning",16],["have",19],["been",19],["due",19],["to\nour",19],["ability",19],["to",19],["train",19],["neural",20],["networks",20],["on",20],["huge",20],["sets\nof",20],["cleanly",20],["labeled",20],["data.",20],["So",24],["if",24],["you",24],["have",24],["a",24],["set",24],["of",24],["inputs\nand",24],["their",24],["respective",24],["target",24],["labels,",27],["you",27],["can",27],["try",27],["and\nlearn",27],["the",27],["probability",27],["of",29],["a",29],["particular",29],["label\nfor",29],["a",29],["particular",29],["input.",29],["Intuitively,",32],["this",32],["makes",32],["sense.\n",32],["We're",34],["just",34],["learning\na",34],["mapping",34],["of",34],["values.",34],["But",36],["the",36],["hottest",36],["area\nof",36],["research",36],["right",36],["now",38],["is",38],["learning",38],["from\nthe",38],["raw,",38],["unlabeled",38],["data",38],["that",41],["the",41],["world",41],["is",41],["absolutely\nbrimming",41],["with,",41],["unsupervised",41],["learning.\n",44],["One",44],["type",44],["of",44],["model",44],["that",44],["can",44],["do\nthis",44],["is",44],["called",44],["an",44],["autoencoder.",44],["Autoencoders",48],["sequentially\nde-construct",48],["input",48],["data",48],["into",51],["hidden\nrepresentations,",51],["then",51],["use",53],["those",53],["same",53],["representations\nto",53],["sequentially",53],["reconstruct",53],["outputs",56],["that",56],["resemble\ntheir",56],["originals.",56],["Autoencoding",59],["is",59],["considered",59],["a\ndata",59],["compression",59],["algorithm,",59],["but",61],["they're",61],["data",61],["specific.\n",61],["So",63],["it",63],["can",63],["only",63],["compress\ndata",63],["similar",63],["to",63],["what",63],["it's",66],["been",66],["trained",66],["on.\n",66],["They're",67],["also",67],["relatively",67],["lossy.\n",67],["So",68],["the",68],["decompressed",68],["outputs\nwill",68],["be",68],["a",68],["bit",68],["degraded",68],["compared",68],["to",72],["the",72],["original",72],["inputs.\n",72],["Usually",73],["a",73],["well",73],["known\ncompression",73],["algorithm",73],["like",73],["jpeg",73],["does",76],["better.\n",76],["So",77],["what",77],["are",77],["they",77],["useful",77],["for?\n",77],["Absolutely",78],["nothing.\n",78],["Just",80],["kidding.\n",80],["One",81],["major",81],["use",81],["case\nis",81],["data",81],["denoising",81],["where",83],["we",83],["train",83],["an\nautoencoder",83],["to",83],["reconstruct",83],["the",86],["input",86],["from",86],["a\ncorrupted",86],["version",86],["of",86],["it",86],["so",88],["that",88],["given",88],["some",88],["similar\ndata",88],["that's",88],["corrupted,",88],["it",91],["can",91],["denoise",91],["it.\n",91],["Another",92],["is",92],["to",92],["generate\nsimilar",92],["but",92],["unique",92],["data,",92],["which",92],["is",95],["what",95],["we'll",95],["do.\n",95],["There",97],["are",97],["a",97],["bunch",97],["of\ndifferent",97],["autoencoder",97],["types,",97],["and",99],["each",99],["has",99],["its",99],["own",99],["unique\nimplementation",99],["details.",99],["But",102],["let's",102],["dive",102],["into",102],["one",102],["I\nfind",102],["particularly",102],["interesting,",102],["the",106],["variational\nautoencoder,",106],["or",106],["VAE.",106],["While",109],["deep",109],["learning\nis",109],["a",109],["great",109],["way",109],["to",110],["approximate\ncomplex",110],["functions,",110],["Bayesian",112],["inference\noffers",112],["a",112],["unique",112],["framework",112],["to",115],["reason",115],["about",115],["uncertainty.\n",115],["It's",117],["an",117],["approach",117],["to\nstatistics",117],["in",117],["which",117],["all",119],["forms",119],["of",119],["uncertainty\nare",119],["expressed",119],["in",121],["terms",121],["of",121],["probability.\n",121],["At",123],["any",123],["time",123],["there\nis",123],["the",123],["evidence",123],["for",124],["and",124],["against",124],["something,\nwhich",124],["leads",124],["to",124],["a",124],["probability,",124],["a",127],["chance",127],["that",127],["it",127],["is",127],["true.\n",127],["When",129],["you",129],["learn\nsomething",129],["new,",129],["you",129],["have",131],["to",131],["fold",131],["this",131],["new",131],["evidence\ninto",131],["what",131],["you",131],["already",131],["know",131],["to",133],["create",133],["a",133],["new",133],["probability.\n",133],["Bayesian",135],["theory",135],["describes\nthis",135],["process",135],["mathematically.",135],["The",143],["idea",143],["for",143],["the",143],["VAE",143],["came\nwhen",143],["these",143],["two",143],["ideas",143],["merged.",143],["So",147],["looking",147],["at",147],["it",147],["through\na",147],["Bayesian",147],["likeness,",147],["we",149],["treat",149],["the",149],["inputs,\nhidden",149],["representations,",149],["and",152],["reconstructed\noutputs",152],["of",152],["a",152],["VAE",152],["as",155],["probabilistic,\nrandom",155],["variables",155],["within",157],["a",157],["directed\ngraphical",157],["model.",157],["So",159],["it",159],["contains",159],["a",159],["specific\nprobability",159],["model",159],["of",159],["some",159],["data,",159],["x,",162],["and",162],["latent",162],["or\nhidden",162],["variables,",162],["z.",162],["We",165],["could",165],["write",165],["out\nthe",165],["joint",165],["probability",165],["of",167],["the",167],["model",167],["this",167],["way.\n",167],["Given",168],["just",168],["a",168],["character\nproduced",168],["by",168],["the",168],["model,",168],["we",171],["don't",171],["know",171],["which",171],["setting\nof",171],["the",171],["latent",171],["variables",171],["generated",173],["the",173],["characters.\n",173],["We've",175],["built",175],["variation\ninto",175],["our",175],["model.",175],["It's",178],["inherently",178],["stochastic.\n",178],["Looking",180],["at",180],["it",180],["through\na",180],["deep",180],["learning",180],["lens,",180],["a",182],["VAE",182],["consists",182],["of",182],["an",182],["encoder,\ndecoder,",182],["and",182],["loss",182],["function.",182],["So",186],["given",186],["some",186],["input",186],["x--\n",186],["let's",187],["say",187],["we've",187],["got",187],["28\nby",187],["28",187],["handwritten",187],["digit",187],["image,",190],["which",190],["is",190],["784\ndimensions",190],["where",190],["each",192],["pixel",192],["is",192],["one",192],["dimension.\n",192],["It",194],["will",194],["encode",194],["it",194],["into",194],["a",194],["latent\nor",194],["hidden",194],["representation",194],["space,",194],["which",197],["is",197],["way",197],["less",197],["than",197],["784.\n",197],["We",199],["can",199],["then",199],["sample",199],["from",199],["a\nGaussian",199],["probability",199],["density",199],["to",202],["get",202],["noisy",202],["values",202],["of\nthe",202],["representations.",202],["Let's",204],["start",204],["writing",204],["this\nout",204],["programmatically.",204],["After",206],["importing",206],["the\nlibraries",206],["and",206],["finding",206],["our",208],["hyperparameters,",208],["we'll\ninitialize",208],["our",208],["encoder",208],["network.",208],["Its",212],["job",212],["is",212],["to",212],["map",212],["inputs",212],["to",212],["our\nlatent",212],["distribution",212],["parameters.",212],["We'll",215],["take",215],["the",215],["input\ndata",215],["and",215],["send",215],["it",215],["through",217],["a",217],["dense\nfully",217],["connected",217],["layer",217],["with",219],["our",219],["choice",219],["of",219],["non-linearity\nto",219],["squash",219],["dimensionality,",219],["which",223],["will",223],["be",223],["ReLU.\n",223],["Then",224],["we",224],["convert",224],["the",224],["input\ndata",224],["into",224],["two",224],["parameters",224],["in",227],["a",227],["latent",227],["space.\n",227],["We",228],["predefine",228],["the",228],["size",228],["using\ndense,",228],["fully",228],["connected",228],["layers,",228],["again",232],["z",232],["mean",232],["and",232],["z",232],["log",232],["sigma.\n",232],["The",234],["decoder",234],["takes\nthe",234],["z",234],["as",234],["its",234],["input",234],["and",236],["outputs",236],["the",236],["parameters",236],["to\nthe",236],["probability",236],["distribution",236],["of",239],["the",239],["data.\n",239],["Let's",240],["say",240],["each",240],["pixel\nis",240],["either",240],["1",240],["or",240],["0",240],["since",243],["it's",243],["black",243],["and",243],["white.\n",243],["We",244],["can",244],["use",244],["a\nBernoulli",244],["distribution",244],["since",246],["it",246],["defines",246],["a\nsuccess",246],["as",246],["a",246],["binary",246],["value",246],["to",249],["represent",249],["a",249],["single",249],["pixel.\n",249],["So",251],["the",251],["decoder",251],["gets",251],["the",251],["latent\nrepresentation",251],["of",251],["a",251],["digit",251],["as",254],["input",254],["and",254],["outputs",254],["784\nBernoulli",254],["parameters,",254],["one",258],["for",258],["each",258],["of",258],["the",258],["pixels.\n",258],["We're",260],["going",260],["to",260],["use",260],["these\ntwo",260],["variables",260],["we",260],["have",260],["here",260],["to",263],["randomly",263],["sample",263],["new",263],["similar\npoints",263],["from",263],["the",263],["latent",263],["normal",263],["distribution",267],["by",267],["defining\na",267],["sampling",267],["function.",267],["Epsilon",270],["refers",270],["to",270],["a\nrandom",270],["normal",270],["tensor.",270],["Once",273],["we",273],["have",273],["z,",273],["we",273],["can\nfeed",273],["it",273],["to",273],["our",273],["decoder.",273],["The",276],["decoder",276],["will",276],["map",276],["these\nlatent",276],["space",276],["points",276],["back",276],["to",279],["the",279],["original",279],["input",279],["data.\n",279],["We'll",281],["initialize",281],["it",281],["with\ntwo",281],["fully",281],["connected",281],["layers",281],["and",284],["their",284],["own",284],["respective\nactivation",284],["functions.",284],["And",287],["because",287],["the\ndata",287],["is",287],["extracted",287],["from",289],["a",289],["small",289],["dimensionality\nto",289],["a",289],["larger",289],["one,",289],["some",289],["of",289],["it",289],["is",292],["lost",292],["in",292],["the\nreconstruction",292],["process.",292],["But",295],["how",295],["much?\n",295],["We",296],["need",296],["a",296],["measure",296],["of",296],["this,",296],["and\nthat",296],["will",296],["be",296],["our",296],["loss",296],["function.",296],["I",300],["want",300],["a",300],["generation\ndata",300],["unpredictably,",300],["and",305],["so",305],["my",305],["model",305],["is\nstochastic",305],["probability.",305],["For",311],["a",311],["VAE,",311],["the",311],["loss\nfunction",311],["looks",311],["like",311],["this.",311],["The",314],["first",314],["term",314],["measures\nthe",314],["reconstruction",314],["loss.",314],["If",317],["the",317],["decoder",317],["output",317],["is",317],["bad",317],["at\nreconstructing",317],["the",317],["data",317],["well,",317],["that",321],["would",321],["consequently\nincur",321],["a",321],["large",321],["cost",321],["here.",321],["The",324],["next",324],["term",324],["is\nthe",324],["regularizer.",324],["Regularizing",326],["in",326],["this\ncase",326],["means",326],["keeping",326],["the",329],["representations",329],["of",329],["each\ndigit",329],["as",329],["diverse",329],["as",329],["possible.",329],["If",333],["a",333],["two",333],["was",333],["written",333],["by\ntwo",333],["different",333],["people,",333],["we",335],["could",335],["end",335],["up",335],["with",335],["very\ndifferent",335],["representations.",335],["That's",338],["a",338],["bad",338],["thing.\n",338],["We",339],["only",339],["want",339],["one",339],["since",339],["they\nboth",339],["wrote",339],["the",339],["same",339],["number.",339],["We",342],["penalize",342],["bad\nbehavior",342],["this",342],["way,",342],["and",345],["it",345],["makes",345],["sure",345],["similar\nrepresentations",345],["are",345],["close",345],["together.\n",348],["So",349],["our",349],["total",349],["loss\nfunction",349],["is",349],["defined",349],["as",351],["the",351],["sum",351],["of",351],["our",351],["reconstruction\nterm",351],["and",351],["the",351],["KL",351],["divergence",351],["regularization",354],["term.\n",354],["So",356],["this",356],["is",356],["the",356],["dopest",356],["part.\n",356],["The",358],["way",358],["we",358],["normally\nwant",358],["to",358],["train",358],["this",358],["model",358],["is",361],["to",361],["use",361],["gradient",361],["descent",361],["to\noptimize",361],["a",361],["loss",361],["with",361],["respect",361],["to",364],["the",364],["parameters",364],["of",364],["both\nthe",364],["encoder",364],["and",364],["the",364],["decoder.",364],["But",368],["wait,",368],["how",368],["are",368],["we",368],["going",368],["to\ntake",368],["derivatives",368],["with",368],["respect",368],["to",371],["the",371],["parameters",371],["of",371],["a\nstochastic",371],["or",371],["randomly",371],["determined",374],["variable?\n",374],["We've",376],["built",376],["randomness\ninto",376],["the",376],["model",376],["itself.",376],["Gradient",379],["descent",379],["usually",379],["expects\nthat",379],["a",379],["given",379],["input",379],["always",379],["returns",383],["the",383],["same",383],["output",383],["for\na",383],["fixed",383],["set",383],["of",383],["parameters.",383],["So",386],["the",386],["only",386],["source",386],["of\nrandomness",386],["would",386],["be",386],["the",386],["inputs.",386],["What",390],["do",390],["we",390],["do,",390],["cowboy?\n",390],["We're",392],["going",392],["to",392],["reparameterize.\n",392],["We",395],["want",395],["to\nreparameterize",395],["samples",395],["so",398],["that",398],["the",398],["randomness",398],["is\nindependent",398],["of",398],["the",398],["parameters.",398],["So",401],["we",401],["define",401],["a",401],["function",401],["that\ndepends",401],["on",401],["the",401],["parameters",401],["deterministically,",405],["and\nwe",405],["inject",405],["randomness",405],["into",407],["the",407],["model",407],["by",407],["introducing\na",407],["random",407],["variable.",407],["Instead",411],["of",411],["the\nencoder",411],["generating",411],["a",412],["vector",412],["of",412],["real",412],["values,",412],["it\nwill",412],["generate",412],["a",412],["vector",412],["of",412],["means",412],["and",416],["a",416],["vector",416],["of\nstandard",416],["deviations.",416],["Then",419],["we",419],["can",419],["take",419],["derivatives\nof",419],["the",419],["functions",419],["involving",419],["z",422],["with",422],["respect",422],["to",422],["the\nparameters",422],["of",422],["its",422],["distribution.",422],["We'll",426],["define",426],["our\nmodel's",426],["optimizer",426],["as",427],["rmsprop,",427],["which",427],["performs\ngradient",427],["descent",427],["and",427],["its",427],["loss",427],["function",431],["as",431],["the",431],["one",431],["we",431],["defined.\n",431],["Then",433],["we'll",433],["train",433],["it",433],["by\nimporting",433],["our",433],["digit",433],["images",433],["and",436],["feeding",436],["them",436],["into",436],["our",436],["model\nfor",436],["a",436],["given",436],["number",436],["of",436],["epochs",436],["and",439],["batch",439],["size.\n",439],["For",440],["our",440],["demo,",440],["we",440],["can",440],["plot\nout",440],["the",440],["neighborhoods,",440],["the",443],["different",443],["classes\non",443],["a",443],["2D",443],["plane.",443],["Each",445],["colored",445],["cluster",445],["represents\na",445],["digit",445],["representation,",445],["and",448],["close",448],["clusters",448],["are",448],["digits\nthat",448],["are",448],["structurally",448],["similar.",448],["We",452],["can",452],["also",452],["generate",452],["digits\nby",452],["scanning",452],["the",452],["latent",452],["plane,",452],["sampling",455],["latent",455],["points\nat",455],["regular",455],["intervals,",455],["and",457],["generating",457],["the",457],["corresponding\ndigit",457],["for",457],["each",457],["of",457],["these",457],["points.",457],["So",461],["the",461],["three",461],["key\ntakeaways",461],["here",461],["are",461],["that",463],["variational\nautoencoders",463],["allow",463],["us",465],["to",465],["generate\ndata",465],["by",465],["performing",465],["unsupervised",467],["learning.\n",467],["They",468],["are",468],["a",468],["product",468],["of",468],["two\nideas,",468],["Bayesian",468],["inference",468],["and",471],["deep",471],["learning.\n",471],["And",472],["we",472],["can",472],["backpropagate\nthrough",472],["our",472],["network",472],["by",474],["performing",474],["a\nreparameterizing",474],["step",474],["that",474],["makes",477],["randomness",477],["independent\nof",477],["the",477],["parameters",477],["we",477],["derive",480],["our",480],["gradients",480],["from.\n",480],["Mike",482],["McDermott",482],["is",482],["last",482],["week's\ncoding",482],["challenge",482],["winner.",482],["He",485],["cleverly",485],["applied",485],["the\nmulti-armed",485],["bandit",485],["problem",485],["to",487],["the",487],["stock",487],["market.\n",487],["Each",488],["BOC",488],["he",488],["created",488],["used",488],["a\ndifferent",488],["investment",488],["strategy",488],["based",491],["on",491],["reinforcement\nlearning",491],["to",491],["profit,",491],["and",494],["his",494],["IPython",494],["notebook\nis",494],["a",494],["great",494],["example",494],["of",496],["what",496],["well-documented\ncode",496],["looks",496],["like.",496],["Wizard",499],["of",499],["the",499],["week.\n",499],["And",500],["the",500],["runner-up\nis",500],["S.",500],["G.",500],["Eshwar.",500],["He",502],["successfully",502],["took",502],["state\ninto",502],["account,",502],["which",502],["made",502],["it",502],["the",505],["contextual",505],["bandit",505],["problem.\n",505],["Dope",506],["submissions,",506],["guys.\n",506],["I",508],["bow",508],["to",508],["both",508],["of",508],["you.\n",508],["The",509],["coding",509],["challenge\nfor",509],["this",509],["video",509],["is",511],["to",511],["use",511],["a",511],["VAE",511],["to\ngenerate",511],["something",511],["other",513],["than",513],["digit",513],["images.\n",513],["Details",514],["are",514],["in",514],["the\nread",514],["me",514],["Github",514],["Links,",514],["go",516],["in",516],["the",516],["comments,\nand",516],["winners",516],["are",516],["going",516],["to",517],["be",517],["announced",517],["next",517],["week.\n",517],["Please",518],["subscribe",518],["if",518],["you",518],["want\nto",518],["see",518],["more",518],["programming",518],["videos.",518],["Check",521],["out",521],["this",521],["related",521],["video.\n",521],["And",523],["for",523],["now,",523],["I've",523],["got\nto",523],["deal",523],["with",523],["my",523],["hair.",523],["So",526],["thanks",526],["for",526],["watching.\n",526]]}