{"title":"Build an AI Composer - Machine Learning for Hackers #2","fromid":"S_f2qV2_U00","words":[["I",4],["actually",4],["didn’t",4],["play",4],["anything.",4],["You",4],["just\nheard",4],["AI",4],["generated",4],["music.",4],["Hello",8],["World,",8],["welcome",8],["to",8],["Sirajology!",8],["In",8],["this\nepisode,",8],["we’re",8],["going",8],["to",8],["train",8],["a",8],["neural",8],["network",8],["to",11],["compose",11],["music",11],["all",11],["by",11],["itself.",11],["Machine",11],["generated\nmusic!",11],["the",11],["technical",11],["term",11],["for",11],["this",11],["is",11],["‘music",11],["language",16],["modeling’",16],["and",16],["it",16],["has",16],["a",16],["long",16],["history\nof",16],["research",16],["behind",16],["it.",16],["Markov",16],["Models",16],["and",16],["restricted",16],["bolztman",20],["machines.",20],["Which",20],["kind",20],["of",20],["sounds",20],["like\nsomething",20],["out",20],["of",20],["half",20],["life",20],["or",20],["bioshock.",20],["Hold",23],["on",23],["babe.",23],["I’ve",23],["got",23],["to",23],["go",23],["save",23],["the",23],["world\nusing",23],["my",23],["restricted",23],["boltzman",23],["machine.",23],["Music",27],["is",27],["how",27],["we",27],["communicate",27],["our",27],["emotions",27],["and\npassions",27],["and",27],["its",27],["completely",27],["based",27],["on",27],["mathematical",27],["relationships.",32],["Octaves,",32],["Chords,",32],["Scales,",32],["keys,\nall",32],["of",32],["it",32],["is",32],["math.",32],["At",32],["the",32],["lowest",32],["level,",32],["music",32],["is",38],["a",38],["series",38],["of",38],["sound",38],["waves",38],["that",38],["create",38],["pockets\nof",38],["air",38],["pressure,",38],["and",38],["the",38],["pitch",38],["we",38],["hear",38],["depends",38],["on",42],["frequency",42],["of",42],["changes",42],["in",42],["this",42],["air",42],["pressure.\nWe’ve",42],["created",44],["annotation",44],["to",44],["help",44],["us",44],["map",44],["these",44],["sounds\ninto",44],["an",44],["instruction",44],["set.",44],["So",44],["if",44],["machine",44],["learning",44],["is",50],["all",50],["about",50],["feeding",50],["data",50],["into",50],["models",50],["to",50],["find\npatterns",50],["and",50],["make",50],["predictions,",50],["could",50],["we",50],["use",50],["it",54],["to",54],["generate",54],["music",54],["all",54],["by",54],["itself?",54],["absofruitly.",54],["We’re",57],["going",57],["to",57],["be",57],["build",57],["an",57],["app",57],["that",57],["learns\nhow",57],["to",57],["compose",57],["british",57],["folk",57],["music",57],["by",57],["training",57],["on",62],["a",62],["dataset",62],["of",62],["british",62],["folk",62],["music.",62],["We’ll\nbe",62],["using",62],["Tensorflow,",62],["the",62],["sickest",62],["machine",62],["learning",62],["library",70],["ever,",70],["to",70],["do",70],["this",70],["in",70],["just",70],["10",70],["lines\nof",70],["Python.",70],["We’ll",70],["be",70],["following",70],["the",70],["tried",70],["and",74],["true",74],["4",74],["step",74],["machine",74],["learning",74],["methodology\nto",74],["do",74],["this.",74],["Collect",74],["a",74],["dataset,",74],["build",74],["the",74],["model,",74],["train",78],["the",78],["model,",78],["and",78],["test",78],["the",78],["model.",78],["To",78],["start\noff,",78],["we’ll",78],["want",78],["to",78],["collect",78],["our",78],["dataset.",78],["So",81],["let’s",81],["import",81],["the",81],["urllib",81],["module,",81],["which\nwill",81],["let",81],["us",81],["download",81],["a",81],["file",81],["from",81],["the",81],["web.",81],["Once",85],["we",85],["import",85],["it",85],["we",85],["can",85],["call",85],["the",85],["URLretrieve\nmethod",85],["to",85],["do",85],["just",85],["that.",85],["We’ll",85],["set",85],["the",85],["parameters",85],["to",89],["the",89],["link",89],["to",89],["the",89],["dataset",89],["and",89],["the",89],["name",89],["we’ll\ncall",89],["the",89],["downloaded",89],["file.",89],["We’re",89],["using",89],["the",89],["nottingham",92],["dataset",92],["for",92],["this",92],["demo,",92],["which",92],["is\na",92],["collection",92],["of",92],["1000",92],["british",92],["folk",92],["songs",92],["in",92],["MIDI",96],["format.",96],["MIDI",96],["format",96],["is",96],["perfect",96],["for",96],["us\nsince",96],["it",96],["encodes",96],["all",96],["the",96],["note",96],["and",96],["time",96],["information",96],["exactly",100],["how",100],["it",100],["would",100],["be",100],["written",100],["in",100],["music",100],["annotation.\nIt",100],["comes",100],["in",100],["a",100],["zip",100],["file,",100],["so",100],["we’ll",100],["want",100],["to",100],["unzip",104],["it",104],["as",104],["well.",104],["We",104],["can",104],["do",104],["this",104],["programmatically\nusing",104],["the",104],["zipfile",104],["module.",104],["We’ll",104],["extract",104],["the",108],["data",108],["from",108],["the",108],["zip",108],["and",108],["place",108],["it",108],["in",108],["the\ndata",108],["directory.",108],["We’ve",111],["got",111],["our",111],["data,",111],["it’s",111],["time",111],["to",111],["create\nthe",111],["model.",111],["But",111],["before",111],["we",111],["do",111],["that,",111],["we",111],["need",111],["to",114],["think",114],["about",114],["how",114],["we",114],["want",114],["to",114],["represent",114],["our\ninput",114],["data.There",114],["are",114],["88",114],["possible",114],["pitches",114],["in",114],["a",116],["MIDI",116],["file",116],["so",116],["we",116],["could",116],["do",116],["one",116],["vector",116],["representation\nper",116],["note.",116],["But",116],["lets",116],["be",116],["more",116],["specific.",116],["At",116],["each",116],["time",117],["step",117],["in",117],["the",117],["music,",117],["there",117],["are",117],["two",117],["things\nhapppening.",117],["Theres",117],["the",117],["main",117],["tune",117],["or",117],["melody",117],["and",119],["then",119],["there",119],["are",119],["the",119],["supporting",119],["notes",119],["or\nharmony.",119],["Let’s",119],["represent",119],["each",119],["as",119],["a",119],["vector.",119],["And",123],["to",123],["make",123],["things",123],["easier",123],["we’ll",123],["make",123],["two\nassumptions.",123],["The",123],["first",123],["is",123],["that",123],["the",123],["melody",123],["is",126],["monophonic.",126],["That",126],["means",126],["only",126],["one",126],["note",126],["is\nplayed",126],["at",126],["each",126],["time",126],["stamp.",126],["The",126],["second",126],["is",126],["that",126],["the",131],["harmony",131],["at",131],["each",131],["stamp",131],["can",131],["be",131],["classified\ninto",131],["a",131],["chord",131],["class.",131],["So",131],["thats",131],["two",131],["different",131],["vectors",135],["one",135],["for",135],["melody",135],["and",135],["one",135],["for",135],["harmony.\nWe’ll",135],["then",135],["combine",135],["them",135],["into",135],["one",135],["vector",135],["for",139],["each",139],["stamp.",139],["We",141],["can",141],["just",141],["import",141],["our",141],["ML",141],["helper",141],["class",141],["and\nthen",141],["call",141],["the",141],["create",141],["model",141],["method",141],["to",141],["do",141],["this.",141],["Music",145],["plays",145],["out",145],["over",145],["a",145],["period",145],["of",145],["time,",145],["its\na",145],["sequence",145],["of",145],["notes.",145],["So",145],["we",145],["need",145],["to",145],["use",145],["a",145],["sequence",145],["learning",149],["model",149],["-",149],["it",149],["has",149],["to",149],["accept",149],["a",149],["sequence\nof",149],["notes",149],["as",149],["an",149],["input",149],["and",149],["output",149],["a",149],["new",149],["sequence",149],["of",154],["notes.",154],["Plain",154],["old",154],["neural",154],["nets",154],["can’t",154],["do\nthis.",154],["They",154],["accept",154],["fixed",154],["sized",154],["inputs",154],["like",154],["an",158],["image",158],["or",158],["a",158],["number.",158],["We’ll",158],["need",158],["a",158],["special\nkind",158],["of",158],["neural",158],["network,",158],["a",158],["recurrent",158],["neural",158],["network.",162],["Yeah!",162],["Those",162],["can",162],["deal",162],["with",162],["sequences\nsince",162],["data",162],["doesn’t",162],["just",162],["flow",162],["one",162],["way,",162],["it",162],["loops.",166],["This",166],["allows",166],["the",166],["network",166],["to",166],["have",166],["a",166],["kind\nof",166],["short",166],["term",166],["memory.",166],["Yeah,",166],["that’ll",166],["work.",166],["But",170],["wait.",170],["We",170],["want",170],["our",170],["network",170],["to",170],["not",170],["just\nremember",170],["the",170],["most",170],["recent",170],["music",170],["its",170],["heard,",170],["but",173],["all",173],["the",173],["music",173],["its",173],["heard.",173],["Like,",173],["a",173],["piece\nof",173],["music",173],["can",173],["have",173],["multiple",173],["themes",173],["in",173],["different",173],["parts",177],["of",177],["it",177],["(hopeful,",177],["melancholic,",177],["angry)\nand",177],["if",177],["the",177],["network",177],["only",177],["remembers",177],["the",177],["most",177],["recent",181],["part",181],["which",181],["was",181],["cheery,",181],["it’s",181],["just\ngoing",181],["to",181],["compose",181],["cheery",181],["stuff.",181],["We",181],["need",181],["a",181],["special",181],["type",185],["of",185],["recurrent",185],["neural",185],["network",185],["called",185],["a\nLong",185],["short",185],["term",185],["memory",185],["network.",185],["Super",185],["specific",185],["i",189],["know.",189],["This",189],["type",189],["of",189],["network",189],["has",189],["a",189],["short",189],["term\nmemory",189],["that",189],["is",189],["LONG,",189],["like",189],["it",189],["can",189],["remember",189],["things",190],["from",190],["way",190],["back",190],["in",190],["the",190],["sequence",190],["of",190],["data,\nand",190],["it",190],["uses",190],["everything",190],["it",190],["remembers",190],["to",190],["generate",190],["new",194],["sequences.",194],["We",195],["can",195],["add",195],["this",195],["model",195],["in",195],["our",195],["code",195],["with",195],["just\none",195],["line",195],["using",195],["our",195],["helper",195],["class.",195],["It’ll",195],["generate",195],["the",196],["sequences",196],["and",196],["chord",196],["mapping",196],["file",196],["to",196],["a\nfile",196],["called",196],["‘’",196],["in",196],["the",196],["data",196],["folder.",196],["This",196],["is",200],["just",200],["a",200],["serialized",200],["byte",200],["stream",200],["representation\nof",200],["our",200],["music",200],["that",200],["we’re",200],["going",200],["to",200],["train",200],["our",200],["model",203],["with",203],["it.",203],["Now",203],["that",203],["we",203],["have",203],["our",203],["model\nwe",203],["can",203],["go",203],["ahead",203],["and",203],["train",203],["it.",203],["You",203],["might",203],["be",203],["thinking",204],["wait",204],["this",204],["is",204],["a",204],["little",204],["too",204],["easy,",204],["isn’t\nthere",204],["more",204],["to",204],["it?",204],["Well",204],["yeah,",204],["every",204],["machine",204],["learning",206],["model",206],["has",206],["a",206],["set",206],["of",206],["what",206],["are",206],["called\n‘hyperparameters’.",206],["These",206],["are",206],["the",206],["parameters",206],["that",209],["we",209],["humans",209],["set",209],["for",209],["how",209],["our",209],["model",209],["operates,\nlike",209],["knobs",209],["on",209],["a",209],["control",209],["panel.",209],["How",209],["many",209],["layers",209],["do",213],["we",213],["want?",213],["how",213],["many",213],["iterations",213],["for",213],["training?\nHow",213],["many",213],["neurons?",213],["You",213],["could",213],["play",213],["around",213],["with",213],["these,",216],["turning",216],["all",216],["the",216],["knobs",216],["in",216],["different\nways",216],["to",216],["perfect",216],["your",216],["end-result,",216],["but",216],["chances",216],["someone",217],["somewhere",217],["has",217],["solved",217],["the",217],["problem",217],["you’re\nworking",217],["and",217],["and",217],["you",217],["can",217],["just",217],["use",217],["an",217],["existing",217],["model",217],["with",217],["pre-tuned",217],["hyperparameters",217],["to",217],["build\nsomething",217],["awesome",217],["So",220],["now",220],["we’re",220],["ready",220],["to",220],["train",220],["our",220],["model.",220],["We\ncan",220],["just",220],["call",220],["the",220],["train_model",220],["method",220],["of",220],["our",220],["recurrent",224],["neural",224],["net",224],["class",224],["to",224],["do",224],["this.",224],["This’ll\nget",224],["the",224],["the",224],["network",224],["to",224],["start",224],["collecting",224],["the",224],["input",227],["data",227],["piece",227],["by",227],["piece.",227],["It",227],["took",227],["me",227],["about\n2",227],["hours",227],["to",227],["train",227],["it",227],["on",227],["my",227],["2013",227],["macbook",227],["pro.",227],["But",231],["you",231],["don’t",231],["have",231],["to",231],["wait",231],["until",231],["its",231],["competely\ndone",231],["training",231],["to",231],["test",231],["it",231],["out.",231],["Just",231],["wait",231],["until",231],["you",235],["see",235],["the",235],["\"Best",235],["loss",235],["so",235],["far",235],["encountered,\nsaving",235],["model.”",235],["message.",235],["Once",235],["you",235],["see",235],["that",235],["you",239],["can",239],["type",239],["‘rnn_sample’",239],["into",239],["terminal\nwith",239],["the",239],["flag",239],["—config",239],["file",239],["and",239],["point",239],["it",239],["to",243],["the",243],["newly",243],["generated",243],["config",243],["file",243],["in",243],["your\nmodels",243],["folder.",243],["That",243],["will",243],["generate",243],["a",243],["new",243],["song",243],["using",247],["the",247],["newly",247],["trained",247],["model",247],["you’ve",247],["just\ncreated.",247],["To",247],["generate",247],["music",247],["we",247],["just",247],["sample",247],["the",250],["melody",250],["and",250],["harmony",250],["at",250],["each",250],["time",250],["step",250],["and\nplug",250],["it",250],["into",250],["our",250],["trained",250],["model.",250],["The",250],["model",250],["will",255],["then",255],["predict",255],["what",255],["the",255],["next",255],["notes",255],["will\nbe.",255],["The",255],["collection",255],["of",255],["all",255],["the",255],["predicted",255],["notes",255],["is",258],["our",258],["newly",258],["generated",258],["song.",258],["Let’s",260],["listen",260],["in",260],["to",260],["what",260],["I’ve",260],["generated.\nSo",260],["it",260],["sounds",260],["nice,",260],["it",260],["could",260],["better",260],["but",260],["it",260],["gives",265],["off",265],["that",265],["british",265],["folk",265],["vibe.",265],["There",265],["are\ndefinitely",265],["some",265],["improvements",265],["that",265],["could",265],["be",265],["made.",268],["The",268],["time",268],["signature",268],["is",268],["kinda",268],["sporadic\nand",268],["in",268],["terms",268],["of",268],["long-term",268],["structure,",268],["there",268],["seems",272],["to",272],["be",272],["a",272],["lack",272],["of",272],["repeated",272],["themes",272],["and\nphrases.",272],["The",272],["solution",272],["may",272],["well",272],["be",272],["more",272],["data",272],["and",276],["more",276],["computing",276],["power.",276],["It",276],["usually",276],["is",276],["when\nit",276],["comes",276],["to",276],["machine",276],["learning",276],["with",276],["deep",276],["neural",276],["nets.",281],["Machine",281],["learning",281],["can",281],["help",281],["us",281],["learn",281],["the\nfundamental",281],["nature",281],["of",281],["how",281],["music",281],["works",281],["in",281],["ways",281],["that",285],["we",285],["haven’t",285],["even",285],["thought",285],["about.",285],["I’ve\ngot",285],["links",285],["below,",285],["check",285],["em",285],["out.",285],["and",285],["I’ve",285],["gotta",291],["go",291],["fix",291],["a",291],["runtime",291],["error",291],["so",291],["thanks",291],["for\nwatching",291]]}