{"title":"Build a Game AI - Machine Learning for Hackers #3","fromid":"HBAUeJkFMH0","words":[["Yes",0],["I",0],["beat",0],["it,",0],["did",0],["that",0],["impress",0],["you?",0],["If",0],["i",0],["built",0],["an",0],["ai",0],["to",0],["beat",0],["this",0],["for",0],["me",0],["would",0],["that",0],["impress",0],["you",0],["Hello",5],["World,",5],["welcome",5],["to",5],["Sirajology!",5],["In",5],["this\nepisode",5],["we're",5],["going",5],["to",5],["build",5],["an",5],["AI",5],["to",5],["beat",5],["a",10],["bunch",10],["of",10],["Atari",10],["games.",10],["Games",10],["have",10],["had",10],["a",10],["long\nhistory",10],["of",10],["being",10],["a",10],["testbed",10],["for",10],["AI",10],["ever",10],["since",10],["the",14],["days",14],["of",14],["Pong.",14],["Traditionally,",14],["game",14],["programmers\nhave",14],["taken",14],["a",14],["reductionist",14],["approach",14],["to",14],["building",14],["AI.",18],["They've",18],["reduced",18],["the",18],["simulated",18],["world",18],["to\na",18],["model",18],["and",18],["had",18],["the",18],["AI",18],["act",18],["on",18],["prior",18],["knowledge",18],["of",22],["that",22],["model.",22],["And",22],["it",22],["worked",22],["out",22],["for",22],["the",22],["most\npart.",22],["I",22],["guess.",22],["Not",22],["really.",22],["But",22],["what",22],["if",22],["we",22],["want",26],["to",26],["build",26],["an",26],["AI",26],["that",26],["can",26],["be",26],["used",26],["in",26],["several\ndifferent",26],["types",26],["of",26],["game",26],["worlds?",26],["All",26],["the",26],["world",26],["models",30],["are",30],["different",30],["so",30],["we",30],["couldn't",30],["feed",30],["it\njust",30],["one",30],["world",30],["model.",30],["Instead",30],["of",30],["modeling",30],["the",33],["world,",33],["we",33],["need",33],["to",33],["model",33],["the",33],["mind.",33],["We",35],["want",35],["to",35],["create",35],["an",35],["AI",35],["that",35],["can",35],["become",35],["a\npro",35],["at",35],["any",35],["game",35],["we",35],["throw",35],["at",35],["it.",35],["So",35],["in",35],["thinking",35],["about",39],["this",39],["problem,",39],["we",39],["have",39],["to",39],["ask",39],["ourselves\n--",39],["what",39],["is",39],["the",39],["dopest",39],["way",39],["to",39],["do",39],["this?",39],["Well,",39],["the",42],["London-based",42],["startup",42],["DeepMind",42],["already\ndid",42],["this",42],["in",42],["2015.",42],["DeepMind's",42],["goal",42],["is",42],["to",42],["create",42],["artificial",46],["general",46],["intelligence,",46],["thats",46],["one\nalgorithm",46],["that",46],["can",46],["solve",46],["any",46],["problem",46],["with",46],["human",49],["level",49],["thinking",49],["or",49],["greater.",49],["They",49],["reached\nan",49],["important",49],["milestone",49],["by",49],["creating",49],["an",49],["algorithm",49],["that",53],["was",53],["able",53],["to",53],["master",53],["49",53],["different",53],["Atari\ngames",53],["with",53],["no",53],["game-specific",53],["hyperparameter",53],["tuning",56],["whatsoever.",56],["Google",56],["snapped",56],["them",56],["up\nlike",56],["yooooooooo.",56],["The",56],["algorithm",56],["is",56],["called",56],["the",56],["Deep",58],["Q",58],["Learner",58],["and",58],["it",58],["was",58],["recently",58],["made",58],["open\nsource",58],["on",58],["GitHub.",58],["It",58],["only",58],["takes",58],["two",58],["inputs",58],["--",63],["the",63],["raw",63],["pixels",63],["of",63],["the",63],["game",63],["and",63],["the",63],["game\nscore.",63],["That's",63],["it.",63],["Based",63],["on",63],["just",63],["that",63],["it",63],["has",63],["to",66],["complete",66],["its",66],["objective;",66],["maximize",66],["the",66],["score.\nLet's",66],["dive",66],["into",66],["how",66],["this",66],["works,",66],["since",66],["we'll",66],["want",70],["to",70],["recreate",70],["their",70],["results.",70],["First",71],["it",71],["uses",71],["a",71],["deep",71],["convolutional",71],["neural\nnetwork",71],["to",71],["interpret",71],["the",71],["pixels.",71],["This",71],["is",71],["a",71],["type",75],["of",75],["neural",75],["network",75],["inspired",75],["by",75],["how",75],["our\nvisual",75],["cortex",75],["operates,",75],["and",75],["expects",75],["images",75],["as",78],["inputs.",78],["Images",78],["are",78],["high",78],["dimensional",78],["data\nso",78],["we",78],["need",78],["to",78],["reduce",78],["the",78],["number",78],["of",78],["connections",78],["each",82],["neuron",82],["has",82],["to",82],["avoid",82],["overfitting.",82],["Overfitting\nby",82],["the",82],["way",82],["is",82],["when",82],["your",82],["model",82],["is",82],["too",82],["complex,",82],["there",86],["too",86],["many",86],["parameters",86],["and",86],["so",86],["its",86],["overly\ntuned",86],["to",86],["the",86],["data",86],["you've",86],["given",86],["it",86],["and",86],["won't",86],["generalize",89],["well",89],["for",89],["any",89],["new",89],["dataset.",89],["So",89],["unlike\na",89],["regular",89],["neural",89],["network,",89],["a",89],["convolutional",89],["network's",93],["layers",93],["are",93],["stacked",93],["in",93],["3",93],["dimensions\nand",93],["this",93],["makes",93],["it",93],["easy",93],["to",93],["connect",93],["each",93],["neuron",93],["ONLY",98],["to",98],["neurons",98],["in",98],["its",98],["local",98],["region",98],["instead\nof",98],["every",98],["single",98],["other",98],["neuron.",98],["Each",98],["layer",98],["acts",98],["as",102],["a",102],["detection",102],["filter",102],["for",102],["the",102],["presence",102],["of\nspecific",102],["features",102],["in",102],["an",102],["image",102],["and",102],["the",102],["layers",102],["get",106],["increasingly",106],["abstract",106],["with",106],["feature",106],["representation.\nSo",106],["the",106],["first",106],["layer",106],["could",106],["be",106],["a",106],["simple",106],["feature",106],["like",110],["edges,",110],["then",110],["the",110],["next",110],["layer",110],["would",110],["use\nthose",110],["edges",110],["to",110],["detect",110],["simple",110],["shapes,",110],["and",110],["the",110],["next",113],["one",113],["would",113],["use",113],["those",113],["shapes",113],["to",113],["detect\nsomething",113],["even",113],["more",113],["complex",113],["like",113],["Kanye.",113],["These",113],["hierarchical",116],["layers",116],["of",116],["abstraction",116],["are",116],["what\nneural",116],["nets",116],["do",116],["really",116],["well.",116],["So",120],["once",120],["it's",120],["interpreted",120],["the",120],["pixels,",120],["it",120],["needs\nto",120],["act",120],["on",120],["that",120],["knowledge",120],["in",120],["some",120],["way.",120],["In",120],["a",120],["previous",123],["episode",123],["we",123],["talked",123],["about",123],["supervised\nand",123],["unsupervised",123],["learning.",123],["But",123],["wait",123],["(there",123],["is",127],["another",127],["and",127],["his",127],["name",127],["is",127],["john",127],["cena)",127],["its\ncalled",127],["Reinforcement",127],["Learning.",127],["Reinforcement",127],["learning",132],["is",132],["all",132],["about",132],["trial",132],["and",132],["error.",132],["Its\nabout",132],["teaching",132],["an",132],["AI",132],["to",132],["select",132],["actions",132],["to",132],["maximize",136],["future",136],["rewards.",136],["Its",136],["similar",136],["to",136],["how\nyou",136],["would",136],["train",136],["a",136],["dog.",136],["If",136],["the",136],["dog",136],["fetches",136],["the",140],["ball",140],["you",140],["give",140],["it",140],["a",140],["treat,",140],["if",140],["it",140],["doesn't\nthen",140],["you",140],["withhold",140],["the",140],["treat.",140],["So",140],["while",140],["the",140],["game",143],["is",143],["running,",143],["at",143],["each",143],["time",143],["step,",143],["the",143],["AI\nexecutes",143],["an",143],["action",143],["based",143],["on",143],["what",143],["it",143],["observes",143],["and",147],["may",147],["or",147],["may",147],["not",147],["receive",147],["a",147],["reward.",147],["If",147],["it\ndoes",147],["receive",147],["a",147],["reward,",147],["we'll",147],["adjust",147],["our",147],["weights",147],["so",151],["that",151],["the",151],["AI",151],["will",151],["be",151],["likely",151],["to",151],["do",151],["a",151],["similar\naction",151],["in",151],["the",151],["future.",151],["Q",151],["Learning",151],["is",151],["the",151],["type",151],["of",155],["reinforcement",155],["learning",155],["that",155],["learns",155],["the\noptimal",155],["action-selection",155],["behavior",155],["or",155],["policy",155],["for",158],["the",158],["AI",158],["without",158],["having",158],["a",158],["prior",158],["model",158],["of\nthe",158],["environment.",158],["So",158],["based",158],["on",158],["the",158],["current",158],["game",158],["state,",162],["like",162],["an",162],["enemy",162],["spaceship",162],["being",162],["in",162],["shooting\ndistance,",162],["the",162],["AI",162],["will",162],["eventually",162],["know",162],["to",162],["take",162],["the",166],["action",166],["of",166],["shooting",166],["it.",166],["This",166],["mapping",166],["of\nstate",166],["to",166],["action",166],["is",166],["its",166],["policy",166],["and",166],["it",166],["gets",166],["better",170],["and",170],["better",170],["with",170],["training.",170],["Deep",170],["Q",170],["also\nuses",170],["something",170],["called",170],["experience",170],["replay,",170],["which",170],["means",174],["the",174],["AI",174],["learns",174],["from",174],["the",174],["dataset",174],["of",174],["its\npast",174],["policies",174],["as",174],["well.",174],["This",174],["is",174],["inspired",174],["by",174],["how",177],["our",177],["hippocampus",177],["works,",177],["it",177],["replays",177],["past\nexperiences",177],["during",177],["rest",177],["periods,",177],["like",177],["when",177],["we",177],["sleep.",177],["So",177],["we're",177],["going",177],["to",177],["build",177],["our",177],["game",177],["bot",177],["in",177],["just\n10",177],["lines",177],["of",177],["Python",177],["using",177],["a",177],["combination",177],["of",177],["Tensorflow",181],["and",181],["Gym.",181],["Tensorflow",181],["is",181],["google's\nML",181],["library",181],["which",181],["we'll",181],["use",181],["to",181],["create",181],["the",181],["convolutional",181],["neural",185],["net,",185],["and",185],["Gym",185],["is",185],["OpenAI's",185],["ML",185],["library\nwhich",185],["we'll",185],["use",185],["to",185],["create",185],["our",185],["reinforcement",185],["learning",188],["algorithm",188],["and",188],["setup",188],["our",188],["environment.\nOh,",188],["If",188],["you",188],["haven't",188],["heard,",188],["OpenAI",188],["is",188],["a",188],["non-profit",188],["AI",193],["research",193],["lab",193],["focused",193],["on",193],["creating",193],["AGI",193],["in\nan",193],["open",193],["source",193],["way.",193],["They've",193],["got",193],["a",193],["billion",193],["bucks",197],["pledged",197],["from",197],["people",197],["like",197],["Elon",197],["Musk",197],["so\nyeah.",197],["Elon",197],["Musk.",197],["Let's",203],["start",203],["off",203],["by",203],["importing",203],["our",203],["dependencies.\nEnvironment",203],["is",203],["our",203],["helper",203],["class",203],["that",203],["will",203],["help",207],["initialize",207],["our",207],["game",207],["environment.",207],["In",207],["our\ncase,",207],["this",207],["will",207],["be",207],["space",207],["invaders,",207],["but",207],["we",207],["can",210],["easily",210],["switch",210],["that",210],["out",210],["to",210],["a",210],["whole",210],["host\nof",210],["different",210],["environments.",210],["Gym",210],["is",210],["very",210],["modular,",210],["OpenAI",214],["wants",214],["it",214],["to",214],["be",214],["a",214],["gym",214],["for",214],["AI",214],["agents\nto",214],["train",214],["in",214],["and",214],["get",214],["better.",214],["You",214],["can",214],["submit",214],["your",217],["algorithm",217],["to",217],["their",217],["site",217],["for",217],["an",217],["evaluation\nand",217],["they'll",217],["'score'",217],["it",217],["against",217],["a",217],["set",217],["of",217],["metrics",217],["server-side.",220],["The",220],["more",220],["generalized",220],["the",220],["algorithm,\nthe",220],["better",220],["--",220],["and",220],["everybody's",220],["attempts",220],["can",220],["be",221],["viewed",221],["online",221],["so",221],["it",221],["makes",221],["sharing",221],["and",221],["collaborating\na",221],["whole",221],["lot",221],["easier.",221],["I",221],["approve.",221],["We'll",221],["also",221],["want",222],["to",222],["import",222],["our",222],["deep",222],["q",222],["network",222],["helper",222],["class\nto",222],["help",222],["observe",222],["the",222],["game",222],["and",222],["our",222],["training",222],["class",226],["to",226],["initialize",226],["the",226],["reinforcement",226],["learning.",226],["Once",228],["we've",228],["imported",228],["our",228],["dependencies,",228],["we",228],["can\ngo",228],["ahead",228],["and",228],["initialize",228],["our",228],["environment.",228],["We'll",228],["set",231],["the",231],["parameter",231],["to",231],["space",231],["invaders.",231],["and",231],["then\ninitialize",231],["our",231],["agent",231],["using",231],["our",231],["DQN",231],["helper",231],["class",235],["with",235],["the",235],["environment",235],["and",235],["environment\ntype",235],["as",235],["the",235],["parameters.",235],["Once",235],["we",235],["have",235],["that",235],["we",239],["can",239],["start",239],["training",239],["by",239],["running",239],["the",239],["trainer\nclass",239],["with",239],["the",239],["agent",239],["as",239],["the",239],["parameter.",239],["First,",239],["this",242],["will",242],["populate",242],["our",242],["initial",242],["replay",242],["memory\nwith",242],["50,000",242],["plays",242],["so",242],["we",242],["have",242],["a",242],["little",242],["experience",242],["to",247],["train",247],["with.",247],["Then",247],["it",247],["will",247],["initialize",247],["our\nconvolutional",247],["neural",247],["network",247],["to",247],["start",247],["reading",247],["in",250],["pixels",250],["and",250],["our",250],["Q",250],["learning",250],["algorithm",250],["to\nstart",250],["updating",250],["our",250],["agent's",250],["decisions",250],["based",250],["on",254],["the",254],["pixels",254],["it",254],["receives.",254],["This",254],["is",254],["an",254],["implementation\nof",254],["the",254],["classic",254],["\"agent-environment",254],["loop\".",254],["Each",254],["timestep,",258],["the",258],["agent",258],["chooses",258],["an",258],["action,",258],["and\nthe",258],["environment",258],["returns",258],["an",258],["observation",258],["and",258],["a",262],["reward.",262],["The",262],["observation",262],["is",262],["raw",262],["pixel",262],["data\nwhich",262],["we",262],["can",262],["feed",262],["into",262],["our",262],["convolutional",262],["network,",262],["and",266],["the",266],["reward",266],["is",266],["a",266],["number",266],["we",266],["can",266],["use",266],["to",266],["help\nimprove",266],["our",266],["next",266],["actions.",266],["Gym",266],["neatly",266],["returns",266],["these",269],["parameters",269],["to",269],["use",269],["via",269],["the",269],["step",269],["function\nwhich",269],["we've",269],["wrapped",269],["in",269],["the",269],["environment",269],["helper",269],["class.",273],["During",273],["training,",273],["our",273],["algorithm",273],["will\nperiodically",273],["save",273],["the",273],["'weights'",273],["to",273],["a",273],["file",273],["in",273],["the",273],["models",273],["directory",273],["so",273],["we'll",273],["always",273],["have\na",273],["partially",273],["trained",273],["model",273],["at",273],["least.",273],["Expect",274],["it",274],["to",274],["take",274],["a",274],["few",274],["days",274],["to",274],["fully",274],["train\nthis",274],["to",274],["human",274],["level.",274],["Once",274],["we've",274],["started",274],["training,",274],["we",274],["can",274],["start",274],["the",274],["game",274],["with",274],["the",274],["play",274],["function\nof",274],["our",274],["agent",274],["object.",274],["We",274],["can",274],["go",274],["ahead",274],["and",274],["run",274],["this",277],["in",277],["terminal",277],["and",277],["the",277],["space",277],["invaders",277],["window\nshould",277],["pop",277],["up",277],["and",277],["we'll",277],["start",277],["seeing",277],["the",277],["AI",277],["start",281],["attempting",281],["to",281],["play",281],["the",281],["game.",281],["It'll",281],["be\nhilariously",281],["bad",281],["at",281],["first",281],["but",281],["will",281],["slowly",281],["get",281],["better",284],["with",284],["time.",284],["(terminator)",284],["We",284],["can",284],["see\nin",284],["terminal",284],["a",284],["set",284],["of",284],["metrics",284],["periodically",284],["printed",285],["out",285],["so",285],["we",285],["can",285],["see",285],["how",285],["the",285],["agent",285],["is\ndoing",285],["as",285],["time",285],["progresses.",285],["The",285],["AI",285],["will",285],["get",285],["more",287],["difficult",287],["to",287],["defeat",287],["the",287],["longer",287],["you",287],["train\nit",287],["and",287],["ideally",287],["you",287],["can",287],["apply",287],["it",287],["to",287],["any",287],["game",287],["you",291],["create.",291],["Video",291],["games",291],["and",291],["other",291],["simulated\nenvironments",291],["are",291],["the",291],["perfect",291],["testing",291],["grounds",291],["for",292],["building",292],["AI",292],["since",292],["you",292],["can",292],["easily",292],["observe\nits",292],["behavior",292],["visually.",292],["For",292],["more",292],["info,",292],["check",292],["out",293],["the",293],["links",293],["down",293],["below",293],["and",293],["please",293],["subscribe\nfor",293],["more",293],["machine",293],["learning",293],["videos.",293],["For",293],["now",293],["i've",296],["gotta",296],["go",296],["fix",296],["a",296],["runtime",296],["error",296],["so",296],["thanks\nfor",296],["watching",296]]}