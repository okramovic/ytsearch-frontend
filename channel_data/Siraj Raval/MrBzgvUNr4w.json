{"title":"Deep Dream in TensorFlow - Learn Python for Data Science #5","fromid":"MrBzgvUNr4w","words":[["SIRAJ:",0],["-Hello",0],["World,",0],["it's",0],["Siraj!",0],["In",1],["this",1],["video,",1],["we're",1],["gonna",1],["create",1],["a",1],["neural",1],["network",1],["that",4],["makes",4],["images",4],["become",4],["really",4],["trippy",4],["using",6],["Python",6],["and",6],["TensorFlow.",6],["We",8],["humans",8],["have",8],["been",8],["using",8],["psychedelic",8],["drugs",8],["since",10],["prehistoric",10],["time.",10],["-That",12],["wasn't",12],["a",12],["normal",12],["mushroom!",12],["They",14],["help",14],["manifest",14],["parts",14],["of",14],["our",14],["mind",14],["to",16],["conscious",16],["experience",16],["that",16],["wouldn't",16],["normally",16],["otherwise.",16],["One",19],["of",19],["the",19],["most",19],["common",19],["experiences",19],["from",22],["psychedelics",22],["are",22],["trippy",22],["visuals.",22],["People",24],["who",24],["have",24],["taken",24],["psychedelics",24],["repeatedly",26],["describe",26],["experiences",26],["of",26],["seeing",26],["both",28],["open-eyed",28],["and",28],["closed-eyed",28],["visuals.",28],["But",30],["how?",30],["What",30],["are",30],["these",30],["drugs",30],["doing",30],["in",30],["our",30],["brain",30],["that",33],["makes",33],["us",33],["see",33],["things",33],["that",33],["aren't",33],["really",33],["there?",33],["The",35],["traditional",35],["way",35],["for",35],["us",35],["to",35],["find",35],["out",35],["is",37],["to",37],["test",37],["live",37],["human",37],["subjects",37],["tripping",37],["balls",37],["under",40],["an",40],["fMRI",40],["machine,",40],["but",42],["recently,",42],["we've",42],["gotten",42],["artificial",42],["neural",42],["networks",42],["that",45],["do",45],["the",45],["same",45],["thing,",45],["Google",46],["trained",46],["a",46],["neural",46],["network",46],["on",47],["a",47],["labeled",47],["dataset",47],["of",47],["images",47],["--",47],["everything",49],["from",49],["squirrels",49],["to",49],["temples",49],["--",49],["and",51],["as",51],["it",51],["trained",51],["on",51],["these",51],["images,",51],["it",53],["built",53],["internal",53],["representations",53],["at",53],["each",53],["layer.",53],["Eventually,",56],["the",56],["first",56],["two",56],["layers",56],["learned",56],["low-level",56],["features",56],["like",59],["lines",59],["and",59],["edges,",59],["and",59],["they",59],["got",59],["progressively",59],["more",59],["abstract",59],["so",62],["the",62],["last",62],["few",62],["layers",62],["were",62],["representations",62],["for",65],["faces",65],["and",65],["big",65],["shapes.",65],["So",66],["when",66],["we",66],["visualize",66],["one",66],["of",66],["the",68],["higher-level",68],["representations",68],["it",68],["built,",68],["we",70],["can",70],["see",70],["that",70],["it",70],["contains",70],["a",70],["mixture",70],["of",70],["features",70],["like",72],["the",72],["eyes",72],["of",72],["a",72],["dog",72],["and",72],["the",72],["head",72],["of",72],["a",72],["bird.",72],["Eugh!",74],["And",76],["when",76],["they",76],["gave",76],["it",76],["a",76],["novel",76],["image",76],["and",77],["asked",77],["not",77],["to",77],["classify",77],["it",77],["but",79],["to",79],["maximize",79],["the",79],["similarity",79],["between",79],["the",79],["image",79],["and",81],["a",81],["representation",81],["at",81],["a",81],["particular",81],["layer,",81],["the",84],["result",84],["was",84],["a",84],["very",84],["trippy",84],["image.",84],["It",86],["all",86],["sounds",86],["very",86],["similar",86],["to",86],["the",86],["drug",86],["experience",86],["which",88],["is",88],["insane.",88],["Our",90],["brains",90],["are",90],["carbon-based",90],["and",91],["they",91],["use",91],["chemical",91],["signals",91],["as",91],["messengers.",91],["A",94],["neural",94],["network",94],["doesn't",94],["even",94],["exist",94],["in",95],["physical",95],["space",95],["at",95],["all.",95],["It's",97],["an",97],["abstract",97],["concept",97],["being",97],["represented",97],["on",100],["binary",100],["silicon",100],["transistors.",100],["There's",102],["no",102],["reason",102],["to",102],["expect",102],["that",102],["these",102],["two",102],["systems",102],["would",104],["develop",104],["the",104],["same",104],["mechanism",104],["for",106],["processing",106],["visual",106],["information.",106],["Even",108],["with",108],["existing",108],["similarities,",108],["natural",110],["selection",110],["is",110],["very",110],["different",110],["from",110],["using",110],["gradient",112],["descent",112],["to",112],["alter",112],["weights",112],["of",114],["connection",114],["between",114],["nodes.",114],["Could",116],["it",116],["be",116],["that,",116],["somehow,",116],["encoded",117],["in",117],["the",117],["fundamental",117],["rules",117],["of",117],["the",117],["universe",117],["there's",120],["this",120],["ideal",120],["way",120],["of",120],["doing",120],["object",120],["recognition?",120],["TRINITY:",123],["-What",123],["is",123],["he",123],["doing?",123],["MORPHEUS:",124],["-He's",124],["beginning",124],["to",124],["believe.",124],["SIRAJ",126],["(AS",126],["NEO):",126],["-You're",126],["damn",126],["right,",126],["Morpheus.",126],["-We're",128],["getting",128],["closer",128],["to",128],["understanding",128],["it",128],["every",128],["day,",128],["and",130],["we",130],["can",130],["learn",130],["a",130],["lot",130],["about",130],["the",130],["brain",130],["including",132],["human",132],["development,",132],["treatment",133],["for",133],["cognitive",133],["disabilities,",133],["and",133],["drug",133],["effects,",133],["from",136],["studying",136],["artificial",136],["neural",136],["networks.",136],["After",138],["we",138],["install",138],["our",138],["dependencies,",138],["we're",140],["gonna",140],["replicate",140],["Google's",140],["Deep",140],["Dream",140],["code",140],["in",142],["TensorFlow,",142],["and",142],["then",142],["test",142],["it",142],["out",142],["on",142],["a",142],["novel",142],["image.",142],["NumPy",145],["will",145],["be",145],["used",145],["to",145],["perform",145],["math",145],["calculations.",145],["The",147],["'partial'",147],["submodule",147],["of",147],["functools",147],["lets",150],["us",150],["create",150],["new",150],["versions",150],["of",150],["functions",150],["with",152],["one",152],["or",152],["more",152],["arguments",152],["filled",152],["in.",152],["This",154],["is",154],["good",154],["for",154],["reusability,",154],["which",155],["means",155],["less",155],["code",155],["to",155],["write.",155],["Pillow",157],["is",157],["an",157],["imaging",157],["library,",157],["and",159],["Image",159],["will",159],["help",159],["us",159],["modify",159],["our",159],["images.",159],["TensorFlow",161],["is",161],["our",161],["machine",161],["learning",161],["library.",161],["urllib",163],["will",163],["let",163],["us",163],["download",163],["data",163],["from",163],["the",163],["web.",163],["os",165],["will",165],["let",165],["us",165],["use",165],["operating",167],["system-dependent",167],["functionality,",167],["and",169],["ziptools",169],["[sic]",169],["will",169],["let",169],["us",169],["run",169],["FREE!",169],["No.",171],["It'll",171],["just",171],["let",171],["us",171],["unzip",171],["files.",171],["Our",173],["imports",173],["are",173],["already",173],["at",173],["the",173],["top",173],["of",173],["our",173],["script",173],["so",176],["we're",176],["going",176],["to",176],["download",176],["Google's",177],["pre-trained",177],["neural",177],["network,",177],["create",179],["a",179],["TensorFlow",179],["session,",179],["pick",181],["a",181],["layer",181],["and",181],["a",181],["pre-trained",181],["network",181],["to",183],["enhance",183],["our",183],["input",183],["image,",183],["apply",184],["our",184],["gradient",184],["ascent",184],["to",184],["that",184],["layer",184],["repeatedly,",184],["and",187],["then",187],["output",187],["our",187],["newly",187],["Deep",187],["Dream'd",187],["image.",187],["Let's",190],["start",190],["by",190],["downloading",190],["Google's",191],["pre-trained",191],["neural",191],["network",191],["called",191],["\"Inception\"",191],["in",194],["our",194],["main()",194],["method.",194],["We'll",195],["store",195],["a",195],["link",195],["to",195],["it",195],["in",195],["the",195],["'url'",195],["variable,",195],["create",198],["a",198],["data",198],["directory",198],["where",198],["we",198],["will",198],["extract",198],["it",198],["to,",198],["then",200],["use",200],["the",200],["os",200],["module",200],["to",200],["retrieve",200],["the",200],["model",200],["name",200],["and",203],["create",203],["a",203],["local",203],["ZIP",203],["file",203],["path.",203],["If",204],["there",204],["is",204],["nothing",204],["at",204],["that",204],["path,",204],["we",206],["can",206],["download",206],["it",206],["using",206],["the",206],["urllib",206],["module",206],["with",208],["the",208],["'url'",208],["variable",208],["as",208],["a",208],["parameter",208],["and",211],["store",211],["it",211],["in",211],["the",211],["'model_url'",211],["variable.",211],["We'll",213],["open",213],["our",213],["ZIP",213],["file",213],["with",213],["the",213],["'wb'",213],["flag",213],["so",215],["we",215],["can",215],["write",215],["to",215],["it",215],["in",215],["binary,",215],["then",216],["write",216],["the",216],["downloaded",216],["data",216],["to",216],["it.",216],["Then",218],["we'll",218],["extract",218],["that",218],["using",218],["the",218],["ZipFile",218],["module.",218],["Now",220],["we",220],["can",220],["create",220],["our",220],["TensorFlow",220],["session.",220],["We'll",222],["load",222],["our",222],["Inception",222],["graph",222],["file",222],["into",224],["our",224],["'model_fn'",224],["variable,",224],["then",224],["initialize",224],["the",224],["graph",224],["using",227],["the",227],["Graph()",227],["function",227],["of",227],["TensorFlow.",227],["Now",229],["we",229],["can",229],["initialize",229],["a",229],["session",229],["using",229],["that",229],["graph.",229],["We'll",232],["open",232],["our",232],["existing",232],["saved-in-session",232],["graph",232],["using",234],["the",234],["FastGFile()",234],["function",234],["and",236],["point",236],["it",236],["to",236],["the",236],["saved",236],["graph.",236],["Once",238],["we've",238],["opened",238],["it,",238],["we",238],["can",238],["read",238],["that",238],["graph",238],["and",240],["parse",240],["it",240],["accordingly",240],["using",241],["the",241],["ParseFromString()",241],["method",241],["of",243],["TensorFlow's",243],["graph",243],["definition",243],["module.",243],["We",245],["need",245],["to",245],["define",245],["our",245],["input,",245],["so",245],["we'll",245],["create",245],["an",248],["input",248],["tensor",248],["using",248],["the",248],["placeholder()",248],["method",248],["called",250],["'input'",250],["with",250],["the",250],["size",250],["of",250],["32",250],["bits.",250],["Then",252],["we'll",252],["define",252],["image",252],["net",252],["mean",252],["value",252],["of",252],["pixels",252],["in",255],["an",255],["image",255],["as",255],["117.",255],["By",257],["removing",257],["this",257],["value",257],["from",257],["our",257],["image,",257],["it",259],["will",259],["help",259],["us",259],["with",259],["feature",259],["learning,",259],["so",260],["we",260],["will",260],["subtract",260],["it",260],["from",260],["our",260],["input",260],["tensor",260],["and",262],["store",262],["the",262],["value",262],["in",262],["our",262],["'preprocessed'",262],["variable.",262],["Then",265],["we'll",265],["load",265],["the",265],["'graph_def'",265],["variable",265],["we",265],["initialized",265],["with",268],["the",268],["input",268],["as",268],["the",268],["newly",268],["processed",268],["tensor.",268],["So",269],["now",269],["we've",269],["got",269],["our",269],["TensorFlow",269],["model,",269],["we've",272],["downloaded",272],["from",272],["the",272],["web,",272],["and",273],["we've",273],["loaded",273],["it",273],["into",273],["our",273],["session",273],["as",275],["a",275],["graph",275],["with",275],["a",275],["bunch",275],["of",275],["layers.",275],["It's",276],["a",276],["convolutional",276],["neural",276],["network,",276],["the",278],["type",278],["of",278],["neural",278],["net",278],["that",278],["helps",278],["recognize",278],["images.",278],["Let's",281],["load",281],["all",281],["those",281],["layers",281],["into",281],["an",281],["array",281],["and",283],["store",283],["them",283],["in",283],["our",283],["'layers'",283],["object.",283],["So",284],["for",284],["every",284],["TensorFlow",284],["operation",284],["in",284],["our",284],["graph,",284],["if",287],["it's",287],["a",287],["convolutional",287],["layer,",287],["load",287],["it",287],["into",287],["our",287],["array.",287],["So",290],["we've",290],["got",290],["♫",291],["layers,",291],["lay-layers,",291],["lay-",291],["♫",291],["Yeah,",293],["we're",293],["balling",293],["hard",293],["right",293],["now,",293],["I",293],["know.",293],["OK,",295],["so",295],["each",295],["of",295],["our",295],["convolutional",295],["layers",295],["output",297],["tens",297],["of",297],["hundreds",297],["of",297],["feature",297],["channels",297],["to",299],["pass",299],["data",299],["in",299],["the",299],["graph,",299],["and",300],["we",300],["can",300],["collect",300],["them",300],["all",300],["and",302],["store",302],["them",302],["in",302],["the",302],["'feature_nums'",302],["variable.",302],["Let's",304],["print",304],["them",304],["out",304],["and",304],["visualize",304],["what",304],["we've",304],["got",304],["in",306],["terminal",306],["first.",306],["We",307],["can",307],["see",307],["our",307],["number",307],["of",307],["layers",307],["and",309],["the",309],["total",309],["number",309],["of",309],["feature",309],["channels",309],["right",309],["here.",309],["Let's",311],["now",311],["pick",311],["a",311],["layer",311],["from",311],["our",311],["model",311],["that",313],["we're",313],["going",313],["to",313],["enhance.",313],["We'll",314],["pick",314],["a",314],["lower-level",314],["layer",314],["and",316],["pick",316],["one",316],["of",316],["the",316],["feature",316],["channels",316],["to",316],["visualize.",316],["It's",318],["time",318],["to",318],["load",318],["our",318],["input",318],["image",318],["using",320],["the",320],["Pillow",320],["Image",320],["submodule's",320],["open()",320],["method",320],["and",322],["store",322],["it",322],["in",322],["our",322],["image",322],["variable.",322],["We'll",323],["format",323],["it",323],["accordingly",323],["using",323],["NumPy",323],["and",326],["perform",326],["Deep",326],["Dream",326],["on",326],["it",326],["with",327],["our",327],["render_deepdream()",327],["function",327],["with",329],["a",329],["focus",329],["on",329],["the",329],["layer",329],["we",329],["selected",329],["earlier.",329],["In",331],["our",331],["Deep",331],["Dream",331],["function,",331],["we",333],["can",333],["see",333],["a",333],["couple",333],["of",333],["our",333],["predefined",333],["hyperparameters.",333],["We'll",335],["start",335],["by",335],["defining",335],["our",335],["optimization",335],["objective,",335],["which",338],["is",338],["to",338],["reduce",338],["the",338],["mean",338],["of",338],["our",338],["input",338],["layer.",338],["The",340],["gradients()",340],["function",340],["lets",340],["us",340],["compute",340],["the",342],["symbolic",342],["gradient",342],["of",342],["our",342],["optimized",342],["tensor",342],["with",345],["respect",345],["to",345],["our",345],["input",345],["tensor.",345],["Now",347],["we",347],["can",347],["split",347],["our",347],["image",347],["into",347],["a",347],["number",347],["of",347],["octaves",347],["and",349],["say",349],["for",349],["each",349],["octave,",349],["let's",349],["resize",349],["it",349],["using",349],["NumPy",349],["and",352],["add",352],["it",352],["to",352],["our",352],["array",352],["of",352],["image",352],["octaves.",352],["Then",354],["we",354],["can",354],["generate",354],["details",354],["octave",354],["by",354],["octave",354],["by",357],["iterating",357],["through",357],["each.",357],["Random",358],["shapes",358],["are",358],["applied",358],["to",358],["the",358],["image",358],["to",360],["blur",360],["tile",360],["boundaries",360],["over",360],["multiple",360],["iterations",360],["using",363],["the",363],["calc_grad_tiled()",363],["function.",363],["We're",365],["essentially",365],["applying",365],["gradient",365],["ascent",365],["here",365],["to",368],["maximize",368],["our",368],["loss",368],["function,",368],["which",369],["merges",369],["our",369],["saved",369],["representation",369],["in",371],["this",371],["layer",371],["with",371],["our",371],["input",371],["image",371],["more",373],["and",373],["more",373],["every",373],["iteration.",373],["So",375],["to",375],["break",375],["it",375],["down,",375],["neural",376],["networks",376],["are",376],["a",376],["great",376],["test",376],["for",376],["learning",376],["about",378],["how",378],["the",378],["brain",378],["functions",378],["and",380],["responds",380],["to",380],["certain",380],["stimuli.",380],["They",382],["store",382],["increasingly",382],["abstract",382],["representations",382],["of",385],["what",385],["they",385],["learn",385],["in",385],["their",385],["layers,",385],["and",387],["we",387],["can",387],["create",387],["trippy",387],["images",387],["by",389],["applying",389],["a",389],["gradient",389],["ascent",389],["process",389],["to",389],["them",389],["based",391],["on",391],["any",391],["chosen",391],["layer",391],["of",393],["a",393],["pre-trained",393],["convolutional",393],["neural",393],["network.",393],["The",395],["winner",395],["of",395],["the",395],["coding",395],["challenge",395],["from",395],["the",395],["last",395],["video",395],["is",398],["Avhirup",398],["Chakhraborty.",398],["He",399],["created",399],["a",399],["pretty",399],["cool",399],["IPython",399],["Notebook",399],["to",402],["demo",402],["his",402],["code,",402],["and",402],["trained",402],["his",402],["neural",402],["net",402],["on",404],["both",404],["price",404],["and",404],["sentiment",404],["data",404],["using",404],["Keras.",404],["Badass",407],["of",407],["the",407],["week!",407],["And",408],["the",408],["runner-up",408],["is",408],["Victor",408],["Ciurana.",408],["Very",410],["well-documented",410],["code",410],["that",410],["asks",410],["for",410],["user",410],["input",410],["on",412],["stock",412],["prediction.",412],["The",413],["coding",413],["challenge",413],["for",413],["this",413],["video",413],["is",415],["to",415],["modify",415],["this",415],["code",415],["so",415],["it",415],["works",415],["not",415],["just",415],["on",415],["images,",415],["but",418],["video.",418],["Details",418],["are",418],["in",418],["the",418],["README.",418],["Post",420],["your",420],["GitHub",420],["link",420],["in",420],["the",420],["comments",420],["and",421],["I'll",421],["announce",421],["the",421],["winner",421],["in",421],["the",421],["next",421],["video.",421],["Also,",423],["I",423],["created",423],["a",423],["Slack",423],["channel",423],["for",425],["all",425],["of",425],["us",425],["programming",425],["Wizards",425],["to",427],["learn",427],["from",427],["each",427],["other.",427],["The",428],["link",428],["to",428],["sign",428],["up",428],["below.",428],["For",429],["now,",429],["I've",429],["got",429],["to",429],["stay",429],["sober,",429],["so",429],["thanks",429],["for",429],["watching.",429]]}